{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Useful resources Bash https://www.slackbook.org/html/ Advanced Bash-Scripting Guide by Mendel Cooper Bash Reference Manual \u2b50 The Bash Hackers Wiki \u2b50\u2b50 Greg Wooledge's Wiki \u2b50\u2b50\u2b50 Massive information about Bash and UNIX. BashGuide For learing Bash. Start here. BashSheet For a quick reference of Bash. BashProgramming For more advanced shell topics. BashFAQ 121 Frequently Asked Questions about Bash. BashPitfalls Common mistakes made by Bash programmers. Data science Data Science at the Command Line, 2nd edition (2021) Command Line Data Wrangling (Github readme) Command-line Tools can be 235x Faster than your Hadoop Cluster Reverse Engineering Google Colab The Missing Semester MIT Course 2020 Course 2019 Youtube CodeAesthetic fasterthanlime pamarcos Jan Schaumann Twitter Website Blog Advanced Programming in the UNIX Environment (CS631apue) Website Youtube playlist Twitter account System Administration (CS615asa) Website [Youtube playlist](https://www.youtube.com/watch?v=QJL5cNv9dJs&list=PLDadzdouM0VBq9HdgalQkqFKvM7uSaj9L Twitter account Linux internals linux-insides Understanding the bin, sbin, usr/bin, usr/sbin split Misc DevOps notes readthedocs Julia Evans a tornado of razorblades BY ADAM WIGGINS Fun Tech Projects A Web Server in 1 Line of Bash Everything you ever wanted to know about terminals (but were afraid to ask) Why is using a shell loop to process text considered bad practice? Documentaci\u00f3n de Alvaro Sainz-Pardo Programming Historian lessons Suck less Linuxjourney Linuxito","title":"Home"},{"location":"#useful-resources","text":"","title":"Useful resources"},{"location":"#bash","text":"https://www.slackbook.org/html/ Advanced Bash-Scripting Guide by Mendel Cooper Bash Reference Manual \u2b50 The Bash Hackers Wiki \u2b50\u2b50 Greg Wooledge's Wiki \u2b50\u2b50\u2b50 Massive information about Bash and UNIX. BashGuide For learing Bash. Start here. BashSheet For a quick reference of Bash. BashProgramming For more advanced shell topics. BashFAQ 121 Frequently Asked Questions about Bash. BashPitfalls Common mistakes made by Bash programmers.","title":"Bash"},{"location":"#data-science","text":"Data Science at the Command Line, 2nd edition (2021) Command Line Data Wrangling (Github readme) Command-line Tools can be 235x Faster than your Hadoop Cluster Reverse Engineering Google Colab","title":"Data science"},{"location":"#the-missing-semester-mit","text":"Course 2020 Course 2019","title":"The Missing Semester MIT"},{"location":"#youtube","text":"CodeAesthetic fasterthanlime pamarcos","title":"Youtube"},{"location":"#jan-schaumann","text":"Twitter Website Blog Advanced Programming in the UNIX Environment (CS631apue) Website Youtube playlist Twitter account System Administration (CS615asa) Website [Youtube playlist](https://www.youtube.com/watch?v=QJL5cNv9dJs&list=PLDadzdouM0VBq9HdgalQkqFKvM7uSaj9L Twitter account","title":"Jan Schaumann"},{"location":"#linux-internals","text":"linux-insides Understanding the bin, sbin, usr/bin, usr/sbin split","title":"Linux internals"},{"location":"#misc","text":"DevOps notes readthedocs Julia Evans a tornado of razorblades BY ADAM WIGGINS Fun Tech Projects A Web Server in 1 Line of Bash Everything you ever wanted to know about terminals (but were afraid to ask) Why is using a shell loop to process text considered bad practice? Documentaci\u00f3n de Alvaro Sainz-Pardo Programming Historian lessons Suck less Linuxjourney Linuxito","title":"Misc"},{"location":"1_cli/1_dirs/","text":"Directories ############## Programas which echo # En que path est\u00e1 el programa echo man echo # Muestra el manual de un programa tldr echo # Muestra el manual de ejemplos de un programa lsb_release -a # Ver mi sistema operativo man title Man sections 1 User-level commands and applications 2 System calls and kernel error codes 3 Library calls 4 Device drivers and network protocols 5 configuration file . Standard file formats 6 Games and demonstrations 7 Miscellaneous files and documents 8 System administration commands 9 Obscure kernel specs and interfaces \ud83d\udeb6\ud83c\udffb\u200d\u2642\ufe0f Navigate pwd : p rint w orking d irectory cd c hange d irectory cd : go to home cd ~ : go to home cd / : go to root cd - : go to previous dir ls : l i s t directories ls -a : show hidden too ls -l : show long (more info: permissions, size, date) `ls -lh: Human readable size `ls -S: Sort files by size ls *.png : only png files ls *.??g : only png and jpg files lsd : Better ls tree lsd --tree Better tree broot nnn ranger \ud83d\udd0e Search: find find ..... 2>/dev/null Do not show STDERR (denied acces) find {where} -name {what} -type {what type} find /etc Filter by type/name/path find . -type f Find only files find . -type d Find only directories find . -name '*.tar.gz' find . -name src -type d Find all directories named src find . -path '*/test/*.py' -type f Find all python files that have a folder named test in their path Filter by modification time find . -mtime -1 Find all files modified in the last day Filter by permission find -readable -writabe -executable find -readable -writabe ! -executable Filter by size find . -size 500c Exact 500 bytes find . -size +500k -size -10M Find all zip files with size in range 500k to 10M Find, then do some action find . -name '*.tmp' -exec rm {} \\; Delete all files with .tmp extension find . -name '*.png' -exec convert {} {}.jpg \\; Find all PNG files and convert them to JPG fd : a simple, fast, and user-friendly alternative to find . \ud83d\udd0e indexed search: updatedb + locate locate is FreeBSD includes locate as part of the base system. In Linux, the old implementation of locate is in the mlocate package, the current implemetation is plocate $ sudo updatedb compiles some sort of indexed database for quickly searching. Usually updated daily via cron or systemD timers. $ locate some_file uses the database for quickly searching. (Actually is plocate ) With the existing systemD timer - /lib/systemd/system/plocate-updatedb.service - /lib/systemd/system/plocate-updatedb.timer sudo pacman -S locate # This installs plocate sudo systemctl enable plocate-updatedb.timer sudo systemctl start plocate-updatedb.timer Find installed programs which whereis pacman -Q \ud83d\udcbd Disk usage du : d isk u sage du FILE : Disk usage of a file du -sh */ | sort -rh du -sh -- * | sort -h -r Disk usage of current dir ncdu FILE : Interactive version of Disk usage dust duf df / \ud83d\udcbd Hard drives See available drives Option 1: lsblk Option 2: fdisk -l Option 3: ls /dev/sd?? Mount sudo mkdir /hdd sudo mount -t auto /dev/sda1 /hdd Umount umount /hdd \ud83d\udccd Special dirs /dev devices /dev/sd?? Hard drive /dev/tcp/127.0.0.1/30000 TCP connection on 127.0.0.1:3000 /proc Procesos /sys System hardware (brightness, leds, sensors,...) /sys/class/thermal/thermal_zone*/temp CPU temperature","title":"Directories"},{"location":"1_cli/1_dirs/#directories","text":"############## Programas which echo # En que path est\u00e1 el programa echo man echo # Muestra el manual de un programa tldr echo # Muestra el manual de ejemplos de un programa lsb_release -a # Ver mi sistema operativo man title Man sections 1 User-level commands and applications 2 System calls and kernel error codes 3 Library calls 4 Device drivers and network protocols 5 configuration file . Standard file formats 6 Games and demonstrations 7 Miscellaneous files and documents 8 System administration commands 9 Obscure kernel specs and interfaces","title":"Directories"},{"location":"1_cli/1_dirs/#navigate","text":"pwd : p rint w orking d irectory cd c hange d irectory cd : go to home cd ~ : go to home cd / : go to root cd - : go to previous dir ls : l i s t directories ls -a : show hidden too ls -l : show long (more info: permissions, size, date) `ls -lh: Human readable size `ls -S: Sort files by size ls *.png : only png files ls *.??g : only png and jpg files lsd : Better ls tree lsd --tree Better tree broot nnn ranger","title":"\ud83d\udeb6\ud83c\udffb\u200d\u2642\ufe0f Navigate"},{"location":"1_cli/1_dirs/#search-find","text":"find ..... 2>/dev/null Do not show STDERR (denied acces) find {where} -name {what} -type {what type} find /etc","title":"\ud83d\udd0e Search: find"},{"location":"1_cli/1_dirs/#filter-by-typenamepath","text":"find . -type f Find only files find . -type d Find only directories find . -name '*.tar.gz' find . -name src -type d Find all directories named src find . -path '*/test/*.py' -type f Find all python files that have a folder named test in their path","title":"Filter by type/name/path"},{"location":"1_cli/1_dirs/#filter-by-modification-time","text":"find . -mtime -1 Find all files modified in the last day","title":"Filter by modification time"},{"location":"1_cli/1_dirs/#filter-by-permission","text":"find -readable -writabe -executable find -readable -writabe ! -executable","title":"Filter by permission"},{"location":"1_cli/1_dirs/#filter-by-size","text":"find . -size 500c Exact 500 bytes find . -size +500k -size -10M Find all zip files with size in range 500k to 10M","title":"Filter by size"},{"location":"1_cli/1_dirs/#find-then-do-some-action","text":"find . -name '*.tmp' -exec rm {} \\; Delete all files with .tmp extension find . -name '*.png' -exec convert {} {}.jpg \\; Find all PNG files and convert them to JPG fd : a simple, fast, and user-friendly alternative to find .","title":"Find, then do some action"},{"location":"1_cli/1_dirs/#indexed-search-updatedb-locate","text":"locate is FreeBSD includes locate as part of the base system. In Linux, the old implementation of locate is in the mlocate package, the current implemetation is plocate $ sudo updatedb compiles some sort of indexed database for quickly searching. Usually updated daily via cron or systemD timers. $ locate some_file uses the database for quickly searching. (Actually is plocate ) With the existing systemD timer - /lib/systemd/system/plocate-updatedb.service - /lib/systemd/system/plocate-updatedb.timer sudo pacman -S locate # This installs plocate sudo systemctl enable plocate-updatedb.timer sudo systemctl start plocate-updatedb.timer","title":"\ud83d\udd0e indexed search: updatedb + locate"},{"location":"1_cli/1_dirs/#find-installed-programs","text":"which whereis pacman -Q","title":"Find installed programs"},{"location":"1_cli/1_dirs/#disk-usage","text":"du : d isk u sage du FILE : Disk usage of a file du -sh */ | sort -rh du -sh -- * | sort -h -r Disk usage of current dir ncdu FILE : Interactive version of Disk usage dust duf df /","title":"\ud83d\udcbd Disk usage"},{"location":"1_cli/1_dirs/#hard-drives","text":"See available drives Option 1: lsblk Option 2: fdisk -l Option 3: ls /dev/sd?? Mount sudo mkdir /hdd sudo mount -t auto /dev/sda1 /hdd Umount umount /hdd","title":"\ud83d\udcbd Hard drives"},{"location":"1_cli/1_dirs/#special-dirs","text":"/dev devices /dev/sd?? Hard drive /dev/tcp/127.0.0.1/30000 TCP connection on 127.0.0.1:3000 /proc Procesos /sys System hardware (brightness, leds, sensors,...) /sys/class/thermal/thermal_zone*/temp CPU temperature","title":"\ud83d\udccd Special dirs"},{"location":"1_cli/2_files/","text":"Files Types of files file directory executable symbolic link socket FIFO whiteout (not in Linux, only in UNIX) Linux. it's a type of file that stops further lookup for a file but reports that it doesn't exist. \ud83d\udc41\ufe0f See files See head or tail of file head : shows the beginning of a file (defaults to first 10 lines). head -n5 : only 5 lines tail : shows the ending of a file (defaults to last 10 lines). tail -n5 : only 5 lines (head; echo ...;tail) shows head and tail (head; tail) < file.txt cat file.txt | (head; tail) See entire content of text file cat : con cat enate and print files. bat : Better cat mdcat : cat for markdown Pager ( echo $PAGER ) more : less : Beter than more. Interactive file viwer. Load the file dynamically (faster than cat) less -N Add line number most : Better than less. Capable of viewing any number of files. See entire content of binary files cat file | od -c | head hexdump : Para ver ficheros binarios xxd : make a hexdump or do the reverse. hexeditor : strings my_file : See parts of text data in a binary file See info file stat file my_file stat my_file Rename, Move and copy files mv OLD NEW : Move or rename files or directories for file in *; do; mv \"$file ${file// /_}\"; done; : Replace spaces with underscores cp FROM TO : Copy a file rm PATH : Remove a file rm -r PATH : Remove a directory recusively rmdir PATH : Remove an empty directory touch NEW_FILE : Create a file mkdir PATH : Make a directory mkdir My\\ photos : Make a directory with spaces mkdir \"My photos\" : Make a directory with spaces ln FROM TO : Create link (acceso directo) ln src_file dest_file : Hard link ln -s src_file dest_file : Symbolic link ln -s -f src_file dest_file : Symbolyc link \ud83d\uddd1\ufe0f Deep remove files scrub : Real delete files in disk shred : Real delete files in disk bash deep_rm () { scrub -p dod $1 shred -zun 10 -v $1 } Compare files and Find duplicates cmp diff comm comm -12 <(sort words.txt | uniq) <(sort countries.txt | uniq) comm -23 <(ls march) <(ls april) OPTION A) Comparing filenames ls | sort | uniq -d OPTION B) Comparing line by line (text files) diff {file1} {file2} : See differencs between files sdiff {file1} {file2} : side-by-side merge of file differences cmp {file1} {file2} : See differencs between files comm : select or reject lines comm on to two files OPTION C) Comparing Byte by byte (binary files) OPTION D) Comparing Checksums, hashes, fingerprints md5sum sha1sum, Some filesytems already computes th checksums ZFS: Performs automatic file integrity checking using checksums fdupes: https://atareao.es/software/utilidades/eliminar-duplicados https://unix.stackexchange.com/questions/28895/open-source-duplicate-image-finder-for-linux Type of files and magic numbers The first bytes of a file determine the type of file file * : see the types of every file in the current directory Magic numbers: 89 50 4e 47 0d 0a 1a 0a magic number of PNG file Users and Privileges (when ls -l ) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500> Permission of user (owner) \u2502 \u250c\u2500\u2500\u2500\u2500> Permission of group (of users) \u2502 \u2502 \u250c\u2500> Permission of others (users) \u2502 \u2502 \u2502 / \\/ \\/ \\ rwxrwxrwx ownerUser userGroup 13B file Manage users whoami : See the current user i am su otherUser : Change to other user `exit: Change to prevous user Manage files chmod [ u user| g roup| o thers][+|-][ r ead| w rite|e x ecute] file chmod +x file : Add execution permission to everyone chmod g+w file : Add write permission to group users. chmod o-r file : Remove read permission to other users. chmod o+rw file : Add read and write permission to other users. chmod g+r,o-w file : Modifiy several users permission at the same time chmod 640 file : Modifiy several users permission at the same time chgrp userGroup file : Change the user group lsattr file List special atributers of file chattr +i file Change special atributes of file (add i atribute) chattr -i file Change special atributes of file (remove i atribute)","title":"Files"},{"location":"1_cli/2_files/#files","text":"","title":"Files"},{"location":"1_cli/2_files/#types-of-files","text":"file directory executable symbolic link socket FIFO whiteout (not in Linux, only in UNIX) Linux. it's a type of file that stops further lookup for a file but reports that it doesn't exist.","title":"Types of files"},{"location":"1_cli/2_files/#see-files","text":"","title":"\ud83d\udc41\ufe0f See files"},{"location":"1_cli/2_files/#see-head-or-tail-of-file","text":"head : shows the beginning of a file (defaults to first 10 lines). head -n5 : only 5 lines tail : shows the ending of a file (defaults to last 10 lines). tail -n5 : only 5 lines (head; echo ...;tail) shows head and tail (head; tail) < file.txt cat file.txt | (head; tail)","title":"See head or tail of file"},{"location":"1_cli/2_files/#see-entire-content-of-text-file","text":"cat : con cat enate and print files. bat : Better cat mdcat : cat for markdown","title":"See entire content of text file"},{"location":"1_cli/2_files/#pager-echo-pager","text":"more : less : Beter than more. Interactive file viwer. Load the file dynamically (faster than cat) less -N Add line number most : Better than less. Capable of viewing any number of files.","title":"Pager (echo $PAGER)"},{"location":"1_cli/2_files/#see-entire-content-of-binary-files","text":"cat file | od -c | head hexdump : Para ver ficheros binarios xxd : make a hexdump or do the reverse. hexeditor : strings my_file : See parts of text data in a binary file","title":"See entire content of binary files"},{"location":"1_cli/2_files/#see-info-file-stat","text":"file my_file stat my_file","title":"See info file stat"},{"location":"1_cli/2_files/#rename-move-and-copy-files","text":"mv OLD NEW : Move or rename files or directories for file in *; do; mv \"$file ${file// /_}\"; done; : Replace spaces with underscores cp FROM TO : Copy a file rm PATH : Remove a file rm -r PATH : Remove a directory recusively rmdir PATH : Remove an empty directory touch NEW_FILE : Create a file mkdir PATH : Make a directory mkdir My\\ photos : Make a directory with spaces mkdir \"My photos\" : Make a directory with spaces ln FROM TO : Create link (acceso directo) ln src_file dest_file : Hard link ln -s src_file dest_file : Symbolic link ln -s -f src_file dest_file : Symbolyc link","title":"Rename, Move and copy files"},{"location":"1_cli/2_files/#deep-remove-files","text":"scrub : Real delete files in disk shred : Real delete files in disk bash deep_rm () { scrub -p dod $1 shred -zun 10 -v $1 }","title":"\ud83d\uddd1\ufe0f Deep remove files"},{"location":"1_cli/2_files/#compare-files-and-find-duplicates","text":"cmp diff comm comm -12 <(sort words.txt | uniq) <(sort countries.txt | uniq) comm -23 <(ls march) <(ls april) OPTION A) Comparing filenames ls | sort | uniq -d OPTION B) Comparing line by line (text files) diff {file1} {file2} : See differencs between files sdiff {file1} {file2} : side-by-side merge of file differences cmp {file1} {file2} : See differencs between files comm : select or reject lines comm on to two files OPTION C) Comparing Byte by byte (binary files) OPTION D) Comparing Checksums, hashes, fingerprints md5sum sha1sum, Some filesytems already computes th checksums ZFS: Performs automatic file integrity checking using checksums fdupes: https://atareao.es/software/utilidades/eliminar-duplicados https://unix.stackexchange.com/questions/28895/open-source-duplicate-image-finder-for-linux","title":"Compare files and Find duplicates"},{"location":"1_cli/2_files/#type-of-files-and-magic-numbers","text":"The first bytes of a file determine the type of file file * : see the types of every file in the current directory Magic numbers: 89 50 4e 47 0d 0a 1a 0a magic number of PNG file","title":"Type of files and magic numbers"},{"location":"1_cli/2_files/#users-and-privileges-when-ls-l","text":"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500> Permission of user (owner) \u2502 \u250c\u2500\u2500\u2500\u2500> Permission of group (of users) \u2502 \u2502 \u250c\u2500> Permission of others (users) \u2502 \u2502 \u2502 / \\/ \\/ \\ rwxrwxrwx ownerUser userGroup 13B file Manage users whoami : See the current user i am su otherUser : Change to other user `exit: Change to prevous user Manage files chmod [ u user| g roup| o thers][+|-][ r ead| w rite|e x ecute] file chmod +x file : Add execution permission to everyone chmod g+w file : Add write permission to group users. chmod o-r file : Remove read permission to other users. chmod o+rw file : Add read and write permission to other users. chmod g+r,o-w file : Modifiy several users permission at the same time chmod 640 file : Modifiy several users permission at the same time chgrp userGroup file : Change the user group lsattr file List special atributers of file chattr +i file Change special atributes of file (add i atribute) chattr -i file Change special atributes of file (remove i atribute)","title":"Users and Privileges (when ls -l)"},{"location":"1_cli/3_process/","text":"Processes Basics A process is an instance of a program/command. Each process has a unique PID (5 digits number). Every process has a parent (the one who create the process). When you close/kill the parent pocess you kill all the child processes How to start a process: Manually (run command in terminal) At boot time (services or daemons) Scheduled ( crontab ) From anothter process (child process) ====== PROCESSES COMMAND & # EJecuta el proceso n 2o plano diswon # independiza el proceso pwdx 1732127 # En que ruta se inicio el proceso con PID=1732127 lsof Lists open files (belonging to active processes). lsof -i:80 Que procesos eta ocupando el puerto 80 lsof -iTCP -sTCP:LISTEN to list all processes that are listening on a TCP port for network requests. https://copyconstruct.medium.com/lsof-f2b224eee7b5 socat socat TCP-LISTEN:9000,fork,reuseaddr,bind=localhost TCP:$HOSTNAME:9000 : If the connection is refused by the server, will use socat to forward traffic from localhost:9000 to $HOSTNAME:9000 and back. https://copyconstruct.medium.com/socat-29453e9fc8a6 ss Sockets Your system is alive! inotify : monitoring filesystem events inotifywait : wait for changes to files using inotify iostat : Report Central Processing Unit (CPU) statistics and input/output statistics for devices, partitions and network filesystems (NFS). Processes VS Jobs A job is a concept used by the shell. Foreground process, backegraund process and suspended processces in the current shell is a job. You can have a large number of background jobs running at the same time, but you can only have one foreground job processes jobs definition instances of a program/command processes of the current shell tracked by the Operating System the current shell identifier pid (example: 1 ) jobspec (example: %1 ) see all ps jobs commands kill , wait , disown , suspend fg , bg , jobs Action Command Shortcut Start a foreground process command Start a background process (shell depen.) command & Start a background process (independent) nohup command & See all the jobs (running & stopped) jobs Stop/pause current process (SIGSTOP) stop {PID} Ctrl Z Resume last stopped job in background bg Resume last stopped job in foreground fg Resume job number 2 in foreground fg %2 Waits for all background jobs to finish wait Waits for job number 1 to finish wait %1 Independice all background jobs disown -a Kill/finish job (SIGINT) kill {PID} Ctrl C Kill/finish job (SIGQUIT) Ctrl \\ Clean terminal Ctrl L digraph { /////////////////////// NODES rankdir=LR; // Left to Right node direction ranksep=.5; { rank = same; \"fg\"; \"st\"; \"bg\";}; nodesep=.5; start [shape=point] fg [ label=\"Running in\\nforegroung\" ] bg [ label=\"Running in\\nbackgroung\" ] bg2 [ label=\"Running in\\nbackgroung\" ] st [ label=\"Stopped\\n(paused)\" ] end [shape=point] /////////////////////// EDGES subgraph cluster1 { label = \"Processes with Parent PID = current shell\\n(when shell dies, Processes dies too)\\n($ jobs to see all these processes)\"; fg -> st [ label=\"Ctrl Z\" ]; st -> fg [ label=\"fg\" ]; st -> bg [ label=\"bg\" ]; bg -> st [ label=\"stop job#\" ]; } start -> fg [ label=\"command\" ]; start -> bg [ label=\"command &\" ]; start -> bg2 [ label=\"nohup command &\" ]; fg -> end [ label=\"Ctrl C\" ]; st -> end [ label=\"kill job#\" ]; bg -> end [ label=\"kill job#\" ]; bg -> bg2 [ label=\"disown job#\"]; } https://copyconstruct.medium.com/bash-job-control-4a36da3e4aa7 https://www.baeldung.com/linux/foreground-background-process https://www.baeldung.com/linux/jobs-job-control-bash https://fsl.fmrib.ox.ac.uk/fslcourse/unix_intro/job.html Coprocess https://copyconstruct.medium.com/bash-coprocess-2092a93ad912 Process states Processes can have several states: Running (R) Uninterruptible Sleep (D) Interruptable Sleep (S) Stopped (T) Zombie (Z) Processes and Threads Process priorities https://www.tecmint.com/set-linux-process-priority-using-nice-and-renice-commands/ Tracking ongoing processes ( ps ) ps (Process status) can be used to see/list all the running processes. ps -f (full) For more information variables ps 19 For single-process information, ps along with process id is used UID: User ID that this process belongs to (the person running it) PID: Process ID PPID: Parent process ID (the ID of the process that started it) C: CPU utilization of process STIME: Process start time TTY: Terminal type associated with the process TIME: CPU time is taken by the process CMD: The command that started this process UID PID PPID C STIME TTY TIME CMD 0 1 0 0 5may22 ?? 98:12.93 /sbin/launchd 0 69 1 0 5may22 ?? 4:07.06 /usr/sbin/syslogd Proc dir It has PID 28, so we check the /proc https://www.digitalocean.com/community/tutorials/how-to-use-top-netstat-du-other-tools-to-monitor-server-resources https://www.digitalocean.com/community/tutorials/how-to-use-ps-kill-and-nice-to-manage-processes-in-linux https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files https://opensource.com/article/20/1/inter-process-communication-linux https://opensource.com/downloads/guide-inter-process-communication-linux","title":"Processes"},{"location":"1_cli/3_process/#processes","text":"","title":"Processes"},{"location":"1_cli/3_process/#basics","text":"A process is an instance of a program/command. Each process has a unique PID (5 digits number). Every process has a parent (the one who create the process). When you close/kill the parent pocess you kill all the child processes How to start a process: Manually (run command in terminal) At boot time (services or daemons) Scheduled ( crontab ) From anothter process (child process) ====== PROCESSES COMMAND & # EJecuta el proceso n 2o plano diswon # independiza el proceso pwdx 1732127 # En que ruta se inicio el proceso con PID=1732127","title":"Basics"},{"location":"1_cli/3_process/#lsof","text":"Lists open files (belonging to active processes). lsof -i:80 Que procesos eta ocupando el puerto 80 lsof -iTCP -sTCP:LISTEN to list all processes that are listening on a TCP port for network requests. https://copyconstruct.medium.com/lsof-f2b224eee7b5","title":"lsof"},{"location":"1_cli/3_process/#socat","text":"socat TCP-LISTEN:9000,fork,reuseaddr,bind=localhost TCP:$HOSTNAME:9000 : If the connection is refused by the server, will use socat to forward traffic from localhost:9000 to $HOSTNAME:9000 and back. https://copyconstruct.medium.com/socat-29453e9fc8a6","title":"socat"},{"location":"1_cli/3_process/#ss","text":"Sockets","title":"ss"},{"location":"1_cli/3_process/#your-system-is-alive","text":"inotify : monitoring filesystem events inotifywait : wait for changes to files using inotify iostat : Report Central Processing Unit (CPU) statistics and input/output statistics for devices, partitions and network filesystems (NFS).","title":"Your system is alive!"},{"location":"1_cli/3_process/#processes-vs-jobs","text":"A job is a concept used by the shell. Foreground process, backegraund process and suspended processces in the current shell is a job. You can have a large number of background jobs running at the same time, but you can only have one foreground job processes jobs definition instances of a program/command processes of the current shell tracked by the Operating System the current shell identifier pid (example: 1 ) jobspec (example: %1 ) see all ps jobs commands kill , wait , disown , suspend fg , bg , jobs Action Command Shortcut Start a foreground process command Start a background process (shell depen.) command & Start a background process (independent) nohup command & See all the jobs (running & stopped) jobs Stop/pause current process (SIGSTOP) stop {PID} Ctrl Z Resume last stopped job in background bg Resume last stopped job in foreground fg Resume job number 2 in foreground fg %2 Waits for all background jobs to finish wait Waits for job number 1 to finish wait %1 Independice all background jobs disown -a Kill/finish job (SIGINT) kill {PID} Ctrl C Kill/finish job (SIGQUIT) Ctrl \\ Clean terminal Ctrl L digraph { /////////////////////// NODES rankdir=LR; // Left to Right node direction ranksep=.5; { rank = same; \"fg\"; \"st\"; \"bg\";}; nodesep=.5; start [shape=point] fg [ label=\"Running in\\nforegroung\" ] bg [ label=\"Running in\\nbackgroung\" ] bg2 [ label=\"Running in\\nbackgroung\" ] st [ label=\"Stopped\\n(paused)\" ] end [shape=point] /////////////////////// EDGES subgraph cluster1 { label = \"Processes with Parent PID = current shell\\n(when shell dies, Processes dies too)\\n($ jobs to see all these processes)\"; fg -> st [ label=\"Ctrl Z\" ]; st -> fg [ label=\"fg\" ]; st -> bg [ label=\"bg\" ]; bg -> st [ label=\"stop job#\" ]; } start -> fg [ label=\"command\" ]; start -> bg [ label=\"command &\" ]; start -> bg2 [ label=\"nohup command &\" ]; fg -> end [ label=\"Ctrl C\" ]; st -> end [ label=\"kill job#\" ]; bg -> end [ label=\"kill job#\" ]; bg -> bg2 [ label=\"disown job#\"]; } https://copyconstruct.medium.com/bash-job-control-4a36da3e4aa7 https://www.baeldung.com/linux/foreground-background-process https://www.baeldung.com/linux/jobs-job-control-bash https://fsl.fmrib.ox.ac.uk/fslcourse/unix_intro/job.html Coprocess https://copyconstruct.medium.com/bash-coprocess-2092a93ad912","title":"Processes VS Jobs"},{"location":"1_cli/3_process/#process-states","text":"Processes can have several states: Running (R) Uninterruptible Sleep (D) Interruptable Sleep (S) Stopped (T) Zombie (Z)","title":"Process states"},{"location":"1_cli/3_process/#processes-and-threads","text":"","title":"Processes and Threads"},{"location":"1_cli/3_process/#process-priorities","text":"https://www.tecmint.com/set-linux-process-priority-using-nice-and-renice-commands/","title":"Process priorities"},{"location":"1_cli/3_process/#tracking-ongoing-processes-ps","text":"ps (Process status) can be used to see/list all the running processes. ps -f (full) For more information variables ps 19 For single-process information, ps along with process id is used UID: User ID that this process belongs to (the person running it) PID: Process ID PPID: Parent process ID (the ID of the process that started it) C: CPU utilization of process STIME: Process start time TTY: Terminal type associated with the process TIME: CPU time is taken by the process CMD: The command that started this process UID PID PPID C STIME TTY TIME CMD 0 1 0 0 5may22 ?? 98:12.93 /sbin/launchd 0 69 1 0 5may22 ?? 4:07.06 /usr/sbin/syslogd","title":"Tracking ongoing processes (ps)"},{"location":"1_cli/3_process/#proc-dir","text":"It has PID 28, so we check the /proc https://www.digitalocean.com/community/tutorials/how-to-use-top-netstat-du-other-tools-to-monitor-server-resources https://www.digitalocean.com/community/tutorials/how-to-use-ps-kill-and-nice-to-manage-processes-in-linux https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files https://opensource.com/article/20/1/inter-process-communication-linux https://opensource.com/downloads/guide-inter-process-communication-linux","title":"Proc dir"},{"location":"1_cli/4_systemd/","text":"SystemD Unit type Description .service A system service .socket An IPC socket .device A device file .mount A mount point in the filesystem .automount An automount point in the filesystem .swap A swap device or file .target A group of units. Equivalent of trditional init\u2019s run levels .path A path (file or directory) monitored by systemd .timer A timer controlled by systemd .snapshot A saved state of systemd .slice A group of units, hierarchically organized in a tree, for managing processes .scope A scope unit for managing externally created processes Where store the units ? Directory Description /etc/systemd/system Administrator-configured units Your local units can go here /lib/systemd/system Package-installed units you shouldn\u2019t modify them /run/systemd/system Non-persistent runtime modifications An area for transient units If there\u2019s any conflict, the files in /etc have the highest priority systemctl : manage systemd systemctl # Eqivalent to systemctl list-units systemctl list-units # shows LOADED and ACTIVE services, sockets, targets, mounts, and devices. systemctl list-units --type=service # shows LOADED and ACTIVE services. systemctl list-unit-files # See all unit files, regardless of whether or not they\u2019re active systemctl list-unit-files --type=service # See all services files, regardless of whether or not they\u2019re active. systemctl status cups.service # systemctl status cups # The same (systemctl can usually accept a unit name without a unit-type suffix) systemctl Subcommand Function list-units Shows LOADED services, sockets, targets, mounts, and devices. list-units --type=service list-units [ pattern ] list-unit-files --type=service list-unit-files [ pattern ] Shows installed units; optionally matching pattern enable unit Start unit at boot disable unit Not start unit at boot start unit Start unit immediately stop unit Stop unit immediately restart unit Restarts unit immediately status unit Shows unit\u2019s status and recent log entries kill pattern Sends a signal to units matching pattern reboot Reboots the computer daemon-reload Reloads unit files and systemd configuration units can be full name ( cups.service ) or sometimes without a unit-type suffix can be accepted ( cups ) Unit statuses systemctl list-units LOAD ACTIVE SUB Meaning not-found inactive dead loaded inactive dead loaded active exited loaded active running Unit file statuses systemctl list-unit-files State Meaning bad Some kind of problem within systemd; usually a bad unit file disabled Present, but not configured to start autonomously enabled Installed and runnable; will start autonomously indirect Disabled, but has peers in Also clauses that may be enabled linked Unit file available through a symlink masked Banished from the systemd world from a logical perspective man .target units (dependencies) Manage \"units\" in a dependency graph Se puede definir que un servicio empiece antes que otro SystemV Run level SystemD Target Description Run level 0 poweroff.target System halt emergency emergency.target Bare-bones shell for system recovery Run level 1 rescue.target Single-user mode Run level 2 multi-user.target Multiuser mode (command line) Run level 3 multi-user.target Multiuser mode with networking Run level 4 multi-user.target Not normally used by init Run level 5 graphical.target Multiuser mode with networking and GUI Run level 6 reboot.target System reboot systemctl list-units --type=target # To see all the system\u2019s available targets systemctl list-dependencies graphical.target # Explore dependency order of some unit # To change the system\u2019s current operating mode, use the systemctl isolate command: sudo systemctl isolate multi-user.target # To see the target the system boots into by default, run the get-default subcommand: systemctl get-default # Most Linux distributions boot to graphical.target by default, # which isn\u2019t appropriate for servers that don\u2019t need a GUI. # But that\u2019s easily changed: sudo systemctl set-default multi-user.target Under traditional init, you use the telinit command to change run levels once the system is booted. More info on man systemd.target .service units specifies the location of the executable file for the daemon tells systemd how to start and stop the service and identifies any other units that the service depends on Create a service ( my_custom.service ) an place it in /etc/systemd/system Refresh systemD avaialblae services sudo systemctl daemon-reload Start the service sudo systemctl start my_custom.service OPTINAL: Enable on booting sudo systemctl start my_custom.service See output (logging) of a u nit journalctl -u triton.service journalctl -u triton.service -f To f ollow the latest changes in real time Example of rsync.service : [Unit] Description=fast remote file copy program daemon ConditionPathExists=/etc/rsyncd.conf [Service] ExecStart=/usr/bin/rsync --daemon --no-detach [Install] WantedBy=multi-user.target [Unit] Description=The SAMPLE server After=syslog.target network.target remote-fs.target nss-lookup.target [Service] # Esta seccion solo esta para units de tipo .service Type=forking PIDFile=/run/sample.pid ExecStartPre=/usr/sbin/sample -t ExecStart=/usr/sbin/sample ExecReload=/bin/kill -s HUP $MAINPID ExecStop=/bin/kill -s QUIT $MAINPID PrivateTmp=true [Install] # Esta seccion es la encargada de poner la unit en el dependency tree WantedBy=app.service # This unit should start when app.service is starting Servicio que se levanta solo, si se cae dentro de [Service] si especificamos Restart=on-failure conseguimos esta funcionalidad. Ademas podemos definir RestartSec=5s para que se levante a los 5 segundos de haberse caido. [Unit] Description=Triton [Service] ExecStart=/home/javi/wesog/models/5_Triton_server/start.sh Restart=on-failure RestartSec=5s [Install] WantedBy=multi-user.target https://www.redhat.com/sysadmin/systemd-automate-recovery More info on man systemd.service .service + .socket Cuando el servicio esta inactivo (se esta iniciando, se cae, o se reinicia con una nueva version), las peticiones que recibe durante ese tiempo no se pierden sino que se meantienen en su socket, hasta que el servicio este operativo de nuevo. A esto se le conoce como Socket activation. Asi que las servidos no deben crear sus sockets manuelamente, sino usar el socket que le da systemD. Un servicio se crea con socket ativation crando con el mismo nombre myservwithsocket.service y myservwithsocket.socket myservwithsocket.service : [Unit] Description=My service with socket activation [Service] ExecStart=/path/to/exec myservwithsocket.socket : [Socket] ListenStream=8000 BindIPv6Only=both [Install] WantedBy=sockets.target # After sockets is availabe .service + .timer si quieres que un servicio que termina (script) se ejecute periodicamente (con la sisntaxis de CRON) puedes a\u00f1adir un .timer unit con el mismo nombre que el .service date.timer : [Unit] Description=Run date.service every 10 minutes [Timer] OnCalendar=*:0/10 Timer type Description OnCalendar A specific day and time. OnBootSec Seconds after system boot time. OnStartupSec Seconds after systemd was started. OnActiveSec Seconds after the timer itself was activated. OnUnitActiveSec Seconds after the specified unit was last active. OnUnitInactiveSec Seconds after the specified unit was last inactive. OnBootSec=2h 1m OnStartupSec=1week 2days 3hours OnActiveSec=1hr20m30sec10msec # Ver los timers actuales systemctl list-timers # archlinux-keyring-wkd-sync.timer | Refresh existing PGP keys of archlinux-keyring regularly # fstrim.timer | Discard unused blocks once a week # shadow.timer | Daily verification of password and group files # systemd-tmpfiles-clean.timer | Daily Cleanup of Temporary Directories https://wiki.archlinux.org/title/Systemd/Timers CRON Syntax \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 minute (0 - 59) \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 hour (0 - 23) \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 day of the month (1 - 31) \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 month (1 - 12) \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 day of the week (0=Sun - 6=Sat) \u2502 \u2502 \u2502 \u2502 \u2502 * * * * * minute hour day of the month month day of the week 0..59 0..23 1..31 1..12 0..6 (Sun,Mon,..,Sat) * means \u201cevery\u201d , value list separator - Range of values. / step values. Eg. /5 * * * * means every 5 minutes. Examples: * * * * * : Every minute */5 * * * * : Every 5 minutes */5 8-16 * * 1-5 : Every 5 minutes from 8:00 to 16:00, from Mon to Fri. 0 * * * * : Every hour (at minute 0) 0 0 * * * : Every day (at 00:00) 0 0 * * 0 : Every week (at 00:00 on Sunday) 0 0 1 * * : Mothly (at 00:00 on day 1) 0 0 1 1 * : Yearly (at 00:00 on day 1 of January) Check crontab guru to come up with the cron syntax for your schedule. Logging Systemd tiene su propio log (journal) Permission No se recomienda que el proprieerio del servicio sea el usurario root, para no tocar cosas que no debe. Todo se ejecuta con cgroups Reference https://www.youtube.com/watch?v=r_haLf5mWhE https://www.softprayog.in/tutorials/systemd-system-and-service-manager-in-linux https://alesnosek.com/blog/2016/12/04/controlling-a-multi-service-application-with-systemd ==================== Booting OLD (GRUB + SystemV) NEW (UEFI + SystemD) Power On 1 Load BIOS/UEFI from NVRAM Load BIOS firmware from ROM UEFI Probe for hardware Select boot device (disk, net,...) MBR (Master Boot Record) GPT (GUID Partition Table) Identify EFI system partition Load boot loader GRUB systemd-bootctl Determine which kernel to boot Load kernel Instantiate kernel data structures Start init/systemd as PID 1 Execute startup scripts Runlevel programs /etc/rc.d/ SystemD uses \"targets\" Running system BIOS (Basic Input/Output System) MBR (Master Boot Record) GRUB (Grand Unified Bootloader) Kernel Process managers launchd (OS X) Upstart (Ubuntu) (antiguo y tradicional sistema init) SystemV (SysV) (antiguo y tradicional sistema init) SystemD (el mas usado (y odiado) en la acutailidad Systemd-shim (alternativa moderna) In BSD, the init binary doesn't do much regarding startup, basically just executes /etc/rc; it's shell scripts all the way afterwards. SystemV SystemD Distros Gentoo, Slackware, Linux from Scratch ArchLinux, AWS, Red Hat, CentOS, Fedora, Debian, Ubuntu Restart /etc/init.d/sshd start systemctl restart sshd Enable systemctl enable NetworkManager.service systemctl enable wpa_supplicant https://papers.freebsd.org/2018/bsdcan/rice-the_tragedy_of_systemd/ FreeBSD ventajas: init system, LLVM, documentation, ZFS, dtrace Boot time (System V) BIOS (Basic Input/Output System) MBR (Master Boot Record) GRUB (Grand Unified Bootloader) Kernel Mounts the root file system as specified in the \u201croot=\u201d in grub.conf Kernel executes the /sbin/init program Init (PID=1) Es el primer proceso que se inicia durante el arranque del sistema por parte del kernel. Se ejecutar\u00e1 en segundo plano continuamente hasta que el sistema se apague. Lee el archivo /etc/inittab para decidir el nivel de ejecuci\u00f3n de Linux. luego inicia todos los dem\u00e1s procesos. Run level 0 \u2013> halt (CAUTION: never set initdefault to this) Run level 1 \u2013> Single user mode Run level 2 \u2013> Multiuser, without NFS (The same as 3, if you do not have networking) Run level 3 \u2013> Full multiuser mode (common initdefault) Run level 4 \u2013> unused Run level 5 \u2013> X11 (common initdefault) Run level 6 \u2013> reboot (CAUTION: never set initdefault to this) Ejemplo de inittab: id:3:initdefault: Runlevel programs Depending on your default init level setting, the system will execute the programs from one of the following directories. Run level 0 \u2013> /etc/rc.d/rc0.d/ Run level 1 \u2013> /etc/rc.d/rc1.d/ Run level 2 \u2013> /etc/rc.d/rc2.d/ Run level 3 \u2013> /etc/rc.d/rc3.d/ Run level 4 \u2013> /etc/rc.d/rc4.d/ Run level 5 \u2013> /etc/rc.d/rc5.d/ Run level 6 \u2013> /etc/rc.d/rc6.d/ Programs starts with S are used during startup. S for startup. Programs starts with K are used during shutdown. K for kill. Ejemplo de un script que: # \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 rc3: Ser\u00e1 ejecutado en el Run level 3 # \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 S: Ser\u00e1 ejecutado al encenderse # \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500 98: Momento de ejecuci\u00f3n, a menor n\u00famero, antes se ejecuta # \u2502 \u2502 \u2502 /etc/rc3.d/S98miscript # Puede ser un enlace simbolico a un script que est\u00e9 en otro sitio ln -s /etc/init.d/mi_script /etc/rc3.d/S98miscript Reference: https://www.thegeekstuff.com/2011/02/linux-boot-process/ Boot time (SystemD) SystemD uses \"targets\" instead of runlevels. By default, there are two main targets: - multi-user.target: analogous to runlevel 3 - graphical.target: analogous to runlevel 5 systemd not only manages processes in parallel, but also manages: - network connections (networkd) - kernel log entries (journald) - and logins (logind). # To view current default target, run: systemctl get-default # To set a default target, run: #systemctl set-default TARGET.target # Establezca el nivel de ejecuci\u00f3n actual en 3 (comenzar en modo de l\u00ednea de comando) systemctl set-default multi-user.target # Establezca el nivel de ejecuci\u00f3n actual en 5 (encendido para la interfaz gr\u00e1fica) systemctl set-default graphical.target systemD haters you may find it informative to peruse the Arguments against systemd section at without-systemd.org","title":"SystemD"},{"location":"1_cli/4_systemd/#systemd","text":"Unit type Description .service A system service .socket An IPC socket .device A device file .mount A mount point in the filesystem .automount An automount point in the filesystem .swap A swap device or file .target A group of units. Equivalent of trditional init\u2019s run levels .path A path (file or directory) monitored by systemd .timer A timer controlled by systemd .snapshot A saved state of systemd .slice A group of units, hierarchically organized in a tree, for managing processes .scope A scope unit for managing externally created processes","title":"SystemD"},{"location":"1_cli/4_systemd/#where-store-the-units","text":"Directory Description /etc/systemd/system Administrator-configured units Your local units can go here /lib/systemd/system Package-installed units you shouldn\u2019t modify them /run/systemd/system Non-persistent runtime modifications An area for transient units If there\u2019s any conflict, the files in /etc have the highest priority","title":"Where store the units ?"},{"location":"1_cli/4_systemd/#systemctl-manage-systemd","text":"systemctl # Eqivalent to systemctl list-units systemctl list-units # shows LOADED and ACTIVE services, sockets, targets, mounts, and devices. systemctl list-units --type=service # shows LOADED and ACTIVE services. systemctl list-unit-files # See all unit files, regardless of whether or not they\u2019re active systemctl list-unit-files --type=service # See all services files, regardless of whether or not they\u2019re active. systemctl status cups.service # systemctl status cups # The same (systemctl can usually accept a unit name without a unit-type suffix) systemctl Subcommand Function list-units Shows LOADED services, sockets, targets, mounts, and devices. list-units --type=service list-units [ pattern ] list-unit-files --type=service list-unit-files [ pattern ] Shows installed units; optionally matching pattern enable unit Start unit at boot disable unit Not start unit at boot start unit Start unit immediately stop unit Stop unit immediately restart unit Restarts unit immediately status unit Shows unit\u2019s status and recent log entries kill pattern Sends a signal to units matching pattern reboot Reboots the computer daemon-reload Reloads unit files and systemd configuration units can be full name ( cups.service ) or sometimes without a unit-type suffix can be accepted ( cups )","title":"systemctl: manage systemd"},{"location":"1_cli/4_systemd/#unit-statuses-systemctl-list-units","text":"LOAD ACTIVE SUB Meaning not-found inactive dead loaded inactive dead loaded active exited loaded active running","title":"Unit statuses systemctl list-units"},{"location":"1_cli/4_systemd/#unit-file-statuses-systemctl-list-unit-files","text":"State Meaning bad Some kind of problem within systemd; usually a bad unit file disabled Present, but not configured to start autonomously enabled Installed and runnable; will start autonomously indirect Disabled, but has peers in Also clauses that may be enabled linked Unit file available through a symlink masked Banished from the systemd world from a logical perspective man","title":"Unit file statuses systemctl list-unit-files"},{"location":"1_cli/4_systemd/#target-units-dependencies","text":"Manage \"units\" in a dependency graph Se puede definir que un servicio empiece antes que otro SystemV Run level SystemD Target Description Run level 0 poweroff.target System halt emergency emergency.target Bare-bones shell for system recovery Run level 1 rescue.target Single-user mode Run level 2 multi-user.target Multiuser mode (command line) Run level 3 multi-user.target Multiuser mode with networking Run level 4 multi-user.target Not normally used by init Run level 5 graphical.target Multiuser mode with networking and GUI Run level 6 reboot.target System reboot systemctl list-units --type=target # To see all the system\u2019s available targets systemctl list-dependencies graphical.target # Explore dependency order of some unit # To change the system\u2019s current operating mode, use the systemctl isolate command: sudo systemctl isolate multi-user.target # To see the target the system boots into by default, run the get-default subcommand: systemctl get-default # Most Linux distributions boot to graphical.target by default, # which isn\u2019t appropriate for servers that don\u2019t need a GUI. # But that\u2019s easily changed: sudo systemctl set-default multi-user.target Under traditional init, you use the telinit command to change run levels once the system is booted. More info on man systemd.target","title":".target units (dependencies)"},{"location":"1_cli/4_systemd/#service-units","text":"specifies the location of the executable file for the daemon tells systemd how to start and stop the service and identifies any other units that the service depends on Create a service ( my_custom.service ) an place it in /etc/systemd/system Refresh systemD avaialblae services sudo systemctl daemon-reload Start the service sudo systemctl start my_custom.service OPTINAL: Enable on booting sudo systemctl start my_custom.service See output (logging) of a u nit journalctl -u triton.service journalctl -u triton.service -f To f ollow the latest changes in real time Example of rsync.service : [Unit] Description=fast remote file copy program daemon ConditionPathExists=/etc/rsyncd.conf [Service] ExecStart=/usr/bin/rsync --daemon --no-detach [Install] WantedBy=multi-user.target [Unit] Description=The SAMPLE server After=syslog.target network.target remote-fs.target nss-lookup.target [Service] # Esta seccion solo esta para units de tipo .service Type=forking PIDFile=/run/sample.pid ExecStartPre=/usr/sbin/sample -t ExecStart=/usr/sbin/sample ExecReload=/bin/kill -s HUP $MAINPID ExecStop=/bin/kill -s QUIT $MAINPID PrivateTmp=true [Install] # Esta seccion es la encargada de poner la unit en el dependency tree WantedBy=app.service # This unit should start when app.service is starting","title":".service units"},{"location":"1_cli/4_systemd/#servicio-que-se-levanta-solo-si-se-cae","text":"dentro de [Service] si especificamos Restart=on-failure conseguimos esta funcionalidad. Ademas podemos definir RestartSec=5s para que se levante a los 5 segundos de haberse caido. [Unit] Description=Triton [Service] ExecStart=/home/javi/wesog/models/5_Triton_server/start.sh Restart=on-failure RestartSec=5s [Install] WantedBy=multi-user.target https://www.redhat.com/sysadmin/systemd-automate-recovery More info on man systemd.service","title":"Servicio que se levanta solo, si se cae"},{"location":"1_cli/4_systemd/#service-socket","text":"Cuando el servicio esta inactivo (se esta iniciando, se cae, o se reinicia con una nueva version), las peticiones que recibe durante ese tiempo no se pierden sino que se meantienen en su socket, hasta que el servicio este operativo de nuevo. A esto se le conoce como Socket activation. Asi que las servidos no deben crear sus sockets manuelamente, sino usar el socket que le da systemD. Un servicio se crea con socket ativation crando con el mismo nombre myservwithsocket.service y myservwithsocket.socket myservwithsocket.service : [Unit] Description=My service with socket activation [Service] ExecStart=/path/to/exec myservwithsocket.socket : [Socket] ListenStream=8000 BindIPv6Only=both [Install] WantedBy=sockets.target # After sockets is availabe","title":".service + .socket"},{"location":"1_cli/4_systemd/#service-timer","text":"si quieres que un servicio que termina (script) se ejecute periodicamente (con la sisntaxis de CRON) puedes a\u00f1adir un .timer unit con el mismo nombre que el .service date.timer : [Unit] Description=Run date.service every 10 minutes [Timer] OnCalendar=*:0/10 Timer type Description OnCalendar A specific day and time. OnBootSec Seconds after system boot time. OnStartupSec Seconds after systemd was started. OnActiveSec Seconds after the timer itself was activated. OnUnitActiveSec Seconds after the specified unit was last active. OnUnitInactiveSec Seconds after the specified unit was last inactive. OnBootSec=2h 1m OnStartupSec=1week 2days 3hours OnActiveSec=1hr20m30sec10msec # Ver los timers actuales systemctl list-timers # archlinux-keyring-wkd-sync.timer | Refresh existing PGP keys of archlinux-keyring regularly # fstrim.timer | Discard unused blocks once a week # shadow.timer | Daily verification of password and group files # systemd-tmpfiles-clean.timer | Daily Cleanup of Temporary Directories https://wiki.archlinux.org/title/Systemd/Timers","title":".service + .timer"},{"location":"1_cli/4_systemd/#cron-syntax","text":"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 minute (0 - 59) \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 hour (0 - 23) \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 day of the month (1 - 31) \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 month (1 - 12) \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 day of the week (0=Sun - 6=Sat) \u2502 \u2502 \u2502 \u2502 \u2502 * * * * * minute hour day of the month month day of the week 0..59 0..23 1..31 1..12 0..6 (Sun,Mon,..,Sat) * means \u201cevery\u201d , value list separator - Range of values. / step values. Eg. /5 * * * * means every 5 minutes.","title":"CRON Syntax"},{"location":"1_cli/4_systemd/#examples","text":"* * * * * : Every minute */5 * * * * : Every 5 minutes */5 8-16 * * 1-5 : Every 5 minutes from 8:00 to 16:00, from Mon to Fri. 0 * * * * : Every hour (at minute 0) 0 0 * * * : Every day (at 00:00) 0 0 * * 0 : Every week (at 00:00 on Sunday) 0 0 1 * * : Mothly (at 00:00 on day 1) 0 0 1 1 * : Yearly (at 00:00 on day 1 of January) Check crontab guru to come up with the cron syntax for your schedule.","title":"Examples:"},{"location":"1_cli/4_systemd/#logging","text":"Systemd tiene su propio log (journal)","title":"Logging"},{"location":"1_cli/4_systemd/#permission","text":"No se recomienda que el proprieerio del servicio sea el usurario root, para no tocar cosas que no debe.","title":"Permission"},{"location":"1_cli/4_systemd/#todo-se-ejecuta-con-cgroups","text":"","title":"Todo se ejecuta con cgroups"},{"location":"1_cli/4_systemd/#reference","text":"https://www.youtube.com/watch?v=r_haLf5mWhE https://www.softprayog.in/tutorials/systemd-system-and-service-manager-in-linux https://alesnosek.com/blog/2016/12/04/controlling-a-multi-service-application-with-systemd ====================","title":"Reference"},{"location":"1_cli/4_systemd/#booting","text":"OLD (GRUB + SystemV) NEW (UEFI + SystemD) Power On 1 Load BIOS/UEFI from NVRAM Load BIOS firmware from ROM UEFI Probe for hardware Select boot device (disk, net,...) MBR (Master Boot Record) GPT (GUID Partition Table) Identify EFI system partition Load boot loader GRUB systemd-bootctl Determine which kernel to boot Load kernel Instantiate kernel data structures Start init/systemd as PID 1 Execute startup scripts Runlevel programs /etc/rc.d/ SystemD uses \"targets\" Running system BIOS (Basic Input/Output System) MBR (Master Boot Record) GRUB (Grand Unified Bootloader) Kernel","title":"Booting"},{"location":"1_cli/4_systemd/#process-managers","text":"launchd (OS X) Upstart (Ubuntu) (antiguo y tradicional sistema init) SystemV (SysV) (antiguo y tradicional sistema init) SystemD (el mas usado (y odiado) en la acutailidad Systemd-shim (alternativa moderna) In BSD, the init binary doesn't do much regarding startup, basically just executes /etc/rc; it's shell scripts all the way afterwards. SystemV SystemD Distros Gentoo, Slackware, Linux from Scratch ArchLinux, AWS, Red Hat, CentOS, Fedora, Debian, Ubuntu Restart /etc/init.d/sshd start systemctl restart sshd Enable systemctl enable NetworkManager.service systemctl enable wpa_supplicant https://papers.freebsd.org/2018/bsdcan/rice-the_tragedy_of_systemd/ FreeBSD ventajas: init system, LLVM, documentation, ZFS, dtrace","title":"Process managers"},{"location":"1_cli/4_systemd/#boot-time-system-v","text":"BIOS (Basic Input/Output System) MBR (Master Boot Record) GRUB (Grand Unified Bootloader) Kernel Mounts the root file system as specified in the \u201croot=\u201d in grub.conf Kernel executes the /sbin/init program Init (PID=1) Es el primer proceso que se inicia durante el arranque del sistema por parte del kernel. Se ejecutar\u00e1 en segundo plano continuamente hasta que el sistema se apague. Lee el archivo /etc/inittab para decidir el nivel de ejecuci\u00f3n de Linux. luego inicia todos los dem\u00e1s procesos. Run level 0 \u2013> halt (CAUTION: never set initdefault to this) Run level 1 \u2013> Single user mode Run level 2 \u2013> Multiuser, without NFS (The same as 3, if you do not have networking) Run level 3 \u2013> Full multiuser mode (common initdefault) Run level 4 \u2013> unused Run level 5 \u2013> X11 (common initdefault) Run level 6 \u2013> reboot (CAUTION: never set initdefault to this) Ejemplo de inittab: id:3:initdefault: Runlevel programs Depending on your default init level setting, the system will execute the programs from one of the following directories. Run level 0 \u2013> /etc/rc.d/rc0.d/ Run level 1 \u2013> /etc/rc.d/rc1.d/ Run level 2 \u2013> /etc/rc.d/rc2.d/ Run level 3 \u2013> /etc/rc.d/rc3.d/ Run level 4 \u2013> /etc/rc.d/rc4.d/ Run level 5 \u2013> /etc/rc.d/rc5.d/ Run level 6 \u2013> /etc/rc.d/rc6.d/ Programs starts with S are used during startup. S for startup. Programs starts with K are used during shutdown. K for kill. Ejemplo de un script que: # \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 rc3: Ser\u00e1 ejecutado en el Run level 3 # \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 S: Ser\u00e1 ejecutado al encenderse # \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500 98: Momento de ejecuci\u00f3n, a menor n\u00famero, antes se ejecuta # \u2502 \u2502 \u2502 /etc/rc3.d/S98miscript # Puede ser un enlace simbolico a un script que est\u00e9 en otro sitio ln -s /etc/init.d/mi_script /etc/rc3.d/S98miscript Reference: https://www.thegeekstuff.com/2011/02/linux-boot-process/","title":"Boot time (System V)"},{"location":"1_cli/4_systemd/#boot-time-systemd","text":"SystemD uses \"targets\" instead of runlevels. By default, there are two main targets: - multi-user.target: analogous to runlevel 3 - graphical.target: analogous to runlevel 5 systemd not only manages processes in parallel, but also manages: - network connections (networkd) - kernel log entries (journald) - and logins (logind). # To view current default target, run: systemctl get-default # To set a default target, run: #systemctl set-default TARGET.target # Establezca el nivel de ejecuci\u00f3n actual en 3 (comenzar en modo de l\u00ednea de comando) systemctl set-default multi-user.target # Establezca el nivel de ejecuci\u00f3n actual en 5 (encendido para la interfaz gr\u00e1fica) systemctl set-default graphical.target","title":"Boot time (SystemD)"},{"location":"1_cli/4_systemd/#systemd-haters","text":"you may find it informative to peruse the Arguments against systemd section at without-systemd.org","title":"systemD haters"},{"location":"1_cli/5_ipc/","text":"Inter Process Comunication (IPC) Shared files Shared memory (with semaphores) Pipes unnamed pipes | named pipes mkfifo my_pipe (aka FIFO) Message queues Sockets Unix domain sockets TCP/IP sockets https://www.youtube.com/watch?v=8TGV4zcd9k4 Signals Practical IPC with python Unix domain socket < gRPC < HTTP | | Unix domain socket | gRPC | HTTP | address unix:// data is exchanged via a Unix domain socket (unix:// address) instead of a TCP socket https://www.mpi-hd.mpg.de/personalhomes/fwerner/research/2021/09/grpc-for-ipc/","title":"5 ipc"},{"location":"1_cli/5_ipc/#inter-process-comunication-ipc","text":"Shared files Shared memory (with semaphores) Pipes unnamed pipes | named pipes mkfifo my_pipe (aka FIFO) Message queues Sockets Unix domain sockets TCP/IP sockets https://www.youtube.com/watch?v=8TGV4zcd9k4 Signals","title":"Inter Process Comunication (IPC)"},{"location":"1_cli/5_ipc/#practical-ipc-with-python","text":"Unix domain socket < gRPC < HTTP | | Unix domain socket | gRPC | HTTP | address unix:// data is exchanged via a Unix domain socket (unix:// address) instead of a TCP socket https://www.mpi-hd.mpg.de/personalhomes/fwerner/research/2021/09/grpc-for-ipc/","title":"Practical IPC with python"},{"location":"1_cli/6_monitoring/","text":"Monitoring CPU & RAM - top - htop - Pres F5 to see a tree view of processes . - glances https://www.brendangregg.com/linuxperf.html GPU nvidia-smi watch -n 0.1 nvidia-smi : Watch every 0.1 seconds the output of nvidia-smi nvidia-smi --query-gpu=timestamp,name,pci.bus_id,temperature.gpu,utilization.gpu,utilization.memory --format=csv -l 1 Others: - nvidia-smi -q -d TEMPERATURE,PERFORMANCE : To see the slowdown/shutdown behavieour based on their temperature. If you frequently see HW Slowdown is activated, you probably need to improve the cooling of your machine. - nvidia-smi topo -m : shows the \u201cGPU topology\u201c, which describes how GPUs are connected. The topology is important to understand if data transfers between GPUs are being made via direct memory access (DMA) or through host devices. gpustat a Python libary ( pip install --user gpustat ) to in a more concise, prettier, and simpler way (one line per GPU) nvtop nvitop jupyterlab-nvdashboard pip install --user jupyterlab_nvdashboard Weights & Biases Grafana Reference https://lambdalabs.com/blog/keeping-an-eye-on-your-gpus-2/","title":"Monitoring"},{"location":"1_cli/6_monitoring/#monitoring","text":"","title":"Monitoring"},{"location":"1_cli/6_monitoring/#cpu-ram","text":"- top - htop - Pres F5 to see a tree view of processes . - glances https://www.brendangregg.com/linuxperf.html","title":"CPU &amp; RAM"},{"location":"1_cli/6_monitoring/#gpu","text":"","title":"GPU"},{"location":"1_cli/6_monitoring/#nvidia-smi","text":"watch -n 0.1 nvidia-smi : Watch every 0.1 seconds the output of nvidia-smi nvidia-smi --query-gpu=timestamp,name,pci.bus_id,temperature.gpu,utilization.gpu,utilization.memory --format=csv -l 1 Others: - nvidia-smi -q -d TEMPERATURE,PERFORMANCE : To see the slowdown/shutdown behavieour based on their temperature. If you frequently see HW Slowdown is activated, you probably need to improve the cooling of your machine. - nvidia-smi topo -m : shows the \u201cGPU topology\u201c, which describes how GPUs are connected. The topology is important to understand if data transfers between GPUs are being made via direct memory access (DMA) or through host devices.","title":"nvidia-smi"},{"location":"1_cli/6_monitoring/#gpustat","text":"a Python libary ( pip install --user gpustat ) to in a more concise, prettier, and simpler way (one line per GPU)","title":"gpustat"},{"location":"1_cli/6_monitoring/#nvtop","text":"","title":"nvtop"},{"location":"1_cli/6_monitoring/#nvitop","text":"","title":"nvitop"},{"location":"1_cli/6_monitoring/#jupyterlab-nvdashboard","text":"pip install --user jupyterlab_nvdashboard","title":"jupyterlab-nvdashboard"},{"location":"1_cli/6_monitoring/#weights-biases","text":"","title":"Weights &amp; Biases"},{"location":"1_cli/6_monitoring/#grafana","text":"","title":"Grafana"},{"location":"1_cli/6_monitoring/#reference","text":"https://lambdalabs.com/blog/keeping-an-eye-on-your-gpus-2/","title":"Reference"},{"location":"1_cli/bash_scripting/","text":"Bash scripting Shells Terminal Promt Hashbang/Shebang Configuration file sh $ #!/bin/sh bash $ #!/bin/bash .bashrc zsh $ #!/bin/zsh csh or tcsh % #!/bin/csh [Shebang line](https://en.wikipedia.org/wiki/Shebang_(Unix): First line, This is going to be the interpreter: - #!/bin/sh : Bourne shell script - #!/bin/bash : Bash shell script ./myScript.sh - #!/usr/bin/env bash : Bash shell script - #!/usr/bin/python : Python script ./myScript.py - #!/usr/bin/env python : Python script (more portable because looks for python comand) ./myScript.py - #!/usr/bin/expect Static program analisis pacman -S shellcheck shellcheck yourscript https://www.shellcheck.net expect para automatizar scripts que tienen un input manual Print: echo , printf echo echo Value is $myvarible : Print some variable badly echo 'Value is $myvarible' : Print some variable correctly (with newlines) echo \"Value is $myvarible\" : Print some variable correctly (with newlines) echo $PATH : Sitios donde la shell busca programas echo -n \"no new line\" : do not output the newline echo -e \"[33m ERROR\" : interpret backslash escapes (useful for displaying colors) enable interpretation of backslash escapes printf printf \"dfadf\" Sitios donde la shell busca programas Generate data touch Create a new file or changes the Last Modified time of an existing file. echo \"bla bla bla\" > file.txt seq seq 10 seq 3 9 primes 1 100 \ud83d\udcc5 See current date date cal File descriptors (fd) Every command (every porcess in fact) has its own file despcriptor table. By default (assuming your terminal is /dev/tty0): File descriptor Meaning Initial value 0 stdin /dev/tty0 1 stdout /dev/tty0 2 stderr /dev/tty0 Style output Use ~~ncurses~~ scape charaacters !!! Colours greenColour=\"\\e[0;32m\\033[1m\" endColour=\"\\033[0m\\e[0m\" redColour=\"\\e[0;31m\\033[1m\" blueColour=\"\\e[0;34m\\033[1m\" yellowColour=\"\\e[0;33m\\033[1m\" purpleColour=\"\\e[0;35m\\033[1m\" turquoiseColour=\"\\e[0;36m\\033[1m\" grayColour=\"\\e[0;37m\\033[1m\" # Example of usage echo -e \"\\n\\n${yellowColour}[*]${endColour}${grayColour} Exiting...\\n${endColour}\" IO Redirection IO Redirection modifies the file descriptors table of a command. Redirect from/to file: < > command < file # Redirect stdin to the command. FD0 = file command > file # Redirect stdout to file. FD1 = file command 1> file # Redirect stdout to file. FD1 = file command 2> file # Redirect stderr to file. FD2 = file command &> file # Redirect stdout & stderr to file FD1 = FD2 = file command > /dev/null # When we dont care about the output of a command echo hello > hello.txt # Crea (o sobrescribe) un fichero con la salida del programa anterior Redirect output of several comandas { command1 command2 } > /some/file { command1; command2; } >/some/file { command1 & command2 & } >/some/file Inplace modify the same file: sponge some_command_which_modifies /some/file | sponge /some/file head /some/file | sponge /some/file Append to file: >> command >> file # Redirect and append stdout to a file. command 1>> file # Redirect and append stdout to file command 2>> file # Redirect and append stderr to file echo hello >> hello.txt # A\u00f1ade (append) a un fichero la salida del programa anterior << << is known as here-document structure Read from variable: <<< <<< is known as here-string structure Pipelines Regular Pipes | Assign the stdout (FD1) of the first command to the pipe. Assign the stdin (FD0) of the second command to the pipe. ls -l | tail -n2 # Pipe: Imprime solo los ultimos 2 ficheros ls -l | tail -n2 > hello.txt # Pipe and file writting ls | xargs rm # | xargs is when the inputs is IN THE ARGUMENTS rm $(ls) # same of above cmd1 |& cmd1 # command1's stdout AND stderr is redirected to command2's stdin Machine Learning with Unix Pipes Named Pipes: mkfifo Example Bash script ############## Variables myVar=someValue echo $myVar myVar = someValue # No funciona con espacios echo \"Value is $myVar\" # Imprime: Value is someValue echo 'Value is $myVar' # Imprime: Value is $myVar ############## Functions #!/bin/bash mcd () { mkdir -p \"$1\" cd \"$1\" } # $0: The name of the script # $1: The 1st argument # $9: The 9th argument ########## command substitution myDir=$(pwd) # The output of a command in a varaible echo \"we are in $(pwd)\" for file in $(ls) Variables variables in funcions has global scope by defualt, (unless you define with local ) Special variables $0 : Name of the script $1 to $9 : Arguments to the script. \"$10\" and so on for the rest. $@ : All the arguments $# : Number of arguments $$ : Process identification number (PID) for the current script $? : Return code of the previous command !! : Entire last command, including arguments. A common pattern is to execute a command only for it to fail due to missing permissions; you can quickly re-execute the command with sudo by doing sudo !! $_ : Last argument from the last command. If you are in an interactive shell, you can also quickly get this value by typing Esc followed by . or Alt+. Arrays An array is a numbered list of strings: It maps integers to strings. Creating Arrays names=(\"Bob\" \"Peter\" \"$USER\" \"Big Bad John\") Simple way names=([0]=\"Bob\" [1]=\"Peter\" [20]=\"$USER\" [21]=\"Big Bad John\") Explicit indexes (sparse array) names[0]=\"Bob\" files=(~/*.jpg) Result of a glob photos=(~/\"My Photos\"/*.jpg) Result of a glob files=$(ls) BAD, BAD, BAD! files=($(ls)) STILL BAD! files=(*) GOOD: filenames in the current directory http://mywiki.wooledge.org/BashGuide/Arrays http://mywiki.wooledge.org/BashFAQ/005 Associative Arrays (Dictionaries) fullNames=( [\"lhunath\"]=\"Maarten Billemont\" [\"greycat\"]=\"Greg Wooledge\" ) http://mywiki.wooledge.org/BashGuide/Arrays#Associative_Arrays http://mywiki.wooledge.org/BashFAQ/006 Control Operators ( && and || ) my_command_2 && my_command_2 # Do my_command_2 only if my_command_2 was success someCommand && echo \"Previos comand worked (exit estatus==0)\" someCommand || echo \"Previos comand failed (exit estatus!=0)\" rm /etc/some_file.conf || echo \"I couldn't remove the file\" [ a = a ]; echo $? # 0 (True) [ a = b ]; echo $? # 1 (False) true; echo $? # 0 (True) false; echo $? # 1 (False) If if [[ $filename = *.jpg ]]; then echo \"$filename is a jpeg\" fi 6. Choices (case and select) Each choice in a case statement consists of a pattern (or a list of patterns) case $LANG in en*) echo 'Hello!' ;; fr*) echo 'Salut!' ;; de*) echo 'Guten Tag!' ;; nl*) echo 'Hallo!' ;; it*) echo 'Ciao!' ;; es*) echo 'Hola!' ;; C|POSIX) echo 'hello world' ;; *) echo 'I do not speak your language.' ;; esac Loops There are 4 different loops expressions: for variable in words : Repeat the loop for each word, setting variable to each word in turn. for i in 1 2 3 4 for i in {1..4} for file in *.mp3 for file in *.jpg *.jpeg for (( expr ; expr ; expr )) : C style for loop for (( i=1; i < 5; i++ )) while command : Repeat so long as command is executed successfully (exit code is 0). while (( i < 5 )) while true : Infinite loop while sleep 300 Infinite loop every 5 minutes while read -p \"Input something:\" input_variable Wait for user input until command : Repeat so long as command is executed unsuccessfully (exit code is not 0). Not very used because is the same as while ! command loop_expresion do commads done While loop while /bin/true do # Code goes here done while true; do # Code goes here done Functions Functions can only return an integer in range of 0 - 255. Parameter expansion http://mywiki.wooledge.org/BashGuide/Parameters#Parameter_Expansion Simple usage $VARIABLE ${VARIABLE} Indirection ${!VARIABLE} Case modification ${VARIABLE^} ${VARIABLE^^} ${VARIABLE,} ${VARIABLE,,} ${VARIABLE~} ${VARIABLE~~} Variable name expansion ${!PREFIX*} ${!PREFIX@} Substring removal ${VARIABLE#PATTERN} ${VARIABLE##PATTERN} ${VARIABLE%PATTERN} ${VARIABLE%%PATTERN} Search and replace ${VARIABLE/PATTERN/STRING} ${VARIABLE//PATTERN/STRING} for file in *; do; mv \"$file ${file// /_}\"; done; : Replace spaces with underscores ${VARIABLE/PATTERN} ${VARIABLE//PATTERN} String or array length ${#VARIABLE} Substring expansion ${VARIABLE:OFFSET} ${VARIABLE:OFFSET:LENGTH} Use a default value ${VARIABLE:-WORD} ${VARIABLE-WORD} Assign a default value ${VARIABLE:=WORD} ${VARIABLE=WORD} Use an alternate value ${VARIABLE:+WORD} ${VARIABLE+WORD} Display error if null or unset ${VARIABLE:?WORD} ${VARIABLE?WORD} file=\"$HOME/.secrets/007\" echo \"File location: $file\" # /home/lhunath/.secrets/007 echo \"Filename: ${file##*/}\" # 007 echo \"Directory: ${file%/*}\" # /home/lhunath/.secrets echo echo \"Non-secret file: ${file/secrets/not_secret}\" # /home/lhunath/.not_secret/007 echo echo \"Other file location: ${other:-There is no other file}\" # There is no other file echo \"Using file if there is no other file: ${other:=$file}\" # /home/lhunath/.secrets/007 echo \"Other filename: ${other##*/}\" # 007 echo \"Other file location length: ${#other}\" # 26 # Note: You cannot use multiple Param Exps together file=$HOME/image.jpg file=${file##*/} echo \"${file%.*}\" # image version=1.5.9 echo \"MAJOR: ${version%%.*}\" # MAJOR: 1 echo \"MINOR: ${version#*.}.\" # MINOR: 5.9. echo \"Dash: ${version/./-}\" # Dash: 1-5.9 echo \"Dashes: ${version//./-}.\" # Dashes: 1-5-9. parameter result ----------- ------------------------------ $name polish.ostrich.racing.champion ${name#*.} ostrich.racing.champion ${name##*.} champion ${name%%.*} polish ${name%.*} polish.ostrich.racing Brace expansions Brace expansions can only be used to generate lists of words. You can not use with variables because brace expansion happens before parameter expansion. for i in {1..$n} Won't work! {a,b,c} : a b c {foo,bar} : foo bar {1..15} : 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 {9..1} : 9 8 7 6 5 4 3 2 1 {A..g} : A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ \\ ] ^ _ \u00b4 a b c d e f g {e..a} : e d c b a {a..c} {x..z} : a b c x y z {1..3} {a..c} 1 2 3 a b c {1..3}{a..c} : 1a 1b 1c 2a 2b 2c 3a 3b 3c {0,1}{0..9} : 00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 https://www.gnu.org/software/bash/manual/html_node/Brace-Expansion.html Pattern Matching Globs (filename expansion) You can use it with ls , mkdir , echo , for i in {} Globs * : Matches any string, including the null string. But no the / chararcater */bin might match foo/bin but it cannot match /usr/local/bin . ? : Matches any single character. But no the / chararcater [...] : Matches any one of the enclosed characters. Extended Globs (off by default, activate with shopt -s extglob ) ?(pattern-list) : Matches zero or one occurrence of the given patterns. *(pattern-list) : Matches zero or more occurrences of the given patterns. +(pattern-list) : Matches one or more occurrences of the given patterns. @(pattern-list) : Matches one of the given patterns. !(pattern-list) : Matches anything except one of the given patterns. !(*jpg|*bmp) : anything that does not match the *jpg or the *bmp pattern Globs with brace expansion Because Brace expansion happens before Filename expansion, ls *{.jpg,.png} will become ls *.jpg *.png and then execute the comand.","title":"Bash scripting"},{"location":"1_cli/bash_scripting/#bash-scripting","text":"","title":"Bash scripting"},{"location":"1_cli/bash_scripting/#shells","text":"Terminal Promt Hashbang/Shebang Configuration file sh $ #!/bin/sh bash $ #!/bin/bash .bashrc zsh $ #!/bin/zsh csh or tcsh % #!/bin/csh [Shebang line](https://en.wikipedia.org/wiki/Shebang_(Unix): First line, This is going to be the interpreter: - #!/bin/sh : Bourne shell script - #!/bin/bash : Bash shell script ./myScript.sh - #!/usr/bin/env bash : Bash shell script - #!/usr/bin/python : Python script ./myScript.py - #!/usr/bin/env python : Python script (more portable because looks for python comand) ./myScript.py - #!/usr/bin/expect","title":"Shells"},{"location":"1_cli/bash_scripting/#static-program-analisis","text":"pacman -S shellcheck shellcheck yourscript https://www.shellcheck.net","title":"Static program analisis"},{"location":"1_cli/bash_scripting/#expect","text":"para automatizar scripts que tienen un input manual","title":"expect"},{"location":"1_cli/bash_scripting/#print-echo-printf","text":"echo echo Value is $myvarible : Print some variable badly echo 'Value is $myvarible' : Print some variable correctly (with newlines) echo \"Value is $myvarible\" : Print some variable correctly (with newlines) echo $PATH : Sitios donde la shell busca programas echo -n \"no new line\" : do not output the newline echo -e \"[33m ERROR\" : interpret backslash escapes (useful for displaying colors) enable interpretation of backslash escapes printf printf \"dfadf\" Sitios donde la shell busca programas","title":"Print: echo, printf"},{"location":"1_cli/bash_scripting/#generate-data","text":"touch Create a new file or changes the Last Modified time of an existing file. echo \"bla bla bla\" > file.txt seq seq 10 seq 3 9 primes 1 100","title":"Generate data"},{"location":"1_cli/bash_scripting/#see-current-date","text":"date cal","title":"\ud83d\udcc5 See current date"},{"location":"1_cli/bash_scripting/#file-descriptors-fd","text":"Every command (every porcess in fact) has its own file despcriptor table. By default (assuming your terminal is /dev/tty0): File descriptor Meaning Initial value 0 stdin /dev/tty0 1 stdout /dev/tty0 2 stderr /dev/tty0","title":"File descriptors (fd)"},{"location":"1_cli/bash_scripting/#style-output","text":"Use ~~ncurses~~ scape charaacters !!!","title":"Style output"},{"location":"1_cli/bash_scripting/#colours","text":"greenColour=\"\\e[0;32m\\033[1m\" endColour=\"\\033[0m\\e[0m\" redColour=\"\\e[0;31m\\033[1m\" blueColour=\"\\e[0;34m\\033[1m\" yellowColour=\"\\e[0;33m\\033[1m\" purpleColour=\"\\e[0;35m\\033[1m\" turquoiseColour=\"\\e[0;36m\\033[1m\" grayColour=\"\\e[0;37m\\033[1m\" # Example of usage echo -e \"\\n\\n${yellowColour}[*]${endColour}${grayColour} Exiting...\\n${endColour}\"","title":"Colours"},{"location":"1_cli/bash_scripting/#io-redirection","text":"IO Redirection modifies the file descriptors table of a command.","title":"IO Redirection"},{"location":"1_cli/bash_scripting/#redirect-fromto-file","text":"command < file # Redirect stdin to the command. FD0 = file command > file # Redirect stdout to file. FD1 = file command 1> file # Redirect stdout to file. FD1 = file command 2> file # Redirect stderr to file. FD2 = file command &> file # Redirect stdout & stderr to file FD1 = FD2 = file command > /dev/null # When we dont care about the output of a command echo hello > hello.txt # Crea (o sobrescribe) un fichero con la salida del programa anterior","title":"Redirect from/to file: &lt; &gt;"},{"location":"1_cli/bash_scripting/#redirect-output-of-several-comandas","text":"{ command1 command2 } > /some/file { command1; command2; } >/some/file { command1 & command2 & } >/some/file","title":"Redirect output of several comandas"},{"location":"1_cli/bash_scripting/#inplace-modify-the-same-file-sponge","text":"some_command_which_modifies /some/file | sponge /some/file head /some/file | sponge /some/file","title":"Inplace modify the same file: sponge"},{"location":"1_cli/bash_scripting/#append-to-file","text":"command >> file # Redirect and append stdout to a file. command 1>> file # Redirect and append stdout to file command 2>> file # Redirect and append stderr to file echo hello >> hello.txt # A\u00f1ade (append) a un fichero la salida del programa anterior","title":"Append to file: &gt;&gt;"},{"location":"1_cli/bash_scripting/#_1","text":"<< is known as here-document structure","title":"&lt;&lt;"},{"location":"1_cli/bash_scripting/#read-from-variable","text":"<<< is known as here-string structure","title":"Read from variable: &lt;&lt;&lt;"},{"location":"1_cli/bash_scripting/#pipelines","text":"","title":"Pipelines"},{"location":"1_cli/bash_scripting/#regular-pipes","text":"Assign the stdout (FD1) of the first command to the pipe. Assign the stdin (FD0) of the second command to the pipe. ls -l | tail -n2 # Pipe: Imprime solo los ultimos 2 ficheros ls -l | tail -n2 > hello.txt # Pipe and file writting ls | xargs rm # | xargs is when the inputs is IN THE ARGUMENTS rm $(ls) # same of above cmd1 |& cmd1 # command1's stdout AND stderr is redirected to command2's stdin Machine Learning with Unix Pipes","title":"Regular Pipes |"},{"location":"1_cli/bash_scripting/#named-pipes-mkfifo","text":"","title":"Named Pipes: mkfifo"},{"location":"1_cli/bash_scripting/#example-bash-script","text":"############## Variables myVar=someValue echo $myVar myVar = someValue # No funciona con espacios echo \"Value is $myVar\" # Imprime: Value is someValue echo 'Value is $myVar' # Imprime: Value is $myVar ############## Functions #!/bin/bash mcd () { mkdir -p \"$1\" cd \"$1\" } # $0: The name of the script # $1: The 1st argument # $9: The 9th argument ########## command substitution myDir=$(pwd) # The output of a command in a varaible echo \"we are in $(pwd)\" for file in $(ls)","title":"Example Bash script"},{"location":"1_cli/bash_scripting/#variables","text":"variables in funcions has global scope by defualt, (unless you define with local )","title":"Variables"},{"location":"1_cli/bash_scripting/#special-variables","text":"$0 : Name of the script $1 to $9 : Arguments to the script. \"$10\" and so on for the rest. $@ : All the arguments $# : Number of arguments $$ : Process identification number (PID) for the current script $? : Return code of the previous command !! : Entire last command, including arguments. A common pattern is to execute a command only for it to fail due to missing permissions; you can quickly re-execute the command with sudo by doing sudo !! $_ : Last argument from the last command. If you are in an interactive shell, you can also quickly get this value by typing Esc followed by . or Alt+.","title":"Special variables"},{"location":"1_cli/bash_scripting/#arrays","text":"An array is a numbered list of strings: It maps integers to strings. Creating Arrays names=(\"Bob\" \"Peter\" \"$USER\" \"Big Bad John\") Simple way names=([0]=\"Bob\" [1]=\"Peter\" [20]=\"$USER\" [21]=\"Big Bad John\") Explicit indexes (sparse array) names[0]=\"Bob\" files=(~/*.jpg) Result of a glob photos=(~/\"My Photos\"/*.jpg) Result of a glob files=$(ls) BAD, BAD, BAD! files=($(ls)) STILL BAD! files=(*) GOOD: filenames in the current directory http://mywiki.wooledge.org/BashGuide/Arrays http://mywiki.wooledge.org/BashFAQ/005","title":"Arrays"},{"location":"1_cli/bash_scripting/#associative-arrays-dictionaries","text":"fullNames=( [\"lhunath\"]=\"Maarten Billemont\" [\"greycat\"]=\"Greg Wooledge\" ) http://mywiki.wooledge.org/BashGuide/Arrays#Associative_Arrays http://mywiki.wooledge.org/BashFAQ/006","title":"Associative Arrays (Dictionaries)"},{"location":"1_cli/bash_scripting/#control-operators-and","text":"my_command_2 && my_command_2 # Do my_command_2 only if my_command_2 was success someCommand && echo \"Previos comand worked (exit estatus==0)\" someCommand || echo \"Previos comand failed (exit estatus!=0)\" rm /etc/some_file.conf || echo \"I couldn't remove the file\" [ a = a ]; echo $? # 0 (True) [ a = b ]; echo $? # 1 (False) true; echo $? # 0 (True) false; echo $? # 1 (False)","title":"Control Operators (&amp;&amp; and ||)"},{"location":"1_cli/bash_scripting/#if","text":"if [[ $filename = *.jpg ]]; then echo \"$filename is a jpeg\" fi","title":"If"},{"location":"1_cli/bash_scripting/#6-choices-case-and-select","text":"Each choice in a case statement consists of a pattern (or a list of patterns) case $LANG in en*) echo 'Hello!' ;; fr*) echo 'Salut!' ;; de*) echo 'Guten Tag!' ;; nl*) echo 'Hallo!' ;; it*) echo 'Ciao!' ;; es*) echo 'Hola!' ;; C|POSIX) echo 'hello world' ;; *) echo 'I do not speak your language.' ;; esac","title":"6. Choices (case and select)"},{"location":"1_cli/bash_scripting/#loops","text":"There are 4 different loops expressions: for variable in words : Repeat the loop for each word, setting variable to each word in turn. for i in 1 2 3 4 for i in {1..4} for file in *.mp3 for file in *.jpg *.jpeg for (( expr ; expr ; expr )) : C style for loop for (( i=1; i < 5; i++ )) while command : Repeat so long as command is executed successfully (exit code is 0). while (( i < 5 )) while true : Infinite loop while sleep 300 Infinite loop every 5 minutes while read -p \"Input something:\" input_variable Wait for user input until command : Repeat so long as command is executed unsuccessfully (exit code is not 0). Not very used because is the same as while ! command loop_expresion do commads done","title":"Loops"},{"location":"1_cli/bash_scripting/#while-loop","text":"while /bin/true do # Code goes here done while true; do # Code goes here done","title":"While loop"},{"location":"1_cli/bash_scripting/#functions","text":"Functions can only return an integer in range of 0 - 255.","title":"Functions"},{"location":"1_cli/bash_scripting/#parameter-expansion","text":"http://mywiki.wooledge.org/BashGuide/Parameters#Parameter_Expansion Simple usage $VARIABLE ${VARIABLE} Indirection ${!VARIABLE} Case modification ${VARIABLE^} ${VARIABLE^^} ${VARIABLE,} ${VARIABLE,,} ${VARIABLE~} ${VARIABLE~~} Variable name expansion ${!PREFIX*} ${!PREFIX@} Substring removal ${VARIABLE#PATTERN} ${VARIABLE##PATTERN} ${VARIABLE%PATTERN} ${VARIABLE%%PATTERN} Search and replace ${VARIABLE/PATTERN/STRING} ${VARIABLE//PATTERN/STRING} for file in *; do; mv \"$file ${file// /_}\"; done; : Replace spaces with underscores ${VARIABLE/PATTERN} ${VARIABLE//PATTERN} String or array length ${#VARIABLE} Substring expansion ${VARIABLE:OFFSET} ${VARIABLE:OFFSET:LENGTH} Use a default value ${VARIABLE:-WORD} ${VARIABLE-WORD} Assign a default value ${VARIABLE:=WORD} ${VARIABLE=WORD} Use an alternate value ${VARIABLE:+WORD} ${VARIABLE+WORD} Display error if null or unset ${VARIABLE:?WORD} ${VARIABLE?WORD} file=\"$HOME/.secrets/007\" echo \"File location: $file\" # /home/lhunath/.secrets/007 echo \"Filename: ${file##*/}\" # 007 echo \"Directory: ${file%/*}\" # /home/lhunath/.secrets echo echo \"Non-secret file: ${file/secrets/not_secret}\" # /home/lhunath/.not_secret/007 echo echo \"Other file location: ${other:-There is no other file}\" # There is no other file echo \"Using file if there is no other file: ${other:=$file}\" # /home/lhunath/.secrets/007 echo \"Other filename: ${other##*/}\" # 007 echo \"Other file location length: ${#other}\" # 26 # Note: You cannot use multiple Param Exps together file=$HOME/image.jpg file=${file##*/} echo \"${file%.*}\" # image version=1.5.9 echo \"MAJOR: ${version%%.*}\" # MAJOR: 1 echo \"MINOR: ${version#*.}.\" # MINOR: 5.9. echo \"Dash: ${version/./-}\" # Dash: 1-5.9 echo \"Dashes: ${version//./-}.\" # Dashes: 1-5-9. parameter result ----------- ------------------------------ $name polish.ostrich.racing.champion ${name#*.} ostrich.racing.champion ${name##*.} champion ${name%%.*} polish ${name%.*} polish.ostrich.racing","title":"Parameter expansion"},{"location":"1_cli/bash_scripting/#brace-expansions","text":"Brace expansions can only be used to generate lists of words. You can not use with variables because brace expansion happens before parameter expansion. for i in {1..$n} Won't work! {a,b,c} : a b c {foo,bar} : foo bar {1..15} : 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 {9..1} : 9 8 7 6 5 4 3 2 1 {A..g} : A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ \\ ] ^ _ \u00b4 a b c d e f g {e..a} : e d c b a {a..c} {x..z} : a b c x y z {1..3} {a..c} 1 2 3 a b c {1..3}{a..c} : 1a 1b 1c 2a 2b 2c 3a 3b 3c {0,1}{0..9} : 00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 https://www.gnu.org/software/bash/manual/html_node/Brace-Expansion.html Pattern Matching","title":"Brace expansions"},{"location":"1_cli/bash_scripting/#globs-filename-expansion","text":"You can use it with ls , mkdir , echo , for i in {} Globs * : Matches any string, including the null string. But no the / chararcater */bin might match foo/bin but it cannot match /usr/local/bin . ? : Matches any single character. But no the / chararcater [...] : Matches any one of the enclosed characters. Extended Globs (off by default, activate with shopt -s extglob ) ?(pattern-list) : Matches zero or one occurrence of the given patterns. *(pattern-list) : Matches zero or more occurrences of the given patterns. +(pattern-list) : Matches one or more occurrences of the given patterns. @(pattern-list) : Matches one of the given patterns. !(pattern-list) : Matches anything except one of the given patterns. !(*jpg|*bmp) : anything that does not match the *jpg or the *bmp pattern","title":"Globs (filename expansion)"},{"location":"1_cli/bash_scripting/#globs-with-brace-expansion","text":"Because Brace expansion happens before Filename expansion, ls *{.jpg,.png} will become ls *.jpg *.png and then execute the comand.","title":"Globs with brace expansion"},{"location":"1_cli/compression/","text":"\ud83d\udce6 Compression | Format | Compress | Preview | Decompress | |-------------|-----------------------|-------------- | | 7z l compressedFile | 7z x compressedFile | | | base64 | | base64 -d | zip file | | | tar -cvf compr.tar /dir/ tar file | | tar -xf | | | .gz | gunzip | | | bzip2` | | | Format | Extension | Tool |---------|-----------------| | ZIP | | | TAR | .tar.gz o .tgz | | GNU zip | .gz o .gzip | | p7zip | .7z | | BZIP2 | .bz2 | bzip2 FILE(S) | bzip2 \u2013d test.txt XZ GZIP TAR WIM .tar.bz2 o .tbz2 .tar.xz o .xz o .txz .gz o .gzip o .bzip2 .tar.lzma o .tlz:","title":"Compression"},{"location":"1_cli/compression/#compression","text":"| Format | Compress | Preview | Decompress | |-------------|-----------------------|-------------- | | 7z l compressedFile | 7z x compressedFile | | | base64 | | base64 -d | zip file | | | tar -cvf compr.tar /dir/ tar file | | tar -xf | | | .gz | gunzip | | | bzip2` | | | Format | Extension | Tool |---------|-----------------| | ZIP | | | TAR | .tar.gz o .tgz | | GNU zip | .gz o .gzip | | p7zip | .7z | | BZIP2 | .bz2 | bzip2 FILE(S) | bzip2 \u2013d test.txt XZ GZIP TAR WIM .tar.bz2 o .tbz2 .tar.xz o .xz o .txz .gz o .gzip o .bzip2 .tar.lzma o .tlz:","title":"\ud83d\udce6 Compression"},{"location":"1_cli/cryptography/","text":"\ud83d\udd11 Cryptography Hash function: MD5, SHA-1, SHA-256 Non invertible Collision redundant md5 myFile.txt shasum myFile.txt sha1sum myFile.txt Symetric cryptography (1 key) keygen() -> key encrypt(plaintext, key) -> ciphertext decrypt(ciphertext, key) -> plaintext # AES openssl aes-256-cbc -salt -in aaa.py -out aaa.py.enc # Encription openssl aes-256-cbc -d -in aaa.py.ec -out aaa2.py # Decryption Asymmetric cryptography (public & private keys) keygen() -> public key, private key La clave p\u00fablica solo se usa para cifrar (la usar\u00e1 el otro) La clave privada solo se usa para descifrar (la usar\u00e9 yo) encrypt(plaintext, public key) -> ciphertext decrypt(ciphertext, private key) -> plaintext En general todo aque que quiera que LE LLEGEN los mensajes privados, debe comunicar su public key. Si AMBOS extremos comunican su public key, la comunicaci\u00f3n ser\u00e1 cifrada Ejemplos: - RSA - ED25519: more secure # RSA Hybrid cryptography Presmisa: - La Symetric cryptography es r\u00e1pida - La Asymmetric cryptography es lenta Entoces: Usar la Asymmetric cryptography SOLO PARA INTERCAMBIAR LA CLAVE SIMETRICA. Asi ya se tiene una Symetric cryptography que es m\u00e1s r\u00e1pida que la Asymmetric Asymmetric cryptography for signing keygen() -> public key, private key sign(message, private key) -> signature verify(message, signature, public key) -> bool (whether or not the signature is valid)","title":"\ud83d\udd11 Cryptography"},{"location":"1_cli/cryptography/#cryptography","text":"","title":"\ud83d\udd11 Cryptography"},{"location":"1_cli/cryptography/#hash-function-md5-sha-1-sha-256","text":"Non invertible Collision redundant md5 myFile.txt shasum myFile.txt sha1sum myFile.txt","title":"Hash function: MD5, SHA-1, SHA-256"},{"location":"1_cli/cryptography/#symetric-cryptography-1-key","text":"keygen() -> key encrypt(plaintext, key) -> ciphertext decrypt(ciphertext, key) -> plaintext # AES openssl aes-256-cbc -salt -in aaa.py -out aaa.py.enc # Encription openssl aes-256-cbc -d -in aaa.py.ec -out aaa2.py # Decryption","title":"Symetric cryptography (1 key)"},{"location":"1_cli/cryptography/#asymmetric-cryptography-public-private-keys","text":"keygen() -> public key, private key La clave p\u00fablica solo se usa para cifrar (la usar\u00e1 el otro) La clave privada solo se usa para descifrar (la usar\u00e9 yo) encrypt(plaintext, public key) -> ciphertext decrypt(ciphertext, private key) -> plaintext En general todo aque que quiera que LE LLEGEN los mensajes privados, debe comunicar su public key. Si AMBOS extremos comunican su public key, la comunicaci\u00f3n ser\u00e1 cifrada Ejemplos: - RSA - ED25519: more secure # RSA","title":"Asymmetric cryptography (public &amp; private keys)"},{"location":"1_cli/cryptography/#hybrid-cryptography","text":"Presmisa: - La Symetric cryptography es r\u00e1pida - La Asymmetric cryptography es lenta Entoces: Usar la Asymmetric cryptography SOLO PARA INTERCAMBIAR LA CLAVE SIMETRICA. Asi ya se tiene una Symetric cryptography que es m\u00e1s r\u00e1pida que la Asymmetric","title":"Hybrid cryptography"},{"location":"1_cli/cryptography/#asymmetric-cryptography-for-signing","text":"keygen() -> public key, private key sign(message, private key) -> signature verify(message, signature, public key) -> bool (whether or not the signature is valid)","title":"Asymmetric cryptography for signing"},{"location":"1_cli/customization/","text":"\ud83c\udfa8 Customization (dotfiles) bash: ~/.bashrc , ~/.bash_profile zsh ~/.zshrc git: ~/.gitconfig vim: ~/.vimrc and the ~/.vim folder ssh: ~/.ssh/config tmux: ~/.tmux.conf nano: ~/.nanorc ZSH ~/.zshrc Change to zsh: sudo chsh -s /usr/bin/zsh javi curl -L http://install.ohmyz.sh | sh Change Bash to ZSH $ sudo pacman -S zsh # Install ZSH (and extras) $ zsh # Make sure that ZSH has been installed correctly $ chsh -l # List all installed shells $ chsh -s /usr/bin/zsh # WAY 1) Set new default shell (zsh) for your user $ usermod --shell /usr/bin/zsh javi # WAY 2) Set new default shell (zsh) for a user (S4vitar lo hizo asi) $ nano /etc/passwd # WAY 3) Set new default shell (zsh) for a user $ echo $SHELL # Comprobar la nueva shell https://wiki.archlinux.org/title/zsh#Installation https://wiki.archlinux.org/title/Command-line_shell#Changing_your_default_shell 3 Ways to Change a Users Default Shell Better prompt -> zsh-theme-powerlevel10k $ sudo pacman -S zsh-theme-powerlevel10k $ echo 'source /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme' >> ~/.zshrc $ source ~/.zshrc $ p10k configure https://github.com/ahillio/powerlevel10k/blob/master/README.md#arch-linux Colors on terminal outout alias ls='ls --color=auto' alias diff='diff --color=auto' alias grep='grep --color=auto' alias ip='ip -color=auto' Pacman has a color option. Uncomment the Color line in /etc/pacman.conf . https://wiki.archlinux.org/title/Color_output_in_console Other way is to install grml-zsh-config Colors on terminal commands -> zsh-syntax-highlighting $ sudo pacman -S zsh-syntax-highlighting $ echo 'source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh' >> ~/.zshrc Sugerir comandos del pasado -> zsh-autosuggestions $ sudo pacman -S zsh-autosuggestions $ echo 'source /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh' >> ~/.zshrc ZSH: Other plugins zsh-completions zsh-sudo -> con esc esc te pone sudo al principio (source /usr/share/zsh-sudo/sudo.plugin.zsh ) zsh-suggestions fzf -> con ctrl + T busca # ZSH pluggins source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh source /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh source /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme # General alias l='lsd' alias ls='lsd' alias ll='lsd -l' alias la='lsd -a' alias lla='lsd -la' alias tree='lsd --tree' # Jupyter notebook alias jn=\"jupyter notebook\" # Pacman alias i=\"sudo pacman -S\" # install a package alias s=\"pacman -Ss\" # search for a package alias u=\"sudo pacman -Syu\" # update the packages alias r=\"sudo pacman -Rns\" # remove a package alias install=\"sudo pacman -S\" # install a package alias search=\"pacman -Ss\" # search for a package alias update=\"sudo pacman -Syu\" # update the packages alias remove=\"sudo pacman -Rns\" # remove a package # Others alias title=\"figlet\" # Git function commit() { git add . msg=$@ # Every argument git commit -m \"$msg\" git push } Nano: ~/.nanorc set autoindent # Tthe newly created line will contain the same indent as the preceding line set tabsize 4 # Use a tab size of number columns. The default value is 8. set softwrap # Enable soft line wrapping for easier viewing of very long lines set nowrap # Don\u2019t hard-wrap text at all # set nohelp # Don\u2019t display the two help lines at the bottom of the screen. set linenumbers # Display of line numbers in front of the text. include \"/usr/share/nano/*.nanorc\" # Default Syntax highlighting include \"/usr/share/nano-syntax-highlighting/*.nanorc\" # syntax highlighting enhancements* sudo pacman -S nano-syntax-highlighting TMUX ~/.tmux.conf ####### SAME PROMT set -g default-terminal \"screen-256color\" if 'infocmp -x tmux-256color > /dev/null 2>&1' 'set -g default-terminal \"tmux-256color\"' ####### MOUSE (enable scroll) set -g mouse on # For tmux version 2.1 and above set -g terminal-overrides 'xterm*:smcup@:rmcup@' # Sane scrolling (instead of mimic arrrow keys) ####### Number windows and panes start at 1 instead of 0 set -g base-index 1 set -g pane-base-index 1 Oh my tmux! : Self-contained, pretty & versatile tmux configuration Practical Tmux VIM: ~/.vimrc \" Comments in Vimscript start with a `\"`. \" If you open this file in Vim, it'll be syntax highlighted for you. \" Vim is based on Vi. Setting `nocompatible` switches from the default \" Vi-compatibility mode and enables useful Vim functionality. This \" configuration option turns out not to be necessary for the file named \" '~/.vimrc', because Vim automatically enters nocompatible mode if that file \" is present. But we're including it here just in case this config file is \" loaded some other way (e.g. saved as `foo`, and then Vim started with \" `vim -u foo`). set nocompatible \" Use a line cursor within insert mode and a block cursor everywhere else. \" \" Using iTerm2? Go-to preferences / profile / colors and disable the smart bar \" cursor color. Then pick a cursor and highlight color that matches your theme. \" That will ensure your cursor is always visible within insert mode. \" \" Reference chart of values: \" Ps = 0 -> blinking block. \" Ps = 1 -> blinking block (default). \" Ps = 2 -> steady block. \" Ps = 3 -> blinking underline. \" Ps = 4 -> steady underline. \" Ps = 5 -> blinking bar (xterm). \" Ps = 6 -> steady bar (xterm). let &t_SI = \"\\e[6 q\" let &t_EI = \"\\e[2 q\" \" Turn on syntax highlighting. syntax on \" Disable the default Vim startup message. set shortmess+=I \" Show line numbers. set number \" This enables relative line numbering mode. With both number and \" relativenumber enabled, the current line shows the true line number, while \" all other lines (above and below) are numbered relative to the current line. \" This is useful because you can tell, at a glance, what count is needed to \" jump up or down to a particular line, by {count}k to go up or {count}j to go \" down. set relativenumber \" Always show the status line at the bottom, even if you only have one window open. set laststatus=2 \" The backspace key has slightly unintuitive behavior by default. For example, \" by default, you can't backspace before the insertion point set with 'i'. \" This configuration makes backspace behave more reasonably, in that you can \" backspace over anything. set backspace=indent,eol,start \" By default, Vim doesn't let you hide a buffer (i.e. have a buffer that isn't \" shown in any window) that has unsaved changes. This is to prevent you from \" \" forgetting about unsaved changes and then quitting e.g. via `:qa!`. We find \" hidden buffers helpful enough to disable this protection. See `:help hidden` \" for more information on this. set hidden \" This setting makes search case-insensitive when all characters in the string \" being searched are lowercase. However, the search becomes case-sensitive if \" it contains any capital letters. This makes searching more convenient. set ignorecase set smartcase \" Enable searching as you type, rather than waiting till you press enter. set incsearch \" Unbind some useless/annoying default key bindings. nmap Q <Nop> \" 'Q' in normal mode enters Ex mode. You almost never want this. \" Disable audible bell because it's annoying. set noerrorbells visualbell t_vb= \" Enable mouse support. You should avoid relying on this too much, but it can \" sometimes be convenient. set mouse+=a \" Try to prevent bad habits like using the arrow keys for movement. This is \" not the only possible bad habit. For example, holding down the h/j/k/l keys \" for movement, rather than using more efficient movement commands, is also a \" bad habit. The former is enforceable through a .vimrc, while we don't know \" how to prevent the latter. \" Do this in normal mode... nnoremap <Left> :echoe \"Use h\"<CR> nnoremap <Right> :echoe \"Use l\"<CR> nnoremap <Up> :echoe \"Use k\"<CR> nnoremap <Down> :echoe \"Use j\"<CR> \" ...and in insert mode inoremap <Left> <ESC>:echoe \"Use h\"<CR> inoremap <Right> <ESC>:echoe \"Use l\"<CR> inoremap <Up> <ESC>:echoe \"Use k\"<CR> inoremap <Down> <ESC>:echoe \"Use j\"<CR> NeoVIM: ~/.vimrc sudo pacman -S neovim iTerm2 Shell Integration curl -L https://iterm2.com/shell_integration/zsh -o ~/.iterm2_shell_integration.zsh source ~/.iterm2_shell_integration.zsh # Add this line at ~/.zshrc # If hostname command not found install https://www.gnu.org/software/inetutils/ sudo pacman -S inetutils Download files from remote hosts with a click. You can right click on a filename (e.g., in the output of ls) to download it. Drag-drop files to upload with scp. Hold down option and drag-drop a file from Finder into iTerm2 to upload it. imgcat wget https://iterm2.com/utilities/imgcat ; chmod 755 imgcat` Ranger + imgcat Set NTP time sudo pacman -S ntp sudo timedatectl set-ntp true Comunity configs/dotfiles Savitar https://www.youtube.com/watch?v=fshLf6u8B-w&t=3276s https://s4vitar.github.io/bspwm-configuration-files/# Josean Martinez Terminal https://www.youtube.com/watch?v=CF1tMjvHDRA https://github.com/rxyhn/dotfiles","title":"\ud83c\udfa8 Customization (dotfiles)"},{"location":"1_cli/customization/#customization-dotfiles","text":"bash: ~/.bashrc , ~/.bash_profile zsh ~/.zshrc git: ~/.gitconfig vim: ~/.vimrc and the ~/.vim folder ssh: ~/.ssh/config tmux: ~/.tmux.conf nano: ~/.nanorc","title":"\ud83c\udfa8 Customization (dotfiles)"},{"location":"1_cli/customization/#zsh-zshrc","text":"Change to zsh: sudo chsh -s /usr/bin/zsh javi curl -L http://install.ohmyz.sh | sh","title":"ZSH ~/.zshrc"},{"location":"1_cli/customization/#change-bash-to-zsh","text":"$ sudo pacman -S zsh # Install ZSH (and extras) $ zsh # Make sure that ZSH has been installed correctly $ chsh -l # List all installed shells $ chsh -s /usr/bin/zsh # WAY 1) Set new default shell (zsh) for your user $ usermod --shell /usr/bin/zsh javi # WAY 2) Set new default shell (zsh) for a user (S4vitar lo hizo asi) $ nano /etc/passwd # WAY 3) Set new default shell (zsh) for a user $ echo $SHELL # Comprobar la nueva shell https://wiki.archlinux.org/title/zsh#Installation https://wiki.archlinux.org/title/Command-line_shell#Changing_your_default_shell 3 Ways to Change a Users Default Shell","title":"Change Bash to ZSH"},{"location":"1_cli/customization/#better-prompt-zsh-theme-powerlevel10k","text":"$ sudo pacman -S zsh-theme-powerlevel10k $ echo 'source /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme' >> ~/.zshrc $ source ~/.zshrc $ p10k configure https://github.com/ahillio/powerlevel10k/blob/master/README.md#arch-linux","title":"Better prompt -&gt; zsh-theme-powerlevel10k"},{"location":"1_cli/customization/#colors-on-terminal-outout","text":"alias ls='ls --color=auto' alias diff='diff --color=auto' alias grep='grep --color=auto' alias ip='ip -color=auto' Pacman has a color option. Uncomment the Color line in /etc/pacman.conf . https://wiki.archlinux.org/title/Color_output_in_console Other way is to install grml-zsh-config","title":"Colors on terminal outout"},{"location":"1_cli/customization/#colors-on-terminal-commands-zsh-syntax-highlighting","text":"$ sudo pacman -S zsh-syntax-highlighting $ echo 'source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh' >> ~/.zshrc","title":"Colors on terminal commands -&gt; zsh-syntax-highlighting"},{"location":"1_cli/customization/#sugerir-comandos-del-pasado-zsh-autosuggestions","text":"$ sudo pacman -S zsh-autosuggestions $ echo 'source /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh' >> ~/.zshrc","title":"Sugerir comandos del pasado -&gt; zsh-autosuggestions"},{"location":"1_cli/customization/#zsh-other-plugins","text":"zsh-completions zsh-sudo -> con esc esc te pone sudo al principio (source /usr/share/zsh-sudo/sudo.plugin.zsh ) zsh-suggestions fzf -> con ctrl + T busca # ZSH pluggins source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh source /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh source /usr/share/zsh-theme-powerlevel10k/powerlevel10k.zsh-theme # General alias l='lsd' alias ls='lsd' alias ll='lsd -l' alias la='lsd -a' alias lla='lsd -la' alias tree='lsd --tree' # Jupyter notebook alias jn=\"jupyter notebook\" # Pacman alias i=\"sudo pacman -S\" # install a package alias s=\"pacman -Ss\" # search for a package alias u=\"sudo pacman -Syu\" # update the packages alias r=\"sudo pacman -Rns\" # remove a package alias install=\"sudo pacman -S\" # install a package alias search=\"pacman -Ss\" # search for a package alias update=\"sudo pacman -Syu\" # update the packages alias remove=\"sudo pacman -Rns\" # remove a package # Others alias title=\"figlet\" # Git function commit() { git add . msg=$@ # Every argument git commit -m \"$msg\" git push }","title":"ZSH: Other plugins"},{"location":"1_cli/customization/#nano-nanorc","text":"set autoindent # Tthe newly created line will contain the same indent as the preceding line set tabsize 4 # Use a tab size of number columns. The default value is 8. set softwrap # Enable soft line wrapping for easier viewing of very long lines set nowrap # Don\u2019t hard-wrap text at all # set nohelp # Don\u2019t display the two help lines at the bottom of the screen. set linenumbers # Display of line numbers in front of the text. include \"/usr/share/nano/*.nanorc\" # Default Syntax highlighting include \"/usr/share/nano-syntax-highlighting/*.nanorc\" # syntax highlighting enhancements* sudo pacman -S nano-syntax-highlighting","title":"Nano: ~/.nanorc"},{"location":"1_cli/customization/#tmux-tmuxconf","text":"####### SAME PROMT set -g default-terminal \"screen-256color\" if 'infocmp -x tmux-256color > /dev/null 2>&1' 'set -g default-terminal \"tmux-256color\"' ####### MOUSE (enable scroll) set -g mouse on # For tmux version 2.1 and above set -g terminal-overrides 'xterm*:smcup@:rmcup@' # Sane scrolling (instead of mimic arrrow keys) ####### Number windows and panes start at 1 instead of 0 set -g base-index 1 set -g pane-base-index 1 Oh my tmux! : Self-contained, pretty & versatile tmux configuration Practical Tmux","title":"TMUX ~/.tmux.conf"},{"location":"1_cli/customization/#vim-vimrc","text":"\" Comments in Vimscript start with a `\"`. \" If you open this file in Vim, it'll be syntax highlighted for you. \" Vim is based on Vi. Setting `nocompatible` switches from the default \" Vi-compatibility mode and enables useful Vim functionality. This \" configuration option turns out not to be necessary for the file named \" '~/.vimrc', because Vim automatically enters nocompatible mode if that file \" is present. But we're including it here just in case this config file is \" loaded some other way (e.g. saved as `foo`, and then Vim started with \" `vim -u foo`). set nocompatible \" Use a line cursor within insert mode and a block cursor everywhere else. \" \" Using iTerm2? Go-to preferences / profile / colors and disable the smart bar \" cursor color. Then pick a cursor and highlight color that matches your theme. \" That will ensure your cursor is always visible within insert mode. \" \" Reference chart of values: \" Ps = 0 -> blinking block. \" Ps = 1 -> blinking block (default). \" Ps = 2 -> steady block. \" Ps = 3 -> blinking underline. \" Ps = 4 -> steady underline. \" Ps = 5 -> blinking bar (xterm). \" Ps = 6 -> steady bar (xterm). let &t_SI = \"\\e[6 q\" let &t_EI = \"\\e[2 q\" \" Turn on syntax highlighting. syntax on \" Disable the default Vim startup message. set shortmess+=I \" Show line numbers. set number \" This enables relative line numbering mode. With both number and \" relativenumber enabled, the current line shows the true line number, while \" all other lines (above and below) are numbered relative to the current line. \" This is useful because you can tell, at a glance, what count is needed to \" jump up or down to a particular line, by {count}k to go up or {count}j to go \" down. set relativenumber \" Always show the status line at the bottom, even if you only have one window open. set laststatus=2 \" The backspace key has slightly unintuitive behavior by default. For example, \" by default, you can't backspace before the insertion point set with 'i'. \" This configuration makes backspace behave more reasonably, in that you can \" backspace over anything. set backspace=indent,eol,start \" By default, Vim doesn't let you hide a buffer (i.e. have a buffer that isn't \" shown in any window) that has unsaved changes. This is to prevent you from \" \" forgetting about unsaved changes and then quitting e.g. via `:qa!`. We find \" hidden buffers helpful enough to disable this protection. See `:help hidden` \" for more information on this. set hidden \" This setting makes search case-insensitive when all characters in the string \" being searched are lowercase. However, the search becomes case-sensitive if \" it contains any capital letters. This makes searching more convenient. set ignorecase set smartcase \" Enable searching as you type, rather than waiting till you press enter. set incsearch \" Unbind some useless/annoying default key bindings. nmap Q <Nop> \" 'Q' in normal mode enters Ex mode. You almost never want this. \" Disable audible bell because it's annoying. set noerrorbells visualbell t_vb= \" Enable mouse support. You should avoid relying on this too much, but it can \" sometimes be convenient. set mouse+=a \" Try to prevent bad habits like using the arrow keys for movement. This is \" not the only possible bad habit. For example, holding down the h/j/k/l keys \" for movement, rather than using more efficient movement commands, is also a \" bad habit. The former is enforceable through a .vimrc, while we don't know \" how to prevent the latter. \" Do this in normal mode... nnoremap <Left> :echoe \"Use h\"<CR> nnoremap <Right> :echoe \"Use l\"<CR> nnoremap <Up> :echoe \"Use k\"<CR> nnoremap <Down> :echoe \"Use j\"<CR> \" ...and in insert mode inoremap <Left> <ESC>:echoe \"Use h\"<CR> inoremap <Right> <ESC>:echoe \"Use l\"<CR> inoremap <Up> <ESC>:echoe \"Use k\"<CR> inoremap <Down> <ESC>:echoe \"Use j\"<CR>","title":"VIM: ~/.vimrc"},{"location":"1_cli/customization/#neovim-vimrc","text":"sudo pacman -S neovim","title":"NeoVIM: ~/.vimrc"},{"location":"1_cli/customization/#iterm2","text":"","title":"iTerm2"},{"location":"1_cli/customization/#shell-integration","text":"curl -L https://iterm2.com/shell_integration/zsh -o ~/.iterm2_shell_integration.zsh source ~/.iterm2_shell_integration.zsh # Add this line at ~/.zshrc # If hostname command not found install https://www.gnu.org/software/inetutils/ sudo pacman -S inetutils Download files from remote hosts with a click. You can right click on a filename (e.g., in the output of ls) to download it. Drag-drop files to upload with scp. Hold down option and drag-drop a file from Finder into iTerm2 to upload it.","title":"Shell Integration"},{"location":"1_cli/customization/#imgcat","text":"wget https://iterm2.com/utilities/imgcat ; chmod 755 imgcat` Ranger + imgcat","title":"imgcat"},{"location":"1_cli/customization/#set-ntp-time","text":"sudo pacman -S ntp sudo timedatectl set-ntp true","title":"Set NTP time"},{"location":"1_cli/customization/#comunity-configsdotfiles","text":"Savitar https://www.youtube.com/watch?v=fshLf6u8B-w&t=3276s https://s4vitar.github.io/bspwm-configuration-files/# Josean Martinez Terminal https://www.youtube.com/watch?v=CF1tMjvHDRA https://github.com/rxyhn/dotfiles","title":"Comunity configs/dotfiles"},{"location":"1_cli/git/","text":"Git Setup 1. Git Install git: sudo pacman -S github-cli Configure git: $ git config --global user.name \"Javi\" $ git config --global user.email franfdk17@gmail.com $ git config --global core.editor nano 2. Github Go to Github.com -> Settings -> Developer settings -> Personal access tokens https://github.com/settings/tokens Generate a Personal Access Token (PAT) with the minimum required scopes are 'repo', 'read:org', 'workflow' Copy the Personal Access Token Go to the terminal and install the GitHub CLI On Mac: brew install gh On Archlinux: sudo pacman -S github-cli In the terminal, enter gh auth login , then follow the prompts. What account do you want to log into? GitHub.com What is your preferred protocol for Git operations? HTTPS Authenticate Git with your GitHub credentials? Yes How would you like to authenticate GitHub CLI? Paste an authentication token here Old way (deprecated and unsecure) Save in ~/.git-credentials -> https://USER:PASS@github.com Execute git config --global credential.helper store https://atareao.es/software/programacion/github-en-el-terminal/ Git basics Undo local changes: git checkout . # Revert modified files (in this . directory) git clean -fd # Remove new untracked files (-f) and new directories (-d): Github Actions Archivo YAML ubicado en: .github/workflows/mi_nombre.yml Basic syntax Minimal action example: name: Simple workflow # 1) Nombre de la acci\u00f3n/workflow [OPTIONAL] on: [push] # 2) Cuando se ejecutar\u00e1 (el trigger) [REQUIRED] jobs: # 3) Que har\u00e1 example-job-1: # Trabajo 1 runs-on: ubuntu-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 1 was automatically triggered!\" Ejemplos de triggers disponibles on: # MANUALMENTE (desde la interfaz de github) workflow_dispatch: # PERIODICAMENTE ( with delay :( ) # Generally, the delay time is about 3 to 10 minutes. # Sometimes, it may be more, even dozens of minutes, or more than one hour. schedule: # * is a special character in YAML so you have to quote this string - cron: '30 5,17 * * *' # Cuando haces un push al repo [push] # Cuando haces un push en la rama master push: branches: - master # Cuando te hacen crean un pull request o un issue [pull_request_target, issues] Ejemplos de acciones disponibles run : Acciones propias para ejecutar comandos uses : Acciones de terceros disponibles el github actions marketplace. sintaxis: user/repo@version . # ACCION QUE TE CLONA EL REPO EN LA MAQUINA VIRTUAL - name: \u2b07\ufe0f Checkout the repo uses: actions/checkout@master with: fetch-depth: 1 ####################### # ACCION QUE PONE EL PYTHON EN LA MAQUINA VIRTUAL - name: \ud83d\udc0d Set up Python 3.8 uses: actions/setup-python@v2 with: python-version: '3.8' # ACCION QUE TE INSTALA ALGUN PAQUETE DE PYTHON - name: \ud83d\udcbf Install Zotero2Readwise Python package run: pip install zotero2readwise # ACCION QUE EJECUTA ALGUN SCRIPT DE PYTHON - name: \ud83d\ude80 Run Automation run: python run.py ${{ secrets.READWISE_TOKEN }} ${{ secrets.ZOTERO_KEY }} ${{ secrets.ZOTERO_ID }} ################## - name: Give permision to some script run: chmod +x my_script - name: Run script run: ./permision ################## - name: Commit and push changes run: | git config --global user.name \"your username\" git config --global user.email \"your email\" git add -A git commit -m \"commit message\" git push Ejecucion de trabajos en paralelo name: Simple workflow # Nombre de la acci\u00f3n/workflow on: [push] # Cuando se ejecuta (el trigger) jobs: example-job-1: # Trabajo 1 runs-on: ubuntu-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 1 was automatically triggered!\" example-job-1: # Trabajo 2 (se ejecuta en paralelo al trabajo 1) runs-on: windows-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 2 was automatically triggered!\" Ejecucion condicional name: Simple workflow # Nombre de la acci\u00f3n/workflow on: [push] # Cuando se ejecuta (el trigger) jobs: example-job-1: # Trabajo 1 runs-on: ubuntu-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 1 was automatically triggered!\" example-job-1: # Trabajo 2 (se ejecuta despues del trabajo 1) needs: example-job-1 runs-on: windows-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 2 was automatically triggered!\" References Using Github Actions & Pages to Publish Static Pages Based on Dynamic Data (Oct 2, 2021) CI/CD for Machine Learning: Test and Deploy Your ML Model with GitHub Actions (Jun 08, 2022)","title":"Git"},{"location":"1_cli/git/#git","text":"","title":"Git"},{"location":"1_cli/git/#setup","text":"","title":"Setup"},{"location":"1_cli/git/#1-git","text":"Install git: sudo pacman -S github-cli Configure git: $ git config --global user.name \"Javi\" $ git config --global user.email franfdk17@gmail.com $ git config --global core.editor nano","title":"1. Git"},{"location":"1_cli/git/#2-github","text":"Go to Github.com -> Settings -> Developer settings -> Personal access tokens https://github.com/settings/tokens Generate a Personal Access Token (PAT) with the minimum required scopes are 'repo', 'read:org', 'workflow' Copy the Personal Access Token Go to the terminal and install the GitHub CLI On Mac: brew install gh On Archlinux: sudo pacman -S github-cli In the terminal, enter gh auth login , then follow the prompts. What account do you want to log into? GitHub.com What is your preferred protocol for Git operations? HTTPS Authenticate Git with your GitHub credentials? Yes How would you like to authenticate GitHub CLI? Paste an authentication token here","title":"2. Github"},{"location":"1_cli/git/#old-way-deprecated-and-unsecure","text":"Save in ~/.git-credentials -> https://USER:PASS@github.com Execute git config --global credential.helper store https://atareao.es/software/programacion/github-en-el-terminal/","title":"Old way (deprecated and unsecure)"},{"location":"1_cli/git/#git-basics","text":"Undo local changes: git checkout . # Revert modified files (in this . directory) git clean -fd # Remove new untracked files (-f) and new directories (-d):","title":"Git basics"},{"location":"1_cli/git/#github-actions","text":"Archivo YAML ubicado en: .github/workflows/mi_nombre.yml","title":"Github Actions"},{"location":"1_cli/git/#basic-syntax","text":"Minimal action example: name: Simple workflow # 1) Nombre de la acci\u00f3n/workflow [OPTIONAL] on: [push] # 2) Cuando se ejecutar\u00e1 (el trigger) [REQUIRED] jobs: # 3) Que har\u00e1 example-job-1: # Trabajo 1 runs-on: ubuntu-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 1 was automatically triggered!\"","title":"Basic syntax"},{"location":"1_cli/git/#ejemplos-de-triggers-disponibles","text":"on: # MANUALMENTE (desde la interfaz de github) workflow_dispatch: # PERIODICAMENTE ( with delay :( ) # Generally, the delay time is about 3 to 10 minutes. # Sometimes, it may be more, even dozens of minutes, or more than one hour. schedule: # * is a special character in YAML so you have to quote this string - cron: '30 5,17 * * *' # Cuando haces un push al repo [push] # Cuando haces un push en la rama master push: branches: - master # Cuando te hacen crean un pull request o un issue [pull_request_target, issues]","title":"Ejemplos de triggers disponibles"},{"location":"1_cli/git/#ejemplos-de-acciones-disponibles","text":"run : Acciones propias para ejecutar comandos uses : Acciones de terceros disponibles el github actions marketplace. sintaxis: user/repo@version . # ACCION QUE TE CLONA EL REPO EN LA MAQUINA VIRTUAL - name: \u2b07\ufe0f Checkout the repo uses: actions/checkout@master with: fetch-depth: 1 ####################### # ACCION QUE PONE EL PYTHON EN LA MAQUINA VIRTUAL - name: \ud83d\udc0d Set up Python 3.8 uses: actions/setup-python@v2 with: python-version: '3.8' # ACCION QUE TE INSTALA ALGUN PAQUETE DE PYTHON - name: \ud83d\udcbf Install Zotero2Readwise Python package run: pip install zotero2readwise # ACCION QUE EJECUTA ALGUN SCRIPT DE PYTHON - name: \ud83d\ude80 Run Automation run: python run.py ${{ secrets.READWISE_TOKEN }} ${{ secrets.ZOTERO_KEY }} ${{ secrets.ZOTERO_ID }} ################## - name: Give permision to some script run: chmod +x my_script - name: Run script run: ./permision ################## - name: Commit and push changes run: | git config --global user.name \"your username\" git config --global user.email \"your email\" git add -A git commit -m \"commit message\" git push","title":"Ejemplos de acciones disponibles"},{"location":"1_cli/git/#ejecucion-de-trabajos-en-paralelo","text":"name: Simple workflow # Nombre de la acci\u00f3n/workflow on: [push] # Cuando se ejecuta (el trigger) jobs: example-job-1: # Trabajo 1 runs-on: ubuntu-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 1 was automatically triggered!\" example-job-1: # Trabajo 2 (se ejecuta en paralelo al trabajo 1) runs-on: windows-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 2 was automatically triggered!\"","title":"Ejecucion de trabajos en paralelo"},{"location":"1_cli/git/#ejecucion-condicional","text":"name: Simple workflow # Nombre de la acci\u00f3n/workflow on: [push] # Cuando se ejecuta (el trigger) jobs: example-job-1: # Trabajo 1 runs-on: ubuntu-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 1 was automatically triggered!\" example-job-1: # Trabajo 2 (se ejecuta despues del trabajo 1) needs: example-job-1 runs-on: windows-latest # Maquina virtual donde se ejecuta steps: - run: echo \"The job 2 was automatically triggered!\"","title":"Ejecucion condicional"},{"location":"1_cli/git/#references","text":"Using Github Actions & Pages to Publish Static Pages Based on Dynamic Data (Oct 2, 2021) CI/CD for Machine Learning: Test and Deploy Your ML Model with GitHub Actions (Jun 08, 2022)","title":"References"},{"location":"1_cli/jupyter/","text":"Jupyter Start jupyter when conected with SSH jupyter notebook --no-browser Jupyter extensions sudo pip install jupyter_contrib_nbextensions sudo jupyter contrib nbextension install Jupyter Lab On the Remote Server Get the IP address of your server: $ hostname -I # 192.168.0.120 Configure Jupyter Lab Password $ jupyter notebook --generate-config $ jupyter notebook password Enter password: **** Verify password: **** Starting Jupyter Lab $ jupyter-lab --ip 0.0.0.0 --port 8888 --no-browser On client Navigate to http://<your-routers-public-ip>:8888 Enter password","title":"Jupyter"},{"location":"1_cli/jupyter/#jupyter","text":"","title":"Jupyter"},{"location":"1_cli/jupyter/#start-jupyter-when-conected-with-ssh","text":"jupyter notebook --no-browser","title":"Start jupyter when conected with SSH"},{"location":"1_cli/jupyter/#jupyter-extensions","text":"sudo pip install jupyter_contrib_nbextensions sudo jupyter contrib nbextension install","title":"Jupyter extensions"},{"location":"1_cli/jupyter/#jupyter-lab","text":"","title":"Jupyter Lab"},{"location":"1_cli/jupyter/#on-the-remote-server","text":"Get the IP address of your server: $ hostname -I # 192.168.0.120 Configure Jupyter Lab Password $ jupyter notebook --generate-config $ jupyter notebook password Enter password: **** Verify password: **** Starting Jupyter Lab $ jupyter-lab --ip 0.0.0.0 --port 8888 --no-browser","title":"On the Remote Server"},{"location":"1_cli/jupyter/#on-client","text":"Navigate to http://<your-routers-public-ip>:8888 Enter password","title":"On client"},{"location":"1_cli/makefile/","text":"Makefile Makefile file: TargetFile: DepencyFile1, DepencyFile2 command1 command2 Latex example Makefile paper.pdf: paper.tex plot-data.png pdflatex paper.tex plot-%.png: %.dat plot.py ./plot.py -i $*.dat -o $@ Run it with make If the DepencyFiles has not changed, the commands for TargetFile will not be executed.","title":"Makefile"},{"location":"1_cli/makefile/#makefile","text":"","title":"Makefile"},{"location":"1_cli/makefile/#makefile-file","text":"TargetFile: DepencyFile1, DepencyFile2 command1 command2","title":"Makefile file:"},{"location":"1_cli/makefile/#latex-example-makefile","text":"paper.pdf: paper.tex plot-data.png pdflatex paper.tex plot-%.png: %.dat plot.py ./plot.py -i $*.dat -o $@","title":"Latex example Makefile"},{"location":"1_cli/makefile/#run-it-with-make","text":"If the DepencyFiles has not changed, the commands for TargetFile will not be executed.","title":"Run it with make"},{"location":"1_cli/overthewire/","text":"Over the wire Bandit ssh bandit0@bandit.labs.overthewire.org -p 2220 Level Entry SSH password Answer command bandit0 bandit0 cat readme bandit1 NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL cat ./- bandit2 rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi cat spaces\\ in\\ this\\ filename bandit3 aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG cat inhere/.hidden bandit4 2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe file inhere/* o ls inhere/* | xargs file bandit5 lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR find . -readable ! -executable -size 1033c bandit6 P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU find / -user bandit7 -group bandit6 -size 33c 2> /dev/null bandit7 z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S grep millionth data.txt bandit8 TESKZC0XvTetK0S9xNwm25STk5iWrBvP sort data.txt | uniq -u bandit9 EN632PlfYiZbn3PhVK3XOGSlNInNE00t strings data.txt | grep = bandit10 G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s base64 -d data.txt bandit11 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM cat data.txt | tr a-zA-Z n-za-mN-ZA-M bandit12 JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv cat data.txt | xxd -r | gzip -d - | ..... bandit13 wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw ssh -i sshkey.private bandit14@localhost -p 2220 bandit14 fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq telnet localhost 30000 then enter pass. Or cat /etc/bandit_pass/bandit14 | nc localhost 30000 bandit15 jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt openssl s_client -connect localhost:30001 then enter pass bandit16 JQttfApK4SeyHwDlI9SXGR50qclOAil1 nmap --open -T5 -v -n -p31000-32000 127.0.0.1 openssl s_client -connect localhost:31790 e introducir contenido de /etc/bandit_pass/bandit16 bandit17 VwOSWtCA7lRKkTfbr2IDh6awj9RNZM5e diff passwords.new passwords.old bandit18 hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg ssh bandit18@bandit.labs.overthewire.org -p 2220 cat readme bandit19 awhqfNnAbc1naukrpqDYcF95h7HoMTrC ./bandit20-do cat /etc/bandit_pass/bandit20 bandit20 VxCazJaVykI6W36BkBU0mJTCM8rR95XT window 1: listen on nc -l -p 5757 window 2: ./suconnect 5757 window 1: paste currnt level password on nc bandit21 NvEJF7oVjkddltPSrdKEFOllh9V1IBcq cat cronjob_bandit22 cat /usr/bin/cronjob_bandit22.sh bandit22 WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff echo I am user bandit23 | md5sum bandir23 QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G","title":"Over the wire"},{"location":"1_cli/overthewire/#over-the-wire","text":"","title":"Over the wire"},{"location":"1_cli/overthewire/#bandit","text":"ssh bandit0@bandit.labs.overthewire.org -p 2220 Level Entry SSH password Answer command bandit0 bandit0 cat readme bandit1 NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL cat ./- bandit2 rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi cat spaces\\ in\\ this\\ filename bandit3 aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG cat inhere/.hidden bandit4 2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe file inhere/* o ls inhere/* | xargs file bandit5 lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR find . -readable ! -executable -size 1033c bandit6 P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU find / -user bandit7 -group bandit6 -size 33c 2> /dev/null bandit7 z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S grep millionth data.txt bandit8 TESKZC0XvTetK0S9xNwm25STk5iWrBvP sort data.txt | uniq -u bandit9 EN632PlfYiZbn3PhVK3XOGSlNInNE00t strings data.txt | grep = bandit10 G7w8LIi6J3kTb8A7j9LgrywtEUlyyp6s base64 -d data.txt bandit11 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM cat data.txt | tr a-zA-Z n-za-mN-ZA-M bandit12 JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv cat data.txt | xxd -r | gzip -d - | ..... bandit13 wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw ssh -i sshkey.private bandit14@localhost -p 2220 bandit14 fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq telnet localhost 30000 then enter pass. Or cat /etc/bandit_pass/bandit14 | nc localhost 30000 bandit15 jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt openssl s_client -connect localhost:30001 then enter pass bandit16 JQttfApK4SeyHwDlI9SXGR50qclOAil1 nmap --open -T5 -v -n -p31000-32000 127.0.0.1 openssl s_client -connect localhost:31790 e introducir contenido de /etc/bandit_pass/bandit16 bandit17 VwOSWtCA7lRKkTfbr2IDh6awj9RNZM5e diff passwords.new passwords.old bandit18 hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg ssh bandit18@bandit.labs.overthewire.org -p 2220 cat readme bandit19 awhqfNnAbc1naukrpqDYcF95h7HoMTrC ./bandit20-do cat /etc/bandit_pass/bandit20 bandit20 VxCazJaVykI6W36BkBU0mJTCM8rR95XT window 1: listen on nc -l -p 5757 window 2: ./suconnect 5757 window 1: paste currnt level password on nc bandit21 NvEJF7oVjkddltPSrdKEFOllh9V1IBcq cat cronjob_bandit22 cat /usr/bin/cronjob_bandit22.sh bandit22 WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff echo I am user bandit23 | md5sum bandir23 QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G","title":"Bandit"},{"location":"1_cli/pacman/","text":"Pacman pacman -S {pkg} # Install package pacman -Syu # Update packages. Update database (-y) and upgrade packages (-u) pacman -Ss {pkg} # Search for a new package pacman -Q # Display all installed packages pacman -Qe # Display only packages explicitly installed pacman -Qn # Display only packages installed from main repositories pacman -Qm # Display only packages installed from AUR pacman -Qdt # Display orphaned dependencies pacman -Qs {pkg} # Search local repository for package pacman -R {pkg} # Remove package {pkg} pacman -Rs {pkg} # Remove package as well as unneeded dependencies (-s) pacman -Rns {pkg} # Remove package, dependencies (-s), and system config files (-n) Arch User Repository (AUR) Manually yay (AUR Helper) pamac (AUR Helper) Preparation (install yay) sudo pacman -S --needed base-devel git git clone https://aur.archlinux.org/yay.git cd yay makepkg -si Default in manjaro Install some package (chrome) git clone https://aur.archlinux.org/google-chrome.git cd google-chrome makepkg -si yay -S google-chrome pamac install google-chrome Upgrade some package (chrome) cd google-chrome git pull makepkg -si yay -Syu pamac upgrade -a YAY https://www.chrisatmachine.com/Linux/03-AUR-yay/ PARU git clone https://aur.archlinux.org/paru-bin.git cd paru-bin makepkg -si Create pacman packege Templates: Single package (with specific vesion): /usr/share/pacman/PKGBUILD.proto Single package (with latest vesion, suffix -git ): /usr/share/pacman/PKGBUILD-vcs.proto Multiple package: /usr/share/pacman/PKGBUILD-split.proto Python PIP: pip install --user package Note we\u2019ve installed here using the user flag to install this Python package only for the current user. However, you might prefer to use a tool like pipx to install Python applications in an isolated environment. Conda Conda is SLOOOOOOOW. If you really need to use conda you can use Mamba","title":"Pacman"},{"location":"1_cli/pacman/#pacman","text":"pacman -S {pkg} # Install package pacman -Syu # Update packages. Update database (-y) and upgrade packages (-u) pacman -Ss {pkg} # Search for a new package pacman -Q # Display all installed packages pacman -Qe # Display only packages explicitly installed pacman -Qn # Display only packages installed from main repositories pacman -Qm # Display only packages installed from AUR pacman -Qdt # Display orphaned dependencies pacman -Qs {pkg} # Search local repository for package pacman -R {pkg} # Remove package {pkg} pacman -Rs {pkg} # Remove package as well as unneeded dependencies (-s) pacman -Rns {pkg} # Remove package, dependencies (-s), and system config files (-n)","title":"Pacman"},{"location":"1_cli/pacman/#arch-user-repository-aur","text":"Manually yay (AUR Helper) pamac (AUR Helper) Preparation (install yay) sudo pacman -S --needed base-devel git git clone https://aur.archlinux.org/yay.git cd yay makepkg -si Default in manjaro Install some package (chrome) git clone https://aur.archlinux.org/google-chrome.git cd google-chrome makepkg -si yay -S google-chrome pamac install google-chrome Upgrade some package (chrome) cd google-chrome git pull makepkg -si yay -Syu pamac upgrade -a","title":"Arch User Repository (AUR)"},{"location":"1_cli/pacman/#yay","text":"https://www.chrisatmachine.com/Linux/03-AUR-yay/","title":"YAY"},{"location":"1_cli/pacman/#paru","text":"git clone https://aur.archlinux.org/paru-bin.git cd paru-bin makepkg -si","title":"PARU"},{"location":"1_cli/pacman/#create-pacman-packege","text":"Templates: Single package (with specific vesion): /usr/share/pacman/PKGBUILD.proto Single package (with latest vesion, suffix -git ): /usr/share/pacman/PKGBUILD-vcs.proto Multiple package: /usr/share/pacman/PKGBUILD-split.proto","title":"Create pacman packege"},{"location":"1_cli/pacman/#python","text":"","title":"Python"},{"location":"1_cli/pacman/#pip-pip-install-user-package","text":"Note we\u2019ve installed here using the user flag to install this Python package only for the current user. However, you might prefer to use a tool like pipx to install Python applications in an isolated environment.","title":"PIP: pip install --user package"},{"location":"1_cli/pacman/#conda","text":"Conda is SLOOOOOOOW. If you really need to use conda you can use Mamba","title":"Conda"},{"location":"1_cli/parallel/","text":"GNU Parallel https://www.baeldung.com/linux/processing-commands-in-parallel cat photos.txt | sed 's/,/ /' > photosTAB.txt # Option 1 (sequential with for loop) cat ../photosTAB.txt | while read id url; do wget -O \"$id\" \"$url\"; done # Option 2 (sequential with for loop) wget --input-file=<(tail ../photosTAB.txt | cut -d \",\" -f 2) # Option 3 (parallel with xargs) echo $URL_LIST | xargs -n 1 -P 8 wget -q # Option 4 (parallel with gnu parallel) cat ../photosTAB.txt | parallel --jobs 100 --colsep '\\t' wget -O {1} {2} # this code for i in *gz; do zcat $i > $(basename $i .gz).unpacked done # Can be remplazed with parallel 'zcat {} > {.}.unpacked' ::: *.gz Real world examples ### Download files cat ../photosTAB.txt | parallel --jobs 100 --colsep '\\t' wget -O {1} {2} ### Find files that doenst't exists cut -d, -f5 main.csv | parallel --progress '[ -f {} ] || echo {} >> bad_imgs' ### Check if images are corrupted cut -d, -f5 main.csv | parallel --progress 'identify {} > /dev/null || echo {} >> bad_imgs' {} Input line {.} Input line without extension. {/} Basename of input line {//} Dirname of input line {/.} Basename of input line without extension. {0} 1st culumn of input_line {1} 2nd culumn of input_line","title":"GNU Parallel"},{"location":"1_cli/parallel/#gnu-parallel","text":"https://www.baeldung.com/linux/processing-commands-in-parallel cat photos.txt | sed 's/,/ /' > photosTAB.txt","title":"GNU Parallel"},{"location":"1_cli/parallel/#option-1-sequential-with-for-loop","text":"cat ../photosTAB.txt | while read id url; do wget -O \"$id\" \"$url\"; done","title":"# Option 1 (sequential with for loop)"},{"location":"1_cli/parallel/#option-2-sequential-with-for-loop","text":"wget --input-file=<(tail ../photosTAB.txt | cut -d \",\" -f 2)","title":"# Option 2 (sequential with for loop)"},{"location":"1_cli/parallel/#option-3-parallel-with-xargs","text":"echo $URL_LIST | xargs -n 1 -P 8 wget -q","title":"# Option 3 (parallel with xargs)"},{"location":"1_cli/parallel/#option-4-parallel-with-gnu-parallel","text":"cat ../photosTAB.txt | parallel --jobs 100 --colsep '\\t' wget -O {1} {2} # this code for i in *gz; do zcat $i > $(basename $i .gz).unpacked done # Can be remplazed with parallel 'zcat {} > {.}.unpacked' ::: *.gz","title":"# Option 4 (parallel with gnu parallel)"},{"location":"1_cli/parallel/#real-world-examples","text":"### Download files cat ../photosTAB.txt | parallel --jobs 100 --colsep '\\t' wget -O {1} {2} ### Find files that doenst't exists cut -d, -f5 main.csv | parallel --progress '[ -f {} ] || echo {} >> bad_imgs' ### Check if images are corrupted cut -d, -f5 main.csv | parallel --progress 'identify {} > /dev/null || echo {} >> bad_imgs' {} Input line {.} Input line without extension. {/} Basename of input line {//} Dirname of input line {/.} Basename of input line without extension. {0} 1st culumn of input_line {1} 2nd culumn of input_line","title":"Real world examples"},{"location":"1_cli/plotting/","text":"Plotting gnuplot gnuplot -e \"set terminal jpeg; plot [-5:5] sin(x)\" | display gnuplot -e \"set terminal jpeg; plot [-5:5] sin(x)\" > sin.jpg primes 1 100 | gnuplot -p -e 'plot \"/dev/stdin\"' feedgnuplot https://github.com/dkogan/feedgnuplot/blob/master/guide/guide.org uplot https://github.com/red-data-tools/YouPlot","title":"Plotting"},{"location":"1_cli/plotting/#plotting","text":"","title":"Plotting"},{"location":"1_cli/plotting/#gnuplot","text":"gnuplot -e \"set terminal jpeg; plot [-5:5] sin(x)\" | display gnuplot -e \"set terminal jpeg; plot [-5:5] sin(x)\" > sin.jpg primes 1 100 | gnuplot -p -e 'plot \"/dev/stdin\"'","title":"gnuplot"},{"location":"1_cli/plotting/#feedgnuplot","text":"https://github.com/dkogan/feedgnuplot/blob/master/guide/guide.org","title":"feedgnuplot"},{"location":"1_cli/plotting/#uplot","text":"https://github.com/red-data-tools/YouPlot","title":"uplot"},{"location":"1_cli/process_vs_threads/","text":"Process virtual memory VIRTUAL MEMORY OF A PROCESS 0x00000000 \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557 \u2551 \u2551 \u2551 \u2551 0x08048000 \u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562 \u2551 TEXT \u2551\\ \u2551 (Binary code) \u2551 | \u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562 | Initiali filled \u2551 DATA \u2551 | with content of \u2551 Initialized data \u2551 | my_program.out \u2551 (global and static variables) \u2551/ \u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562 \u2551 BSS \u2551\\ \u2551 Uninitialized data \u2551 | \u2551 (global and static variables) \u2551 | Initiali filled \u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562 | with zeros \u2551 HEAP \u2551 | \u2551 Dynamic memory \u2551 | \u2551 malloc/free in C \u2551 | \u2551 new/delete in C++ \u2551/ \u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562-> brk (program break) \u2551 \u25bc \u2551 \u2551 \u2551 \u2551 ... \u2551 \u2551 \u2551 \u2551 \u25b2 \u2551 \u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562 \u2551 MEMORY MAPPING \u2551\\ \u2551 - Included shared libraries (printf...) \u2551 | For #include libraries \u2551 - Shared file for IPC mmap(SHARED, FILE) \u2551 | Initiali filled \u2551 - Shared mem. for IPC mmap(SHARED, ANON) \u2551 | Initiali filled \u2551 - Read file fast mmap(PRIVATE, FILE) \u2551 | with content of \u2551 - Subthreads stack \u2551 | libc.so, ... \u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562/ \u2551 \u25bc \u2551 \u2551 \u2551 \u2551 ... \u2551 \u2551 \u2551 \u2551 \u25b2 \u2551 \u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\\ \u2551 Main thread STACK \u2551 | Initiali filled \u2551 \u2551 | with zeros 3GB \u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563/ \u2551 KERNEL SPACE \u2551 \u2551 User can not read/write here \u2551 4GB \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d A Process owns: PID: Process Identifier PPID: Parent PID UID: User Identifier (the person who initiated) GID: Group identifier (the person who initiated) TEXT segment (binary code instructions) DATA segment (static and global data) Global variables: int myglobalint = 5; Static variables: static char* mystaticstr = \"hello\"; BSS segment (uninitialized data) static char* my_uninitialized_str HEAP segment (Dynamically-allocated memory) malloc / free in C new / delete in C++ MEMORY MAPPING segment FILE OR ANONYMOUS FILE mappings (code of included libraries, eg printf ) ANONYMOUS mappping SHARED vs PRIVATE MAIN STACK segment Space for the stack of the main thread Page table (maps virtual adresses into physical addrs) Open files descriptors (every open file has an offset) Signal handlers Current working directory Enviroment variables ( $ env A=val ./program ) Command line arguments (see them in /proc/PID/cmdline ) Main Thread --> ALWAYS Sub Threads --> OPTIONAL A Thread owns: Thread ID Stack (called functions, local variables, return addresses) Stack space for a new thread is created by the parent thread with mmap(). So they're in the \"memory map segment\" Saved Registers General purpose registers PC (program counter) SP (stack pointer) Priority (scheduling information) thread-thread switching Thread take less time to create process-process switching Much slower than thread-thread switching Refenrences Jacob Sorber: How processes get more memory. (mmap, brk) Jacob Sorber: How to Map Files into Memory in C Jacob Sorber: Virtual Memory Jacob Sorber: The Heap ByteByteGo: Process vs Thread Chris Kanich: Process vs Thread Chris Kanich: when to use processes, when to use threads Chris Kanich: understanding mmap Julia Evans: Bit size Linux https://stackoverflow.com/questions/44858528/where-are-the-stacks-for-the-other-threads-located-in-a-process-virtual-address https://people.cs.rutgers.edu/~pxk/416/notes/05-threads.html","title":"Process vs threads"},{"location":"1_cli/process_vs_threads/#a-process-owns","text":"PID: Process Identifier PPID: Parent PID UID: User Identifier (the person who initiated) GID: Group identifier (the person who initiated) TEXT segment (binary code instructions) DATA segment (static and global data) Global variables: int myglobalint = 5; Static variables: static char* mystaticstr = \"hello\"; BSS segment (uninitialized data) static char* my_uninitialized_str HEAP segment (Dynamically-allocated memory) malloc / free in C new / delete in C++ MEMORY MAPPING segment FILE OR ANONYMOUS FILE mappings (code of included libraries, eg printf ) ANONYMOUS mappping SHARED vs PRIVATE MAIN STACK segment Space for the stack of the main thread Page table (maps virtual adresses into physical addrs) Open files descriptors (every open file has an offset) Signal handlers Current working directory Enviroment variables ( $ env A=val ./program ) Command line arguments (see them in /proc/PID/cmdline ) Main Thread --> ALWAYS Sub Threads --> OPTIONAL","title":"A Process owns:"},{"location":"1_cli/process_vs_threads/#a-thread-owns","text":"Thread ID Stack (called functions, local variables, return addresses) Stack space for a new thread is created by the parent thread with mmap(). So they're in the \"memory map segment\" Saved Registers General purpose registers PC (program counter) SP (stack pointer) Priority (scheduling information)","title":"A Thread owns:"},{"location":"1_cli/process_vs_threads/#thread-thread-switching","text":"Thread take less time to create","title":"thread-thread switching"},{"location":"1_cli/process_vs_threads/#process-process-switching","text":"Much slower than thread-thread switching","title":"process-process switching"},{"location":"1_cli/process_vs_threads/#refenrences","text":"Jacob Sorber: How processes get more memory. (mmap, brk) Jacob Sorber: How to Map Files into Memory in C Jacob Sorber: Virtual Memory Jacob Sorber: The Heap ByteByteGo: Process vs Thread Chris Kanich: Process vs Thread Chris Kanich: when to use processes, when to use threads Chris Kanich: understanding mmap Julia Evans: Bit size Linux https://stackoverflow.com/questions/44858528/where-are-the-stacks-for-the-other-threads-located-in-a-process-virtual-address https://people.cs.rutgers.edu/~pxk/416/notes/05-threads.html","title":"Refenrences"},{"location":"1_cli/ssh/","text":"SSH En el servidor: sudo systemctl status sshd # Ver si esta encendido sudo systemctl start sshd # Encender sudo systemctl restart sshd # Reiniciar sudo systemctl stop sshd # Apagar sudo systemctl enable sshd # Al arrancar por defecto: encendido sudo systemctl disable sshd # Al arrancar por defecto: apagado Common flags ssh javi@192.168.0.1 -L 8888:localhost:8888 : Redirect port ssh javi@192.168.0.1 -p 2222 : Conct over a specific port (Defualt port is 22) En el cliente. Conectar y redirigir puerto 8888 (juypter) ssh javi@192.168.0.103 -L 8888:localhost:8888 # Conectar jupyter notebook --no-browser # Abrir Jupyter exit # Desconectar o CTL+ Key generation # Gerenar claves publica y privada ssh-keygen -o -a 100 -t ed25519 -f ~/.ssh/id_ed25519 # Llevar la clave publica al cliente cat .ssh/id_ed25519.pub | ssh foobar@remote 'cat >> ~/.ssh/authorized_keys' -o : Save the private-key using the new OpenSSH format rather than the PEM format. Actually, this option is implied when you specify the key type as ed25519. -a : It\u2019s the numbers of KDF (Key Derivation Function) rounds. Higher numbers result in slower passphrase verification, increasing the resistance to brute-force password cracking should the private-key be stolen. -t : Specifies the type of key to create, in our case the Ed25519. -f : Specify the filename of the generated key file. If you want it to be discovered automatically by the SSH agent, it must be stored in the default .ssh directory within your home directory. Dejar un programa largo en ejecucion Simple option ( nohup ) nohup COMMAND # Run a command immune to hangups nohup COMMAND > FILE # Ademas puede guardar su salida estandar en un fichero Session programs option ( screen or tmux ) Son programas que mantienen la sesion activa. ssh log in into your remote machine. tmux or screen Start the long process you want. Leave/detach tmux or screen session, but leave your processes running. Ctrl+A then Ctrl+D (para salir de screen) Ctrl+B then Ctrl+D (para salir de tmux) exit ssh ...One eternity later... ssh log in again into your remote machine. Return back to see the output of your process. screen -r : \"resume\" your screen session tmux a : \"atach\" to the last tmux session","title":"SSH"},{"location":"1_cli/ssh/#ssh","text":"","title":"SSH"},{"location":"1_cli/ssh/#en-el-servidor","text":"sudo systemctl status sshd # Ver si esta encendido sudo systemctl start sshd # Encender sudo systemctl restart sshd # Reiniciar sudo systemctl stop sshd # Apagar sudo systemctl enable sshd # Al arrancar por defecto: encendido sudo systemctl disable sshd # Al arrancar por defecto: apagado","title":"En el servidor:"},{"location":"1_cli/ssh/#common-flags","text":"ssh javi@192.168.0.1 -L 8888:localhost:8888 : Redirect port ssh javi@192.168.0.1 -p 2222 : Conct over a specific port (Defualt port is 22)","title":"Common flags"},{"location":"1_cli/ssh/#en-el-cliente-conectar-y-redirigir-puerto-8888-juypter","text":"ssh javi@192.168.0.103 -L 8888:localhost:8888 # Conectar jupyter notebook --no-browser # Abrir Jupyter exit # Desconectar o CTL+","title":"En el cliente. Conectar y redirigir puerto 8888 (juypter)"},{"location":"1_cli/ssh/#key-generation","text":"# Gerenar claves publica y privada ssh-keygen -o -a 100 -t ed25519 -f ~/.ssh/id_ed25519 # Llevar la clave publica al cliente cat .ssh/id_ed25519.pub | ssh foobar@remote 'cat >> ~/.ssh/authorized_keys' -o : Save the private-key using the new OpenSSH format rather than the PEM format. Actually, this option is implied when you specify the key type as ed25519. -a : It\u2019s the numbers of KDF (Key Derivation Function) rounds. Higher numbers result in slower passphrase verification, increasing the resistance to brute-force password cracking should the private-key be stolen. -t : Specifies the type of key to create, in our case the Ed25519. -f : Specify the filename of the generated key file. If you want it to be discovered automatically by the SSH agent, it must be stored in the default .ssh directory within your home directory.","title":"Key generation"},{"location":"1_cli/ssh/#dejar-un-programa-largo-en-ejecucion","text":"","title":"Dejar un programa largo en ejecucion"},{"location":"1_cli/ssh/#simple-option-nohup","text":"nohup COMMAND # Run a command immune to hangups nohup COMMAND > FILE # Ademas puede guardar su salida estandar en un fichero","title":"Simple option (nohup)"},{"location":"1_cli/ssh/#session-programs-option-screen-or-tmux","text":"Son programas que mantienen la sesion activa. ssh log in into your remote machine. tmux or screen Start the long process you want. Leave/detach tmux or screen session, but leave your processes running. Ctrl+A then Ctrl+D (para salir de screen) Ctrl+B then Ctrl+D (para salir de tmux) exit ssh ...One eternity later... ssh log in again into your remote machine. Return back to see the output of your process. screen -r : \"resume\" your screen session tmux a : \"atach\" to the last tmux session","title":"Session programs option (screen or tmux)"},{"location":"1_cli/tmux/","text":"TMUX The most popular terminal multiplexer these days is tmux . - tmux can have several sessions . - a session can have several windows (like tabs) - a window can have several panes (like a divided terminal) Commands Outside tmux tmux : starts a new session. tmux new -s NAME : starts it with that name. tmux ls : lists the current sessions. tmux a : attaches the last session. tmux -t sesName : attaches to specific session. tmux kill-server : Removes all sessions and kill tmux server Inside tmux : [Ctrl+b] c : Creates a new window. To close it you can just terminate the shells doing <C-d> [Ctrl+b] , : Rename the current window [Ctrl+b] 0 : Go to window 0 [Ctrl+b] 1 : Go to window 1 [Ctrl+b] 2 : Go to window 2 [Ctrl+d] x : Kill the current pane/window(if1pane)/sesion(if1window) [Ctrl+b] d : Detaches the current session (remains active in background) Less common [Ctrl+b] w : List current windows [Ctrl+b] p : Go to the previous window [Ctrl+b] n : Go to the next window Panes : Like vim splits, panes let you have multiple shells in the same visual display. [Ctrl+b] \" Split the current pane horizontally [Ctrl+b] % Split the current pane vertically [Ctrl+b] <direction> Move to the pane in the specified direction . Direction here means arrow keys. [Ctrl+b] z Toggle zoom for the current pane [Ctrl+b] [ Start scrollback. You can then press <space> to start a selection and <enter> to copy that selection. [Ctrl+b] <space> Cycle through pane arrangements. iTerm2 TMUX Integration Each TMUX window will be a real window . tmux -CC : Create a new session tmux -CC attach Attach to Reference: https://stackoverflow.com/questions/35421819/tmux-in-multiple-terminal-app-windows TMUX Server ( Autostart with systemd ) Put this file in /etc/systemd/system/tmux.service : cd /etc/systemd/system sudo nano tmux.service [Unit] Description=Tmux server [Service] Type=forking User=javi ExecStart=/usr/bin/tmux new -s 0 -d ExecStop=/usr/bin/tmux kill-server [Install] WantedBy=multi-user.target Enable service with: sudo systemctl enable tmux.service Learn more Video de s4vitar: Aprendiendo a usar tmux desde 0 Practical Tmux https://hackernoon.com/using-tmux-to-improve-your-terminal-experience-jt4932zv","title":"TMUX"},{"location":"1_cli/tmux/#tmux","text":"The most popular terminal multiplexer these days is tmux . - tmux can have several sessions . - a session can have several windows (like tabs) - a window can have several panes (like a divided terminal)","title":"TMUX"},{"location":"1_cli/tmux/#commands","text":"Outside tmux tmux : starts a new session. tmux new -s NAME : starts it with that name. tmux ls : lists the current sessions. tmux a : attaches the last session. tmux -t sesName : attaches to specific session. tmux kill-server : Removes all sessions and kill tmux server Inside tmux : [Ctrl+b] c : Creates a new window. To close it you can just terminate the shells doing <C-d> [Ctrl+b] , : Rename the current window [Ctrl+b] 0 : Go to window 0 [Ctrl+b] 1 : Go to window 1 [Ctrl+b] 2 : Go to window 2 [Ctrl+d] x : Kill the current pane/window(if1pane)/sesion(if1window) [Ctrl+b] d : Detaches the current session (remains active in background) Less common [Ctrl+b] w : List current windows [Ctrl+b] p : Go to the previous window [Ctrl+b] n : Go to the next window Panes : Like vim splits, panes let you have multiple shells in the same visual display. [Ctrl+b] \" Split the current pane horizontally [Ctrl+b] % Split the current pane vertically [Ctrl+b] <direction> Move to the pane in the specified direction . Direction here means arrow keys. [Ctrl+b] z Toggle zoom for the current pane [Ctrl+b] [ Start scrollback. You can then press <space> to start a selection and <enter> to copy that selection. [Ctrl+b] <space> Cycle through pane arrangements.","title":"Commands"},{"location":"1_cli/tmux/#iterm2-tmux-integration","text":"Each TMUX window will be a real window . tmux -CC : Create a new session tmux -CC attach Attach to Reference: https://stackoverflow.com/questions/35421819/tmux-in-multiple-terminal-app-windows","title":"iTerm2 TMUX Integration"},{"location":"1_cli/tmux/#tmux-server-autostart-with-systemd","text":"Put this file in /etc/systemd/system/tmux.service : cd /etc/systemd/system sudo nano tmux.service [Unit] Description=Tmux server [Service] Type=forking User=javi ExecStart=/usr/bin/tmux new -s 0 -d ExecStop=/usr/bin/tmux kill-server [Install] WantedBy=multi-user.target Enable service with: sudo systemctl enable tmux.service","title":"TMUX Server (Autostart with systemd)"},{"location":"1_cli/tmux/#learn-more","text":"Video de s4vitar: Aprendiendo a usar tmux desde 0 Practical Tmux https://hackernoon.com/using-tmux-to-improve-your-terminal-experience-jt4932zv","title":"Learn more"},{"location":"1_cli/vim/","text":"Vim Modes ESC : Normal mode. For moving around a file; reading; going to file to file i : Insert mode. For inserting text : : Command-line mode. For running a command r : Replace mode. For replacing text v : Visual mode. For selecting blocks of text SHIFT + v : Visual line mode Ctrl + v : Visual block mode Command-line Command mode can be entered by typing : in Normal mode. Your cursor will jump to the command line at the bottom of the screen upon pressing : . This mode has many functionalities, including opening, saving, and closing files, and quitting Vim . :q quit (close window) :w save (\"write\") :wq save and quit :e {name of file} open file for editing :ls show open buffers :help {topic} open help :help :w opens help for the :w command :help w opens help for the w movement NeoVIM NvimTreeToogle: left tree panel nvchad","title":"Vim"},{"location":"1_cli/vim/#vim","text":"","title":"Vim"},{"location":"1_cli/vim/#modes","text":"ESC : Normal mode. For moving around a file; reading; going to file to file i : Insert mode. For inserting text : : Command-line mode. For running a command r : Replace mode. For replacing text v : Visual mode. For selecting blocks of text SHIFT + v : Visual line mode Ctrl + v : Visual block mode","title":"Modes"},{"location":"1_cli/vim/#command-line","text":"Command mode can be entered by typing : in Normal mode. Your cursor will jump to the command line at the bottom of the screen upon pressing : . This mode has many functionalities, including opening, saving, and closing files, and quitting Vim . :q quit (close window) :w save (\"write\") :wq save and quit :e {name of file} open file for editing :ls show open buffers :help {topic} open help :help :w opens help for the :w command :help w opens help for the w movement","title":"Command-line"},{"location":"1_cli/vim/#neovim","text":"NvimTreeToogle: left tree panel nvchad","title":"NeoVIM"},{"location":"1_cli/tools_data/csv/","text":"Text data sort Sorting Soring options [bdfgiMhnRrV]: sort -r : Reverse order sort -n : Numerically sort -rn : Numerically reversed sort -R : Randomly (each time is different). Similar to shuf Sorting by fields: sort -t ',' -k 2 file.csv : Sort a CSV file by 2nd column (until the end of line). sort -t ',' -k 2,2 file.csv : Sort a CSV file by 2nd column. sort -t ',' -k 2n,2 file.csv : Sort NUMERICALLY a CSV file by 2nd column. sort -t, -k 3n,3 -k 1n,1 file.csv : Sort NUMERICALLY a CSV file by 3rd column, then by 1st column uniq See uniq ues. need to sort first . sort | uniq : Display uniques sort | uniq -c : Count uniques sort | uniq -d : Display duplicates sort | uniq -u : Show non repeated lines wc Count lines, words and chars wc -l : count only lines wc -w : count only words wc -c : count only chars/bytes (useful for getting size of stdin) column Display in column s | column -t : Pretty print TSV file column iris.csv -t -s , column file.csv -s \",\" -t | less -#2 -N -S : CSV viewer cut Selecting fields (columns) (default is to delimit by tab). cut -d',' -f1 : Delimiter=\",\" Field (col)=1st cut -d, -f 2 : Delimit by coma (CSV). Select 2nd field. cut -d, -f 2,3 : Delimit by coma (CSV). Select 2nd and 3rd fields. cut -d, -f-4,6- : Delimit by coma (CSV). Select all except 5th field. cut -c 5- : skip the first 4 characters of each line (start on the 5th char). paste Join 2 (or more) files line by line pase file_a file_b pase <(cut -d, -f1,2,3 some.csv) other_file join Join 2 files line by its sorted id column. If the the column separator is not specified, it will be the space by default If the id column position is not specified, it will be the 1st column by default. join file1 file2 Join two files on the first (default) field. join -t, file1 file2 Join two files using a comma (instead of a space) as the field separator. join -t, <(sort -t, -k 1,1 file1.csv) <(sort file2_ids.txt) : Sort ids of input files to work ok. join -1 3 -2 1 file1 file2 Join field3 of file1 with field1 of file2. join -a 1 file1 file2 Produce a line for each unpairable line for file1. cat path/to/file1 | join - path/to/file2 Join a file from stdin . split Split a file into pieces (less useful) nl Prepend line numbers tr Translate (replace) patterns. - tr '\\t' , Replace tabs with commas (TSV to CSV) - tr '[:upper:]' '[:lower:]' tr anslate from upper to lower characters - tr -d \" \" D elete some pattern - tr -s \" \" S queeze multiple occurrences (convert a consecutive repeated character into a single one) grep Print lines matching a pattern egrep San handle extended regular expressions (EREs) sed S tream ed itor for filtering, transforming and replace text (and much more). Useful for search and replace. Convinient for free-form text data. sed '' file View content of file sed 's/old_word/new_word/' file Substituting Text sed 's/old_word/new_word/i' file Substituting Text (case insensitive) awk Pattern scanning and text processing language Convinient for tabular data (table with columns) Default input field separator is the blank/space: Default output field separator is the blank/space: Default record separator is the new_line: \\n Syntax: awk FLAG_OPTIONS 'PATTERN {ACTION} PATTERN {ACTION} PATTERN {ACTION}' INPUT_FILE(S) AWK FLAG OPTIONS awk -F \"|\" '........' : Set | as the input field separator AWK VARIABLES $1 : Field 1 $2 : Field 2 $3 : Field 3 $0 : The entire line NR : Number of the current record/line AWK PATTERNS Keywords awk 'BEGIN {...}' : Do this before iterating the file Logical operators: awk '$3 > 1000 || $4 < 300 {...}' awk 'NR<3 {...}' awk toupper($3 == \"TEXAS\")' awk toupper($3 != \"TEXAS\")' Regular expresions: awk '/D6.jpg/ {...}' awk '! /D6.jpg/ {...}' awk '$4 ~ /D6.jpg/ {...}' : Field match a regex awk '$4 !~ /D6.jpg/ {...}' : Field do not match a regex awk '/(TEXAS|Texas).*[Oo]il.*extraction/ {...}' : Complex regex Regular expresions with logical operators: awk '( /TEXAS/ || /Texas/ ) && /*[Oo]il.*extraction/ {...}' AWK ACTIONS awk '{print $0}' : Print the entire line. awk '{print $1}' : Print fisrt column. awk '{print \"First column \" $1 \" second column \" $2}' awk 'BEGIN {FS=\"\\t\";OFS=\"\\t\"} ... : Set the tab as the input and output separators awk 'BEGIN {FS=OFS=\"\\t\"} ... : Same of above AWK REFERENCE https://stackoverflow.com/tags/awk/info https://ferd.ca/awk-in-20-minutes.html https://www.youtube.com/watch?v=WaNIi0ZJMu0 Q SQL over CSVs","title":"Text data"},{"location":"1_cli/tools_data/csv/#text-data","text":"","title":"Text data"},{"location":"1_cli/tools_data/csv/#sortsorting","text":"","title":"sortSorting"},{"location":"1_cli/tools_data/csv/#soring-options-bdfgimhnrrv","text":"sort -r : Reverse order sort -n : Numerically sort -rn : Numerically reversed sort -R : Randomly (each time is different). Similar to shuf","title":"Soring options [bdfgiMhnRrV]:"},{"location":"1_cli/tools_data/csv/#sorting-by-fields","text":"sort -t ',' -k 2 file.csv : Sort a CSV file by 2nd column (until the end of line). sort -t ',' -k 2,2 file.csv : Sort a CSV file by 2nd column. sort -t ',' -k 2n,2 file.csv : Sort NUMERICALLY a CSV file by 2nd column. sort -t, -k 3n,3 -k 1n,1 file.csv : Sort NUMERICALLY a CSV file by 3rd column, then by 1st column","title":"Sorting by fields:"},{"location":"1_cli/tools_data/csv/#uniq","text":"See uniq ues. need to sort first . sort | uniq : Display uniques sort | uniq -c : Count uniques sort | uniq -d : Display duplicates sort | uniq -u : Show non repeated lines","title":"uniq"},{"location":"1_cli/tools_data/csv/#wc","text":"Count lines, words and chars wc -l : count only lines wc -w : count only words wc -c : count only chars/bytes (useful for getting size of stdin)","title":"wc"},{"location":"1_cli/tools_data/csv/#column","text":"Display in column s | column -t : Pretty print TSV file column iris.csv -t -s , column file.csv -s \",\" -t | less -#2 -N -S : CSV viewer","title":"column"},{"location":"1_cli/tools_data/csv/#cut","text":"Selecting fields (columns) (default is to delimit by tab). cut -d',' -f1 : Delimiter=\",\" Field (col)=1st cut -d, -f 2 : Delimit by coma (CSV). Select 2nd field. cut -d, -f 2,3 : Delimit by coma (CSV). Select 2nd and 3rd fields. cut -d, -f-4,6- : Delimit by coma (CSV). Select all except 5th field. cut -c 5- : skip the first 4 characters of each line (start on the 5th char).","title":"cut"},{"location":"1_cli/tools_data/csv/#paste","text":"Join 2 (or more) files line by line pase file_a file_b pase <(cut -d, -f1,2,3 some.csv) other_file","title":"paste"},{"location":"1_cli/tools_data/csv/#join","text":"Join 2 files line by its sorted id column. If the the column separator is not specified, it will be the space by default If the id column position is not specified, it will be the 1st column by default. join file1 file2 Join two files on the first (default) field. join -t, file1 file2 Join two files using a comma (instead of a space) as the field separator. join -t, <(sort -t, -k 1,1 file1.csv) <(sort file2_ids.txt) : Sort ids of input files to work ok. join -1 3 -2 1 file1 file2 Join field3 of file1 with field1 of file2. join -a 1 file1 file2 Produce a line for each unpairable line for file1. cat path/to/file1 | join - path/to/file2 Join a file from stdin .","title":"join"},{"location":"1_cli/tools_data/csv/#split","text":"Split a file into pieces (less useful)","title":"split"},{"location":"1_cli/tools_data/csv/#nl","text":"Prepend line numbers","title":"nl"},{"location":"1_cli/tools_data/csv/#tr","text":"Translate (replace) patterns. - tr '\\t' , Replace tabs with commas (TSV to CSV) - tr '[:upper:]' '[:lower:]' tr anslate from upper to lower characters - tr -d \" \" D elete some pattern - tr -s \" \" S queeze multiple occurrences (convert a consecutive repeated character into a single one)","title":"tr"},{"location":"1_cli/tools_data/csv/#grep","text":"Print lines matching a pattern","title":"grep"},{"location":"1_cli/tools_data/csv/#egrep","text":"San handle extended regular expressions (EREs)","title":"egrep"},{"location":"1_cli/tools_data/csv/#sed","text":"S tream ed itor for filtering, transforming and replace text (and much more). Useful for search and replace. Convinient for free-form text data. sed '' file View content of file sed 's/old_word/new_word/' file Substituting Text sed 's/old_word/new_word/i' file Substituting Text (case insensitive)","title":"sed"},{"location":"1_cli/tools_data/csv/#awk","text":"Pattern scanning and text processing language Convinient for tabular data (table with columns) Default input field separator is the blank/space: Default output field separator is the blank/space: Default record separator is the new_line: \\n Syntax: awk FLAG_OPTIONS 'PATTERN {ACTION} PATTERN {ACTION} PATTERN {ACTION}' INPUT_FILE(S)","title":"awk"},{"location":"1_cli/tools_data/csv/#awk-flag-options","text":"awk -F \"|\" '........' : Set | as the input field separator","title":"AWK FLAG OPTIONS"},{"location":"1_cli/tools_data/csv/#awk-variables","text":"$1 : Field 1 $2 : Field 2 $3 : Field 3 $0 : The entire line NR : Number of the current record/line","title":"AWK VARIABLES"},{"location":"1_cli/tools_data/csv/#awk-patterns","text":"Keywords awk 'BEGIN {...}' : Do this before iterating the file Logical operators: awk '$3 > 1000 || $4 < 300 {...}' awk 'NR<3 {...}' awk toupper($3 == \"TEXAS\")' awk toupper($3 != \"TEXAS\")' Regular expresions: awk '/D6.jpg/ {...}' awk '! /D6.jpg/ {...}' awk '$4 ~ /D6.jpg/ {...}' : Field match a regex awk '$4 !~ /D6.jpg/ {...}' : Field do not match a regex awk '/(TEXAS|Texas).*[Oo]il.*extraction/ {...}' : Complex regex Regular expresions with logical operators: awk '( /TEXAS/ || /Texas/ ) && /*[Oo]il.*extraction/ {...}'","title":"AWK PATTERNS"},{"location":"1_cli/tools_data/csv/#awk-actions","text":"awk '{print $0}' : Print the entire line. awk '{print $1}' : Print fisrt column. awk '{print \"First column \" $1 \" second column \" $2}' awk 'BEGIN {FS=\"\\t\";OFS=\"\\t\"} ... : Set the tab as the input and output separators awk 'BEGIN {FS=OFS=\"\\t\"} ... : Same of above","title":"AWK ACTIONS"},{"location":"1_cli/tools_data/csv/#awk-reference","text":"https://stackoverflow.com/tags/awk/info https://ferd.ca/awk-in-20-minutes.html https://www.youtube.com/watch?v=WaNIi0ZJMu0","title":"AWK REFERENCE"},{"location":"1_cli/tools_data/csv/#q","text":"SQL over CSVs","title":"Q"},{"location":"1_cli/tools_data/free_text/","text":"Regular Expressions Basic REs grep sed Extended REs grep -E , egrep sed -E , awk Pearl/Python REs grep -P Python's re CHARACTERS Any char (except newline) . . . a,b,c characters [abc] [abc] [abc] Any chars except a,b,c [^abc] [^abc] [^abc] Any digit [0-9] [0-9] [0-9] \\d Any chars except digits [^0-9] [^0-9] [^0-9] \\D Any letter [a-zA-Z] [a-zA-Z] [a-zA-Z] Any letter even with \u00b4\u00a8~ [a-zA-Z\u00e0-\u00fcA-Z\u00c0-\u00dc] [a-zA-Z\u00e0-\u00fcA-Z\u00c0-\u00dc] [a-zA-Z\u00e0-\u00fcA-Z\u00c0-\u00dc] Any letter, digit or \"_\" \\w \\w \\w Not letter, digit or \"_\" \\W Whitespace char \\s \\s Whitespace char & newline \\s QUANTIFIERS 0 or More * * * 1 or More \\+ + + 0 or 1 \\? ? ? Exact Number \\{3\\} {3} {3} Range min max \\{3,4\\} {3,4} {3,4} 2 or More \\{2,}\\ {2,} {2,} 3 or Less \\{,3}\\ {,3} {,3} LIMITS Beginning of line ^ ^ ^ End of line $ $ $ Word boundary \\b \\b \\b Not word boundary \\B \\B \\B ALTERNATION a or b \\(a|b\\) (a|b) (a|b) a or b [ab] [ab] [ab] GROUPING Capturing a group \\(...\\) (...) (...) Backreference a group \\1 \\1 \\1 LOOK-AROUND Positive look-behind (?<=prefijo)mi_patron Negative look-behind (?<!prefijo)mi_patron Positive look-ahead mi_patron(?=sufijo) Positive look-ahead mi_patron(?!sufijo) Pseudo look-around in sed # Remove something behind sed 's/pattern2remove\\(pattern2keep\\)/\\1/g' file.txt sed -E 's/pattern2remove(pattern2keep)/\\1/g' file.txt # Remove something ahead sed 's/\\(pattern2keep\\)pattern2remove/\\1/g' file.txt sed -E 's/(pattern2keep)pattern2remove/\\1/g' file.txt Flags /.../g : Global. Several matches per line can occur /.../i : Case insensitive Examples .+ Selececcionar cada linea \\b[A-Z]+\\b palabras solo en mayyscula (cada palabra es un match) ([A-Z]+[ \\t]+)+ frases solo en mayyscula (cada frase es un match) \\.(png|jpg|gif)$ DOS to UNIX file Remove carriage return (\\r\\r\\n) sed 's/\\r//' in.txt > out.txt --> Bad (only first \\r of line is removed) sed 's/\\r$//' in.txt > out.txt --> Bad (only last \\r of line is removed) sed 's/\\r//g' in.txt > out.txt --> Good: Remove all the \\r Remove the BOM sed '1s/^\\xEF\\xBB\\xBF//' in.txt > out.txt Conclusion cat input_file | sed '1s/^\\xEF\\xBB\\xBF//' | sed 's/\\r//g' > output_file Pseudo-regex in terminal * : Matches zero or more. {a,b,c} : Brace Expansion . Examples: ls some_dir/{subdir_A,subdir_B} mkdir {old,new,dist,bugs} Pattern Matching ?(pattern-list) : Matches zero or one occurrence of the given patterns. *(pattern-list) : Matches zero or more occurrences of the given patterns. +(pattern-list) : Matches one or more occurrences of the given patterns. @(pattern-list) : Matches one of the given patterns. !(pattern-list) : Matches anything except one of the given patterns. ASCII 0-31 32-63 64-95 96-127 128-159 160-191 192-223 224.255 0 \\0 32 64 @ 96 128 \u0080 160 192 \u00c0 224 \u00e0 1 SOH 33 ! 65 A 97 a 129 \u0081 161 \u00a1 193 \u00c1 225 \u00e1 2 STX 34 \" 66 B 98 b 130 \u0082 162 \u00a2 194 \u00c2 226 \u00e2 3 ETX 35 # 67 C 99 c 131 \u0083 163 \u00a3 195 \u00c3 227 \u00e3 4 EOT 36 $ 68 D 100 d 132 \u0084 164 \u00a4 196 \u00c4 228 \u00e4 5 ENQ 37 % 69 E 101 e 133 165 \u00a5 197 \u00c5 229 \u00e5 6 ACK 38 & 70 F 102 f 134 \u0086 166 \u00a6 198 \u00c6 230 \u00e6 7 BEL 39 ' 71 G 103 g 135 \u0087 167 \u00a7 199 \u00c7 231 \u00e7 8 BS 40 ( 72 H 104 h 136 \u0088 168 \u00a8 200 \u00c8 232 \u00e8 9 \\t 41 ) 73 I 105 i 137 \u0089 169 \u00a9 201 \u00c9 233 \u00e9 10 \\n 42 * 74 J 106 j 138 \u008a 170 \u00aa 202 \u00ca 234 \u00ea 11 \\v 43 + 75 K 107 k 139 \u008b 171 \u00ab 203 \u00cb 235 \u00eb 12 FF 44 , 76 L 108 l 140 \u008c 172 \u00ac 204 \u00cc 236 \u00ec 13 \\r 45 - 77 M 109 m 141 \u008d 173 \u00a1 205 \u00cd 237 \u00ed 14 SO 46 . 78 N 110 n 142 \u008e 174 \u00ae 206 \u00ce 238 \u00ee 15 SI 47 / 79 O 111 o 143 \u008f 175 \u00af 207 \u00cf 239 \u00ef 16 DLE 48 0 80 P 112 p 144 \u0090 176 \u00b0 208 \u00d0 240 \u00f0 17 DC1 49 1 81 Q 113 q 145 \u0091 177 \u00b1 209 \u00d1 241 \u00f1 18 DC2 50 2 82 R 114 r 146 \u0092 178 \u00b2 210 \u00d2 242 \u00f2 19 DC3 51 3 83 S 115 s 147 \u0093 179 \u00b3 211 \u00d3 243 \u00f3 20 DC4 52 4 84 T 116 t 148 \u0094 180 \u00b4 212 \u00d4 244 \u00f4 21 NAK 53 5 85 U 117 u 149 \u0095 181 \u00b5 213 \u00d5 245 \u00f5 22 SYN 54 6 86 V 118 v 150 \u0096 182 \u00b6 214 \u00d6 246 \u00f6 23 ETB 55 7 87 W 119 w 151 \u0097 183 \u00b7 215 \u00d7 247 \u00f7 24 CAN 56 8 88 X 120 x 152 \u0098 184 \u00b8 216 \u00d8 248 \u00f8 25 EM 57 9 89 Y 121 y 153 \u0099 185 \u00b9 217 \u00d9 249 \u00f9 26 SUB 58 : 90 Z 122 z 154 \u009a 186 \u00ba 218 \u00da 250 \u00fa 27 ESC 59 ; 91 [ 123 { 155 \u009b 187 \u00bb 219 \u00db 251 \u00fb 28 FS 60 < 92 \\ 124 \\| 156 \u009c 188 \u00bc 220 \u00dc 252 \u00fc 29 GS 61 = 93 ] 125 } 157 \u009d 189 \u00bd 221 \u00dd 253 \u00fd 30 RS 62 > 94 ^ 126 ~ 158 \u009e 190 \u00be 222 \u00de 254 \u00fe 31 US 63 ? 95 _ 127 DEL 159 \u009f 191 \u00bf 223 \u00df 255 \u00ff Reference https://regexr.com/ https://regex101.com/ man re_format Char ranges https://www.youtube.com/playlist?list=PLp31D6HATKfdc5PSJTx7rIvlTLCSM5nDi https://www.youtube.com/watch?v=w61mxJcUV-o https://remram44.github.io/regex-cheatsheet/regex.html https://linuxize.com/post/regular-expressions-in-grep http://mywiki.wooledge.org/RegularExpression grep : print lines matching a pattern egrep : can handle extended regular expressions (EREs)","title":"Regular Expressions"},{"location":"1_cli/tools_data/free_text/#regular-expressions","text":"Basic REs grep sed Extended REs grep -E , egrep sed -E , awk Pearl/Python REs grep -P Python's re CHARACTERS Any char (except newline) . . . a,b,c characters [abc] [abc] [abc] Any chars except a,b,c [^abc] [^abc] [^abc] Any digit [0-9] [0-9] [0-9] \\d Any chars except digits [^0-9] [^0-9] [^0-9] \\D Any letter [a-zA-Z] [a-zA-Z] [a-zA-Z] Any letter even with \u00b4\u00a8~ [a-zA-Z\u00e0-\u00fcA-Z\u00c0-\u00dc] [a-zA-Z\u00e0-\u00fcA-Z\u00c0-\u00dc] [a-zA-Z\u00e0-\u00fcA-Z\u00c0-\u00dc] Any letter, digit or \"_\" \\w \\w \\w Not letter, digit or \"_\" \\W Whitespace char \\s \\s Whitespace char & newline \\s QUANTIFIERS 0 or More * * * 1 or More \\+ + + 0 or 1 \\? ? ? Exact Number \\{3\\} {3} {3} Range min max \\{3,4\\} {3,4} {3,4} 2 or More \\{2,}\\ {2,} {2,} 3 or Less \\{,3}\\ {,3} {,3} LIMITS Beginning of line ^ ^ ^ End of line $ $ $ Word boundary \\b \\b \\b Not word boundary \\B \\B \\B ALTERNATION a or b \\(a|b\\) (a|b) (a|b) a or b [ab] [ab] [ab] GROUPING Capturing a group \\(...\\) (...) (...) Backreference a group \\1 \\1 \\1 LOOK-AROUND Positive look-behind (?<=prefijo)mi_patron Negative look-behind (?<!prefijo)mi_patron Positive look-ahead mi_patron(?=sufijo) Positive look-ahead mi_patron(?!sufijo)","title":"Regular Expressions"},{"location":"1_cli/tools_data/free_text/#pseudo-look-around-in-sed","text":"# Remove something behind sed 's/pattern2remove\\(pattern2keep\\)/\\1/g' file.txt sed -E 's/pattern2remove(pattern2keep)/\\1/g' file.txt # Remove something ahead sed 's/\\(pattern2keep\\)pattern2remove/\\1/g' file.txt sed -E 's/(pattern2keep)pattern2remove/\\1/g' file.txt","title":"Pseudo look-around in sed"},{"location":"1_cli/tools_data/free_text/#flags","text":"/.../g : Global. Several matches per line can occur /.../i : Case insensitive","title":"Flags"},{"location":"1_cli/tools_data/free_text/#examples","text":".+ Selececcionar cada linea \\b[A-Z]+\\b palabras solo en mayyscula (cada palabra es un match) ([A-Z]+[ \\t]+)+ frases solo en mayyscula (cada frase es un match) \\.(png|jpg|gif)$","title":"Examples"},{"location":"1_cli/tools_data/free_text/#dos-to-unix-file","text":"","title":"DOS to UNIX file"},{"location":"1_cli/tools_data/free_text/#remove-carriage-return-rrn","text":"sed 's/\\r//' in.txt > out.txt --> Bad (only first \\r of line is removed) sed 's/\\r$//' in.txt > out.txt --> Bad (only last \\r of line is removed) sed 's/\\r//g' in.txt > out.txt --> Good: Remove all the \\r","title":"Remove carriage return (\\r\\r\\n)"},{"location":"1_cli/tools_data/free_text/#remove-the-bom","text":"sed '1s/^\\xEF\\xBB\\xBF//' in.txt > out.txt","title":"Remove the BOM"},{"location":"1_cli/tools_data/free_text/#conclusion","text":"cat input_file | sed '1s/^\\xEF\\xBB\\xBF//' | sed 's/\\r//g' > output_file","title":"Conclusion"},{"location":"1_cli/tools_data/free_text/#pseudo-regex-in-terminal","text":"* : Matches zero or more. {a,b,c} : Brace Expansion . Examples: ls some_dir/{subdir_A,subdir_B} mkdir {old,new,dist,bugs} Pattern Matching ?(pattern-list) : Matches zero or one occurrence of the given patterns. *(pattern-list) : Matches zero or more occurrences of the given patterns. +(pattern-list) : Matches one or more occurrences of the given patterns. @(pattern-list) : Matches one of the given patterns. !(pattern-list) : Matches anything except one of the given patterns.","title":"Pseudo-regex in terminal"},{"location":"1_cli/tools_data/free_text/#ascii","text":"0-31 32-63 64-95 96-127 128-159 160-191 192-223 224.255 0 \\0 32 64 @ 96 128 \u0080 160 192 \u00c0 224 \u00e0 1 SOH 33 ! 65 A 97 a 129 \u0081 161 \u00a1 193 \u00c1 225 \u00e1 2 STX 34 \" 66 B 98 b 130 \u0082 162 \u00a2 194 \u00c2 226 \u00e2 3 ETX 35 # 67 C 99 c 131 \u0083 163 \u00a3 195 \u00c3 227 \u00e3 4 EOT 36 $ 68 D 100 d 132 \u0084 164 \u00a4 196 \u00c4 228 \u00e4 5 ENQ 37 % 69 E 101 e 133 165 \u00a5 197 \u00c5 229 \u00e5 6 ACK 38 & 70 F 102 f 134 \u0086 166 \u00a6 198 \u00c6 230 \u00e6 7 BEL 39 ' 71 G 103 g 135 \u0087 167 \u00a7 199 \u00c7 231 \u00e7 8 BS 40 ( 72 H 104 h 136 \u0088 168 \u00a8 200 \u00c8 232 \u00e8 9 \\t 41 ) 73 I 105 i 137 \u0089 169 \u00a9 201 \u00c9 233 \u00e9 10 \\n 42 * 74 J 106 j 138 \u008a 170 \u00aa 202 \u00ca 234 \u00ea 11 \\v 43 + 75 K 107 k 139 \u008b 171 \u00ab 203 \u00cb 235 \u00eb 12 FF 44 , 76 L 108 l 140 \u008c 172 \u00ac 204 \u00cc 236 \u00ec 13 \\r 45 - 77 M 109 m 141 \u008d 173 \u00a1 205 \u00cd 237 \u00ed 14 SO 46 . 78 N 110 n 142 \u008e 174 \u00ae 206 \u00ce 238 \u00ee 15 SI 47 / 79 O 111 o 143 \u008f 175 \u00af 207 \u00cf 239 \u00ef 16 DLE 48 0 80 P 112 p 144 \u0090 176 \u00b0 208 \u00d0 240 \u00f0 17 DC1 49 1 81 Q 113 q 145 \u0091 177 \u00b1 209 \u00d1 241 \u00f1 18 DC2 50 2 82 R 114 r 146 \u0092 178 \u00b2 210 \u00d2 242 \u00f2 19 DC3 51 3 83 S 115 s 147 \u0093 179 \u00b3 211 \u00d3 243 \u00f3 20 DC4 52 4 84 T 116 t 148 \u0094 180 \u00b4 212 \u00d4 244 \u00f4 21 NAK 53 5 85 U 117 u 149 \u0095 181 \u00b5 213 \u00d5 245 \u00f5 22 SYN 54 6 86 V 118 v 150 \u0096 182 \u00b6 214 \u00d6 246 \u00f6 23 ETB 55 7 87 W 119 w 151 \u0097 183 \u00b7 215 \u00d7 247 \u00f7 24 CAN 56 8 88 X 120 x 152 \u0098 184 \u00b8 216 \u00d8 248 \u00f8 25 EM 57 9 89 Y 121 y 153 \u0099 185 \u00b9 217 \u00d9 249 \u00f9 26 SUB 58 : 90 Z 122 z 154 \u009a 186 \u00ba 218 \u00da 250 \u00fa 27 ESC 59 ; 91 [ 123 { 155 \u009b 187 \u00bb 219 \u00db 251 \u00fb 28 FS 60 < 92 \\ 124 \\| 156 \u009c 188 \u00bc 220 \u00dc 252 \u00fc 29 GS 61 = 93 ] 125 } 157 \u009d 189 \u00bd 221 \u00dd 253 \u00fd 30 RS 62 > 94 ^ 126 ~ 158 \u009e 190 \u00be 222 \u00de 254 \u00fe 31 US 63 ? 95 _ 127 DEL 159 \u009f 191 \u00bf 223 \u00df 255 \u00ff","title":"ASCII"},{"location":"1_cli/tools_data/free_text/#reference","text":"https://regexr.com/ https://regex101.com/ man re_format Char ranges https://www.youtube.com/playlist?list=PLp31D6HATKfdc5PSJTx7rIvlTLCSM5nDi https://www.youtube.com/watch?v=w61mxJcUV-o https://remram44.github.io/regex-cheatsheet/regex.html https://linuxize.com/post/regular-expressions-in-grep http://mywiki.wooledge.org/RegularExpression grep : print lines matching a pattern egrep : can handle extended regular expressions (EREs)","title":"Reference"},{"location":"1_cli/tools_data/html/","text":"Parsing HTML: pup Filter by tag : cat robots.html | pup 'title' Filter by tag with id : cat robots.html | pup 'span#See_also' Filter by tag with class : cat robots.html | pup 'table.someClass' Filter by tag with attribute : cat robots.html | pup 'th[scope=\"row\"]'","title":"Parsing HTML: [`pup`](https://github.com/ericchiang/pup)"},{"location":"1_cli/tools_data/html/#parsing-html-pup","text":"Filter by tag : cat robots.html | pup 'title' Filter by tag with id : cat robots.html | pup 'span#See_also' Filter by tag with class : cat robots.html | pup 'table.someClass' Filter by tag with attribute : cat robots.html | pup 'th[scope=\"row\"]'","title":"Parsing HTML: pup"},{"location":"1_cli/tools_data/image/","text":"Image Resize options Filter Downscaling quality Upscaling quality Performance Pillow: NEAREST \u2b50\u2b50\u2b50\u2b50\u2b50 Pillow: BOX \u2b50 \u2b50\u2b50\u2b50\u2b50 Pillow: BILINEAR \u2b50 \u2b50 \u2b50\u2b50\u2b50 Pillow: HAMMING \u2b50\u2b50 \u2b50\u2b50\u2b50 Pillow: BICUBIC \u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50 \u2b50\u2b50 Pillow: LANCZOS \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 \u2b50 Refencece Display images in terminal (iTerm2) iTerm2 has a protocol to display images: ESC ] 1337 ; key = value ^G printf \"\\033]1337;File=\" In practice, iTerm2 has the imgcat command to display images. imgcat path/to/image cat path/to/image | imgcat Another option is using the kitty terminal with the icat command. Display images inside a python script (source link1 , link2 ): # if you have iterm2 for osx (www.iterm2.com) this is a like print(...) for images in the console import base64 import io import numpngw import numpy as np def show_image(img): if img.dtype != np.uint8: print(\"ERROR: Should be an uint8 numpy array\") png_array = io.BytesIO() numpngw.write_png(png_array, img) encoded_png_array = base64.b64encode(png_array.getvalue()).decode(\"utf-8\", \"strict\") png_array.close() image_seq = '\\033]1337;File=[width=auto;height=auto;inline=1]:'+encoded_png_array+'\\007' print(image_seq, end='') LibJPEG-Turbo Decode JPEG (very fast): djpeg filename.jpg ImageMagick Command Description convert convert and modify images identify Output information about this image mogrify in-place batch processing composite overlaying images in special ways montage generate grid of images display Slideshows of Images animate Show GIF Animations compare Look for Differences stream Pipelined Image Processor import Read Images from On-screen Display conjure Experimental IM Scripting Language ImageMagick convert Synopsis: convert [input-options] input-file [output-options] output-file # Specify 'file' as '-' for standard input or output. Conversion between formats convert imagen.jpg imagen.png : Convertir una imagen de png a jpg convert imagen.{png,jpg} : Same of before using Expansion. Resizing convert -resize convert IN_IMG -resize 64x64 OUT_IMG Resize image (set larger to 64px) convert IN_IMG -resize 64x64\\! OUT_IMG Resize image (Ignore Aspect Ratio) Cropping convert -crop convert IN_IMG -crop 703x470+3+5 OUT_IMG Crop image with width x height + left + top format Generate grid of images: montage # Sytntax: montage INPUT_IMGS [OPTIONS] OUTPUT_IMG # Examples: montage imgs/* grid.png # Generate and save grid montage imgs/* - | imgcat # Generate grid to stdout and display it with imgcat montage imgs/* -geometry 100x100\\>+2+2 - | imgcat # Define size (100x100pxs) & margin (2px) of images","title":"Image"},{"location":"1_cli/tools_data/image/#image","text":"","title":"Image"},{"location":"1_cli/tools_data/image/#resize-options","text":"Filter Downscaling quality Upscaling quality Performance Pillow: NEAREST \u2b50\u2b50\u2b50\u2b50\u2b50 Pillow: BOX \u2b50 \u2b50\u2b50\u2b50\u2b50 Pillow: BILINEAR \u2b50 \u2b50 \u2b50\u2b50\u2b50 Pillow: HAMMING \u2b50\u2b50 \u2b50\u2b50\u2b50 Pillow: BICUBIC \u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50 \u2b50\u2b50 Pillow: LANCZOS \u2b50\u2b50\u2b50\u2b50 \u2b50\u2b50\u2b50\u2b50 \u2b50 Refencece","title":"Resize options"},{"location":"1_cli/tools_data/image/#display-images-in-terminal-iterm2","text":"iTerm2 has a protocol to display images: ESC ] 1337 ; key = value ^G printf \"\\033]1337;File=\" In practice, iTerm2 has the imgcat command to display images. imgcat path/to/image cat path/to/image | imgcat Another option is using the kitty terminal with the icat command. Display images inside a python script (source link1 , link2 ): # if you have iterm2 for osx (www.iterm2.com) this is a like print(...) for images in the console import base64 import io import numpngw import numpy as np def show_image(img): if img.dtype != np.uint8: print(\"ERROR: Should be an uint8 numpy array\") png_array = io.BytesIO() numpngw.write_png(png_array, img) encoded_png_array = base64.b64encode(png_array.getvalue()).decode(\"utf-8\", \"strict\") png_array.close() image_seq = '\\033]1337;File=[width=auto;height=auto;inline=1]:'+encoded_png_array+'\\007' print(image_seq, end='')","title":"Display images in terminal (iTerm2)"},{"location":"1_cli/tools_data/image/#libjpeg-turbo","text":"Decode JPEG (very fast): djpeg filename.jpg","title":"LibJPEG-Turbo"},{"location":"1_cli/tools_data/image/#imagemagick","text":"Command Description convert convert and modify images identify Output information about this image mogrify in-place batch processing composite overlaying images in special ways montage generate grid of images display Slideshows of Images animate Show GIF Animations compare Look for Differences stream Pipelined Image Processor import Read Images from On-screen Display conjure Experimental IM Scripting Language","title":"ImageMagick"},{"location":"1_cli/tools_data/image/#imagemagick-convert","text":"Synopsis: convert [input-options] input-file [output-options] output-file # Specify 'file' as '-' for standard input or output.","title":"ImageMagick convert"},{"location":"1_cli/tools_data/image/#conversion-between-formats","text":"convert imagen.jpg imagen.png : Convertir una imagen de png a jpg convert imagen.{png,jpg} : Same of before using Expansion.","title":"Conversion between formats"},{"location":"1_cli/tools_data/image/#resizing-convert-resize","text":"convert IN_IMG -resize 64x64 OUT_IMG Resize image (set larger to 64px) convert IN_IMG -resize 64x64\\! OUT_IMG Resize image (Ignore Aspect Ratio)","title":"Resizing convert -resize"},{"location":"1_cli/tools_data/image/#cropping-convert-crop","text":"convert IN_IMG -crop 703x470+3+5 OUT_IMG Crop image with width x height + left + top format","title":"Cropping convert -crop"},{"location":"1_cli/tools_data/image/#generate-grid-of-images-montage","text":"# Sytntax: montage INPUT_IMGS [OPTIONS] OUTPUT_IMG # Examples: montage imgs/* grid.png # Generate and save grid montage imgs/* - | imgcat # Generate grid to stdout and display it with imgcat montage imgs/* -geometry 100x100\\>+2+2 - | imgcat # Define size (100x100pxs) & margin (2px) of images","title":"Generate grid of images: montage"},{"location":"1_cli/tools_data/json/","text":"Parsing JSON: jq HTML table to csv : cat wiki.html | pup \"table.wikitable tbody tr json{}\" | jq '.[] | .children | \"\\(.[0].text),\\(.[1].text),\\(.[2].text)\"' -r table.json jq -r '.tbody.tr[1:][] | [.td[][\"$t\"]] | @csv' https://programminghistorian.org/en/lessons/json-and-jq https://www.datascienceatthecommandline.com/2e/chapter-5-scrubbing-data.html CSV to JSON jq --slurp --raw-input --raw-output ' split(\"\\n\") | ( .[0] | split(\",\") ) as $header | ( .[1:] | map(split(\",\")) ) as $body | $body | map( [$header, .] | transpose | map( {(.[0]): .[1]} ) | add)' sample_upload.csv","title":"Parsing JSON: `jq`"},{"location":"1_cli/tools_data/json/#parsing-json-jq","text":"HTML table to csv : cat wiki.html | pup \"table.wikitable tbody tr json{}\" | jq '.[] | .children | \"\\(.[0].text),\\(.[1].text),\\(.[2].text)\"' -r table.json jq -r '.tbody.tr[1:][] | [.td[][\"$t\"]] | @csv' https://programminghistorian.org/en/lessons/json-and-jq https://www.datascienceatthecommandline.com/2e/chapter-5-scrubbing-data.html","title":"Parsing JSON: jq"},{"location":"1_cli/tools_data/json/#csv-to-json","text":"jq --slurp --raw-input --raw-output ' split(\"\\n\") | ( .[0] | split(\",\") ) as $header | ( .[1:] | map(split(\",\")) ) as $body | $body | map( [$header, .] | transpose | map( {(.[0]): .[1]} ) | add)' sample_upload.csv","title":"CSV to JSON"},{"location":"1_cli/tools_data/pdf/","text":"Parsing PDF: Xpdf or poppler Xpdf : Viewer for Portable Document Format (PDF) files xpdf : PDF viewer (click for a screenshot) pdftotext : converts PDF to text pdftops : converts PDF to PostScript pdftoppm : converts PDF pages to netpbm (PPM/PGM/PBM) image files pdftopng : converts PDF pages to PNG image files pdftohtml : converts PDF to HTML pdfinfo : extracts PDF metadata pdfimages : extracts raw images from PDF files pdffonts : lists fonts used in PDF files pdfdetach : extracts attached files from PDF files Poppler : PDF rendering library based on xpdf pdfattach pdfdetach pdffonts pdfimages pdfinfo pdfseparate pdfsig pdftocairo pdftohtml pdftoppm pdftops pdftotext : Portable Document Format (PDF) to text converter pdftotext [options] someFile.pdf pdfunite MuPDF textutil : Only in MacOS (Usado por Pascual Perez) textutil -convert txt ~/Desktop/DrectorioDeArchivosEnPDF/*.pdf Xpdf Poppler MuPDF Installation sudo pacman -S xpdf sudo pacman -S poppler sudo pacman -S mupdf-tools PDF to text pdftotext -layout in.pdf out.txt mutool convert -o out.txt in.pdf for file in *.pdf; do pdftotext -layout \"$file\"; done for file in *.pdf; do mutool convert -o $file.txt $file; done Parse with OCR!: ocrmypdf Documents pandoc : Conversion between markup formats aspell : A spell checker designed to eventually replace Ispell https://programminghistorian.org/en/lessons/working-with-batches-of-pdf-files","title":"Pdf"},{"location":"1_cli/tools_data/pdf/#parsing-pdf-xpdf-or-poppler","text":"Xpdf : Viewer for Portable Document Format (PDF) files xpdf : PDF viewer (click for a screenshot) pdftotext : converts PDF to text pdftops : converts PDF to PostScript pdftoppm : converts PDF pages to netpbm (PPM/PGM/PBM) image files pdftopng : converts PDF pages to PNG image files pdftohtml : converts PDF to HTML pdfinfo : extracts PDF metadata pdfimages : extracts raw images from PDF files pdffonts : lists fonts used in PDF files pdfdetach : extracts attached files from PDF files Poppler : PDF rendering library based on xpdf pdfattach pdfdetach pdffonts pdfimages pdfinfo pdfseparate pdfsig pdftocairo pdftohtml pdftoppm pdftops pdftotext : Portable Document Format (PDF) to text converter pdftotext [options] someFile.pdf pdfunite MuPDF textutil : Only in MacOS (Usado por Pascual Perez) textutil -convert txt ~/Desktop/DrectorioDeArchivosEnPDF/*.pdf Xpdf Poppler MuPDF Installation sudo pacman -S xpdf sudo pacman -S poppler sudo pacman -S mupdf-tools PDF to text pdftotext -layout in.pdf out.txt mutool convert -o out.txt in.pdf for file in *.pdf; do pdftotext -layout \"$file\"; done for file in *.pdf; do mutool convert -o $file.txt $file; done","title":"Parsing PDF: Xpdf or poppler"},{"location":"1_cli/tools_data/pdf/#parse-with-ocr-ocrmypdf","text":"","title":"Parse with OCR!: ocrmypdf"},{"location":"1_cli/tools_data/pdf/#documents","text":"pandoc : Conversion between markup formats aspell : A spell checker designed to eventually replace Ispell https://programminghistorian.org/en/lessons/working-with-batches-of-pdf-files","title":"Documents"},{"location":"1_cli/tools_data/sound_video/","text":"Sound ffmepg Video and audio ffmpeg -i input.mp4 output.avi Convert audio format [FFmpeg: The Ultimate Guide](https://img.ly/blog/ultimate-guide-to-ffmpeg sox so und e x change, the Swiss Army knife of audio manipulation. play -n synth sin 1270 0.2 sin 1300 sin 1337 0.2 remix 1-3 repeat 0 vol 0.8 chorus 0.5 0.9 42 0.5 5 0.8 -t bandpass -c 1300 0.5q # You can use sox to try to replicate the sound of the BroodX Cicadas using a mix of 3 tones around 1300 Hz. Python OpenCV import cv2 cap = cv2.VideoCapture(0) while(True): ret, frame = cap.read() # Capture frame-by-frame. frame es nu nparray de 3 dims # Our operations on the frame come here... # Display the resulting frame cv2.imshow('frame',frame) if cv2.waitKey(1) & 0xFF == ord('q'): cv2.destroyAllWindows() break cap.release() # When everything done, release the capture (apagar la camara) cv2.destroyAllWindows()","title":"Sound"},{"location":"1_cli/tools_data/sound_video/#sound","text":"","title":"Sound"},{"location":"1_cli/tools_data/sound_video/#ffmepg","text":"Video and audio ffmpeg -i input.mp4 output.avi Convert audio format [FFmpeg: The Ultimate Guide](https://img.ly/blog/ultimate-guide-to-ffmpeg","title":"ffmepg"},{"location":"1_cli/tools_data/sound_video/#sox","text":"so und e x change, the Swiss Army knife of audio manipulation. play -n synth sin 1270 0.2 sin 1300 sin 1337 0.2 remix 1-3 repeat 0 vol 0.8 chorus 0.5 0.9 42 0.5 5 0.8 -t bandpass -c 1300 0.5q # You can use sox to try to replicate the sound of the BroodX Cicadas using a mix of 3 tones around 1300 Hz.","title":"sox"},{"location":"1_cli/tools_data/sound_video/#python-opencv","text":"import cv2 cap = cv2.VideoCapture(0) while(True): ret, frame = cap.read() # Capture frame-by-frame. frame es nu nparray de 3 dims # Our operations on the frame come here... # Display the resulting frame cv2.imshow('frame',frame) if cv2.waitKey(1) & 0xFF == ord('q'): cv2.destroyAllWindows() break cap.release() # When everything done, release the capture (apagar la camara) cv2.destroyAllWindows()","title":"Python OpenCV"},{"location":"1_cli/tools_net/basics/","text":"Old commands ( net-tools ) New commands ( iproute2 ) ifconfig ip address, ip link arp ip neighbor route ip route netstat ss [Deprecation of net-tools (2011)](https://archlinux.org/news/deprecation-of-net-tools] https://wiki.archlinux.org/title/Network_configuration Packets ngrep: grep for your network tcdump: show me all packets on port 80! wireshark: look at those packets in a GUI tshark: wireshark at th comman line tcpflow: capture assemble TCP streams ping are these computers even connected ssh scp rsync ifconfig route ip arp mitmproxy nmap zenmap p0f openvpn wireguard nc socat telnet ftp/sftp netstat ss lsof fuser iptables nftables hping3 traceroute/mtr tcptraceroute ethtool iw/iwconfig sysctl","title":"Basics"},{"location":"1_cli/tools_net/basics/#packets","text":"ngrep: grep for your network tcdump: show me all packets on port 80! wireshark: look at those packets in a GUI tshark: wireshark at th comman line tcpflow: capture assemble TCP streams","title":"Packets"},{"location":"1_cli/tools_net/basics/#ping-are-these-computers-even-connected","text":"ssh scp rsync ifconfig route ip arp","title":"ping    are these computers even connected"},{"location":"1_cli/tools_net/basics/#mitmproxy","text":"nmap zenmap p0f openvpn wireguard nc socat telnet","title":"mitmproxy"},{"location":"1_cli/tools_net/basics/#ftpsftp","text":"netstat ss lsof fuser iptables nftables hping3 traceroute/mtr tcptraceroute ethtool iw/iwconfig sysctl","title":"ftp/sftp"},{"location":"1_cli/tools_net/deffensive/","text":"Cybersecurity Blackarch repos in Arch linux curl -O https://blackarch.org/strap.sh # Download script echo 8bfe5a569ba7d3b055077a4e5ceada94119cccef strap.sh | sha1sum -c # Verify the SHA1 sum chmod +x strap.sh # Set execute bit sudo ./strap.sh # Run strap.sh sudo pacman -Syu # Enable multilib Prevent attacks and uses Encryption in communication SSL TLS Basic Auth (user y password) Restrict by IP","title":"Cybersecurity"},{"location":"1_cli/tools_net/deffensive/#cybersecurity","text":"","title":"Cybersecurity"},{"location":"1_cli/tools_net/deffensive/#blackarch-repos-in-arch-linux","text":"curl -O https://blackarch.org/strap.sh # Download script echo 8bfe5a569ba7d3b055077a4e5ceada94119cccef strap.sh | sha1sum -c # Verify the SHA1 sum chmod +x strap.sh # Set execute bit sudo ./strap.sh # Run strap.sh sudo pacman -Syu # Enable multilib Prevent attacks and uses","title":"Blackarch repos in Arch linux"},{"location":"1_cli/tools_net/deffensive/#encryption-in-communication","text":"SSL TLS","title":"Encryption in communication"},{"location":"1_cli/tools_net/deffensive/#basic-auth-user-y-password","text":"","title":"Basic Auth (user y password)"},{"location":"1_cli/tools_net/deffensive/#restrict-by-ip","text":"","title":"Restrict by IP"},{"location":"1_cli/tools_net/firewall/","text":"Firewall # iptables is already installed. I like ufw. pacman -S ufw # Install ufw ufw enable # Enable it only once, when package is installed ufw status verbose # Check its status systemctl start ufw # Start the firewall systemctl enable ufw # Enable the start-up with the system [option a] systemctl enable ufw.service # Enable the start-up with the system [option b]","title":"Firewall"},{"location":"1_cli/tools_net/firewall/#firewall","text":"# iptables is already installed. I like ufw. pacman -S ufw # Install ufw ufw enable # Enable it only once, when package is installed ufw status verbose # Check its status systemctl start ufw # Start the firewall systemctl enable ufw # Enable the start-up with the system [option a] systemctl enable ufw.service # Enable the start-up with the system [option b]","title":"Firewall"},{"location":"1_cli/tools_net/pentesting/","text":"Pentesting Pentesting is a short for penetration testing 1 Ver la maqina con Ping -c 1 : Solo hace 1 ping para ver si la maqina esta encencida -R : Pone las ips intermedias por dnde pasa ( traceroute is usually better) Pin muestrea el TTL de la m\u00e1quina - TTL<=64 es Linux - TTL<=128 es Windows Por cada nodo intermediaro se resta 1 al TLL 2 Escanear puertos con NMAP nmap --open # Listar puertos abiertos -T5 # Es el modo mas agresivo -v # A medida que encuentre puertos me los reporte por pantalla -n # Quitar la resolucion DNS (para ganar velocidad) -p40-80 # Rango de puertos 40 a 80 https://www.cyberciti.biz/security/nmap-command-examples-tutorials/ 2.1 Escanear todos los puertos de forma r\u00e1pida 2.2 Escanar los puertos abiertos de forma exhaustiva Ataque a servidor web (puertos 22,443) Ataque fuerza bruta Programas de fuerza bruta: wfuzz feroxbuster Listas de tokens a probar: https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/directory-list-2.3-medium.txt Reference Gente S4vitar Canal de YouTube primario de S4vitar (En Espa\u00f1ol) Canal de YouTube secundario de S4vitar (En Espa\u00f1ol) M\u00e1quinas HackTheBox realizadas Twitch de S4vitar con directos todos los d\u00edas a las 21 horas (Espa\u00f1a peninsular!) S4vitar en Odysee (En Espa\u00f1ol) 0xdf Canal de YouTube Blog (principalmente soluciones de m\u00e1quinas de HackTheBox) Otros canales de Youtube en ingl\u00e9s: Canal de YouTube de CyberMentor Canal de YouTube de Ippsec Canal de YouTube de John Hammond Canal de YouTube de HackerSploit George Hotz george hotz archive geohot @ overthewire vortex part 1 geohot @ overthewire vortex part 2 geohot @ overthewire vortex part 3 geohot @ overthewire vortex part 4 geohot @ overthewire vortex level 12->13 geohot @ overthewire vortex level 12->13 Plataformas para practicar HackTheBox VulnHub OverTheWire gf0s Labs Root-Me HackThisSite PicoCTF DefendTheWeb GoogleGruyere bWapp OffensiveSecurity Crybary HackRocks Atenea HackMyVM TryHackMe warning Con cuidado! https://www.sothis.tech/capture-the-flag-aprende-hacking-jugando","title":"Pentesting"},{"location":"1_cli/tools_net/pentesting/#pentesting","text":"Pentesting is a short for penetration testing","title":"Pentesting"},{"location":"1_cli/tools_net/pentesting/#1-ver-la-maqina-con-ping","text":"-c 1 : Solo hace 1 ping para ver si la maqina esta encencida -R : Pone las ips intermedias por dnde pasa ( traceroute is usually better) Pin muestrea el TTL de la m\u00e1quina - TTL<=64 es Linux - TTL<=128 es Windows Por cada nodo intermediaro se resta 1 al TLL","title":"1 Ver la maqina con Ping"},{"location":"1_cli/tools_net/pentesting/#2-escanear-puertos-con-nmap","text":"nmap --open # Listar puertos abiertos -T5 # Es el modo mas agresivo -v # A medida que encuentre puertos me los reporte por pantalla -n # Quitar la resolucion DNS (para ganar velocidad) -p40-80 # Rango de puertos 40 a 80 https://www.cyberciti.biz/security/nmap-command-examples-tutorials/","title":"2 Escanear puertos con NMAP"},{"location":"1_cli/tools_net/pentesting/#21-escanear-todos-los-puertos-de-forma-rapida","text":"","title":"2.1 Escanear todos los puertos de forma r\u00e1pida"},{"location":"1_cli/tools_net/pentesting/#22-escanar-los-puertos-abiertos-de-forma-exhaustiva","text":"","title":"2.2 Escanar los puertos abiertos de forma exhaustiva"},{"location":"1_cli/tools_net/pentesting/#ataque-a-servidor-web-puertos-22443","text":"","title":"Ataque a servidor web (puertos 22,443)"},{"location":"1_cli/tools_net/pentesting/#ataque-fuerza-bruta","text":"Programas de fuerza bruta: wfuzz feroxbuster Listas de tokens a probar: https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/directory-list-2.3-medium.txt","title":"Ataque fuerza bruta"},{"location":"1_cli/tools_net/pentesting/#reference","text":"","title":"Reference"},{"location":"1_cli/tools_net/pentesting/#gente","text":"S4vitar Canal de YouTube primario de S4vitar (En Espa\u00f1ol) Canal de YouTube secundario de S4vitar (En Espa\u00f1ol) M\u00e1quinas HackTheBox realizadas Twitch de S4vitar con directos todos los d\u00edas a las 21 horas (Espa\u00f1a peninsular!) S4vitar en Odysee (En Espa\u00f1ol) 0xdf Canal de YouTube Blog (principalmente soluciones de m\u00e1quinas de HackTheBox) Otros canales de Youtube en ingl\u00e9s: Canal de YouTube de CyberMentor Canal de YouTube de Ippsec Canal de YouTube de John Hammond Canal de YouTube de HackerSploit George Hotz george hotz archive geohot @ overthewire vortex part 1 geohot @ overthewire vortex part 2 geohot @ overthewire vortex part 3 geohot @ overthewire vortex part 4 geohot @ overthewire vortex level 12->13 geohot @ overthewire vortex level 12->13","title":"Gente"},{"location":"1_cli/tools_net/pentesting/#plataformas-para-practicar","text":"HackTheBox VulnHub OverTheWire gf0s Labs Root-Me HackThisSite PicoCTF DefendTheWeb GoogleGruyere bWapp OffensiveSecurity Crybary HackRocks Atenea HackMyVM TryHackMe warning Con cuidado! https://www.sothis.tech/capture-the-flag-aprende-hacking-jugando","title":"Plataformas para practicar"},{"location":"1_cli/tools_net/server_web/","text":"HTTP server https://atareao.es/software/utilidades/httpie-un-cliente-http-para-la-linea-de-comandos/ Python HTTP server python3 -m http.server 9000 Now, create the simple index.html file inside that server directory where you have started the server. go to http://localhost:9000 Netcat HTTP server while true do echo -e \"HTTP/1.1 200 OK\\r\\n\\r\\n$(date)\" | nc -l localhost 8888 done # ncat -lk -p 8080 --exec $(server_response) # --listen --keep-open # https://www.youtube.com/watch?v=pYjoqsFjzgQ function response { echo -en \"HTTP/1.1 200 OK\\r\\n\\r\\n\" echo '<!DOCTYPE html>' echo '<html lang=\"es\">' echo ' <head>' echo ' <title>HTML</title>' echo ' <meta charset=\"utf-8\">' echo ' <meta http-equiv=\"refresh\" content=\"5\">' # Update frontend every 5 seconds echo ' </head>' echo ' <body>' echo \" $(date)\" echo ' </body>' echo '</html>' } while true; do response | nc -l localhost 8888 # here netcat waits for 1 connection, # When the user concet to http://localhost:8888 # The program flow continues echo \"================================================\" done HTTP protocol HTTP request GET / HTTP/1.1 -> request line Host: localhost:8000 \\ User-Agent: curl/7.54.0 | Request headers Accept: */* / HTTP response HTTP/1.1 200 OK Content-Type: text/html Content-Lenght: 11 Hello world INTERNET --http--> WEB SERVER --http--> APPLICATION SERVER --wsgi--> WEB FRAMEWORK ========== ================== ============= apache gunicorn Django ngixn uWSGI Flask FastAPI https://www.youtube.com/watch?v=UklcIDgHtwQ https://www.youtube.com/watch?v=WqrCnVAkLIo CGI: Common Gateway Interface (1997) WSGI: Web Server Gateway Interface (2003) caching mechanism: Reverse proxy: a system that forwards all requests from the web to our web server and back Que pasa si alguien sube una imagen (o imagenens) muy pesada? Relentiza el servidor? gunicorn bloquearia la petici\u00f3n Pero ngixn haria offloading buffering Load balancing \"failover\" or \"load balancing\", which is where two servers provide the same service but allow for distribution in the event of problems. Services like NGINX, Cloudflare, Apigee, AWS ELB, HAProxy Existen distintos criterios para balancear: Por tama\u00f1o de paquete Por numero de peticiones ...","title":"HTTP server"},{"location":"1_cli/tools_net/server_web/#http-server","text":"https://atareao.es/software/utilidades/httpie-un-cliente-http-para-la-linea-de-comandos/","title":"HTTP server"},{"location":"1_cli/tools_net/server_web/#python-http-server","text":"python3 -m http.server 9000 Now, create the simple index.html file inside that server directory where you have started the server. go to http://localhost:9000","title":"Python HTTP server"},{"location":"1_cli/tools_net/server_web/#netcat-http-server","text":"while true do echo -e \"HTTP/1.1 200 OK\\r\\n\\r\\n$(date)\" | nc -l localhost 8888 done # ncat -lk -p 8080 --exec $(server_response) # --listen --keep-open # https://www.youtube.com/watch?v=pYjoqsFjzgQ function response { echo -en \"HTTP/1.1 200 OK\\r\\n\\r\\n\" echo '<!DOCTYPE html>' echo '<html lang=\"es\">' echo ' <head>' echo ' <title>HTML</title>' echo ' <meta charset=\"utf-8\">' echo ' <meta http-equiv=\"refresh\" content=\"5\">' # Update frontend every 5 seconds echo ' </head>' echo ' <body>' echo \" $(date)\" echo ' </body>' echo '</html>' } while true; do response | nc -l localhost 8888 # here netcat waits for 1 connection, # When the user concet to http://localhost:8888 # The program flow continues echo \"================================================\" done","title":"Netcat HTTP server"},{"location":"1_cli/tools_net/server_web/#http-protocol","text":"","title":"HTTP protocol"},{"location":"1_cli/tools_net/server_web/#http-request","text":"GET / HTTP/1.1 -> request line Host: localhost:8000 \\ User-Agent: curl/7.54.0 | Request headers Accept: */* /","title":"HTTP request"},{"location":"1_cli/tools_net/server_web/#http-response","text":"HTTP/1.1 200 OK Content-Type: text/html Content-Lenght: 11 Hello world INTERNET --http--> WEB SERVER --http--> APPLICATION SERVER --wsgi--> WEB FRAMEWORK ========== ================== ============= apache gunicorn Django ngixn uWSGI Flask FastAPI https://www.youtube.com/watch?v=UklcIDgHtwQ https://www.youtube.com/watch?v=WqrCnVAkLIo CGI: Common Gateway Interface (1997) WSGI: Web Server Gateway Interface (2003) caching mechanism: Reverse proxy: a system that forwards all requests from the web to our web server and back Que pasa si alguien sube una imagen (o imagenens) muy pesada? Relentiza el servidor? gunicorn bloquearia la petici\u00f3n Pero ngixn haria offloading buffering","title":"HTTP response"},{"location":"1_cli/tools_net/server_web/#load-balancing","text":"\"failover\" or \"load balancing\", which is where two servers provide the same service but allow for distribution in the event of problems. Services like NGINX, Cloudflare, Apigee, AWS ELB, HAProxy Existen distintos criterios para balancear: Por tama\u00f1o de paquete Por numero de peticiones ...","title":"Load balancing"},{"location":"1_cli/tools_net/ssl/","text":"openssl stunnel: Make a SSL proxie for an insecure server","title":"Ssl"},{"location":"1_cli/tools_net/vpn/","text":"openvpn wireguard","title":"Vpn"},{"location":"1_cli/tools_net/web_scraping/","text":"Web Scraping curl : make any HTTP you want httpie : like curl but easier (http get) wget : Download files aria2c : a fancier wget curl -d, --data <data> : (HTTP) Sends the specified data in a POST request to the HTTP server. -i, --include : Show HTTP response headers. -s, --silent : Silent or quiet mode. Don't show progress meter or error messages. -v, --verbose : Verbose. Show request headers (>) and response headers (<). HTTP Content-Type Curl client Flask server params in URL curl https://ip:port/endpoint?name=Javi flask.request.args.get('name') multipart/form-data curl -F name=Javi flask.request.form[\"name\"] multipart/form-data curl -F img=@myimg.jpg flask.request.files['img'] application/json curl -d \"{\\\"name\\\": \\\"Javi\\\"}\" json = flask.request.json httpie wget wget URL # Download and store in the current directory. wget -O CUSTOM_FILENAME URL # Download and store in the current directory with a different file name. wget -O - URL # Download and redirects to stdout wget --limit-rate=200k URL # Specify download speed. Here speed is limited to 200k. wget -c URL # Continue the Incomplete Download wget -b URL # Download in the Background wget --spider URL # Not download the webpage, just check that it is there. wget --tries=75 URL # Increase Total Number of Retry Attempts wget -i FILE_WITH_URLS.txt # Download multiple URLs. Each line in the txt document is a URL. -m --mirror # Turns on infinite recursion and time-stamping, and keeps FTP directory listings. -r --recursive # Turn on recursive retrieving. The default maximum depth is 5. -l depth --level=depth # Set the maximum number of subdirectories that Wget will recurse into to depth. inf means infinite -N --timestamping # Turn on time-stamping. --no-remove-listing # Don't remove the .listing files generated by FTP retrievals. -p --page-requisites # Downloads all files that are necessary to properly display a given HTML page. -k --convert-links # After the download, convert the external links to make the work. -P ./LOCAL-DIR # saves all the files and directories to the specified directory. wget --mirror --page-requisites --convert-links -P ./LOCAL_DIR URL # Download a Full Website wget -Q5m -i FILE_WITH_URLS.txt # Quit Downloading When it Exceeds Certain Size wget --ftp-user=USERNAME --ftp-password=PASSWORD URL # FTP Download With wget wget --reject=gif URL # Reject Certain File Types while Downloading wget -o download.log URL # Log messages to a log file instead of stderr Using wget -o Reference https://www.queryhome.com/tech/54364/overview-about-wget-command https://www.linuxtechi.com/wget-command-practical-examples/ https://www.youtube.com/watch?v=GJum2O2JM6M https://www.youtube.com/watch?v=-GCDJ26B4Ho Login/Session/Cookie Hide yoir IP with proxy servers BAD : you ---------> request to target GOOD : you ---------> requets to proxy server -------> request to target 1. gimmeproxy Make the following request: https://gimmeproxy.com/api/getProxy 2. They will provide JSON response with all proxy data which you can use later as needed: { \"supportsHttps\": true, \"protocol\": \"socks5\", \"ip\": \"179.162.22.82\", \"port\": \"36915\", ... } 3. Use the proxy with curl # -x [protocol://]host[:port] # --proxy [protocol://]host[:port] curl -x socks5://179.162.22.82:36915 http://example.com Web Scraping methods There are many approaches of web scrapping: Text browser ( lynx ) + parse text ( grep ) Download HTML ( cURL ) + to text ( html2text ) + parse text ( grep ) Download HTML ( cURL ) + parse HTML ( pup ) Do API reverse engineering + parse JSON ( jq ) Use Selenium or Headless browser Text browser ( lynx ) + parse text ( grep ) lynx -dump \"$the_url\" | grep \"$the_str\") Reference: https://funprojects.blog/2022/04/07/web-scraping-with-1-line-of-bash/ 1. Static webpages Get a simple static page (server side rendered) with curl or wget and parse them Example: page_html=$(curl -s $URL) title=$(echo $page_html | pup 'title' text{}) echo $title col_A=$(echo $page_html | pup 'a.bb1c_ attr{href}') col_B=$(echo $page_html | pup 'span.price-sale text{}') table=$(paste col_A col_B) https://www.youtube.com/watch?v=GJum2O2JM6M 2. API reverse engineering Useful for dynamic websites. Find the hidden api that makes XHR requests to fullfill the webpage. XMLHttpRequest is used heavily in AJAX programming. Step 1: See the requests that the web is doing: Chrome or Firefox dev tools > Network > XHR requests Step 2: Copy the target request as cURL (right click) Step 3: Paste the target request in Postman or Insomnia Step 4: Elaborate your own script using curl + jq 3. Headless browser & Selenium Use Selenium or Headless browser for automate the interaction with the web. Selenium Google Chrome cli lynx lynx -dump -listonly http://aligajani.com google-chrome-stable --headless --disable-gpu --dump-dom 'URL' > ~/file.html Refenrences https://www.youtube.com/c/JohnWatsonRooney https://www.youtube.com/channel/UCBGkweoKCtSBx6GEXRYIWLg/videos https://www.youtube.com/playlist?list=PLcUid3OP_4OU0zHx1qlCMdB6pEP1zeaY3 https://www.youtube.com/watch?v=kmlYp8I1MJs&list=PLISuMnTdVU-xOHf3jEtiK1B_g5HFgXCb-","title":"Web Scraping"},{"location":"1_cli/tools_net/web_scraping/#web-scraping","text":"curl : make any HTTP you want httpie : like curl but easier (http get) wget : Download files aria2c : a fancier wget","title":"Web Scraping"},{"location":"1_cli/tools_net/web_scraping/#curl","text":"-d, --data <data> : (HTTP) Sends the specified data in a POST request to the HTTP server. -i, --include : Show HTTP response headers. -s, --silent : Silent or quiet mode. Don't show progress meter or error messages. -v, --verbose : Verbose. Show request headers (>) and response headers (<). HTTP Content-Type Curl client Flask server params in URL curl https://ip:port/endpoint?name=Javi flask.request.args.get('name') multipart/form-data curl -F name=Javi flask.request.form[\"name\"] multipart/form-data curl -F img=@myimg.jpg flask.request.files['img'] application/json curl -d \"{\\\"name\\\": \\\"Javi\\\"}\" json = flask.request.json","title":"curl"},{"location":"1_cli/tools_net/web_scraping/#httpie","text":"","title":"httpie"},{"location":"1_cli/tools_net/web_scraping/#wget","text":"wget URL # Download and store in the current directory. wget -O CUSTOM_FILENAME URL # Download and store in the current directory with a different file name. wget -O - URL # Download and redirects to stdout wget --limit-rate=200k URL # Specify download speed. Here speed is limited to 200k. wget -c URL # Continue the Incomplete Download wget -b URL # Download in the Background wget --spider URL # Not download the webpage, just check that it is there. wget --tries=75 URL # Increase Total Number of Retry Attempts wget -i FILE_WITH_URLS.txt # Download multiple URLs. Each line in the txt document is a URL. -m --mirror # Turns on infinite recursion and time-stamping, and keeps FTP directory listings. -r --recursive # Turn on recursive retrieving. The default maximum depth is 5. -l depth --level=depth # Set the maximum number of subdirectories that Wget will recurse into to depth. inf means infinite -N --timestamping # Turn on time-stamping. --no-remove-listing # Don't remove the .listing files generated by FTP retrievals. -p --page-requisites # Downloads all files that are necessary to properly display a given HTML page. -k --convert-links # After the download, convert the external links to make the work. -P ./LOCAL-DIR # saves all the files and directories to the specified directory. wget --mirror --page-requisites --convert-links -P ./LOCAL_DIR URL # Download a Full Website wget -Q5m -i FILE_WITH_URLS.txt # Quit Downloading When it Exceeds Certain Size wget --ftp-user=USERNAME --ftp-password=PASSWORD URL # FTP Download With wget wget --reject=gif URL # Reject Certain File Types while Downloading wget -o download.log URL # Log messages to a log file instead of stderr Using wget -o","title":"wget"},{"location":"1_cli/tools_net/web_scraping/#reference","text":"https://www.queryhome.com/tech/54364/overview-about-wget-command https://www.linuxtechi.com/wget-command-practical-examples/ https://www.youtube.com/watch?v=GJum2O2JM6M https://www.youtube.com/watch?v=-GCDJ26B4Ho","title":"Reference"},{"location":"1_cli/tools_net/web_scraping/#loginsessioncookie","text":"","title":"Login/Session/Cookie"},{"location":"1_cli/tools_net/web_scraping/#hide-yoir-ip-with-proxy-servers","text":"BAD : you ---------> request to target GOOD : you ---------> requets to proxy server -------> request to target","title":"Hide yoir IP with proxy servers"},{"location":"1_cli/tools_net/web_scraping/#1-gimmeproxy","text":"Make the following request: https://gimmeproxy.com/api/getProxy","title":"1. gimmeproxy"},{"location":"1_cli/tools_net/web_scraping/#2-they-will-provide-json-response-with-all-proxy-data-which-you-can-use-later-as-needed","text":"{ \"supportsHttps\": true, \"protocol\": \"socks5\", \"ip\": \"179.162.22.82\", \"port\": \"36915\", ... }","title":"2. They will provide JSON response with all proxy data which you can use later as needed:"},{"location":"1_cli/tools_net/web_scraping/#3-use-the-proxy-with-curl","text":"# -x [protocol://]host[:port] # --proxy [protocol://]host[:port] curl -x socks5://179.162.22.82:36915 http://example.com","title":"3. Use the proxy with curl"},{"location":"1_cli/tools_net/web_scraping/#web-scraping-methods","text":"There are many approaches of web scrapping: Text browser ( lynx ) + parse text ( grep ) Download HTML ( cURL ) + to text ( html2text ) + parse text ( grep ) Download HTML ( cURL ) + parse HTML ( pup ) Do API reverse engineering + parse JSON ( jq ) Use Selenium or Headless browser","title":"Web Scraping methods"},{"location":"1_cli/tools_net/web_scraping/#text-browser-lynx-parse-text-grep","text":"lynx -dump \"$the_url\" | grep \"$the_str\") Reference: https://funprojects.blog/2022/04/07/web-scraping-with-1-line-of-bash/","title":"Text browser (lynx) + parse text (grep)"},{"location":"1_cli/tools_net/web_scraping/#1-static-webpages","text":"Get a simple static page (server side rendered) with curl or wget and parse them Example: page_html=$(curl -s $URL) title=$(echo $page_html | pup 'title' text{}) echo $title col_A=$(echo $page_html | pup 'a.bb1c_ attr{href}') col_B=$(echo $page_html | pup 'span.price-sale text{}') table=$(paste col_A col_B) https://www.youtube.com/watch?v=GJum2O2JM6M","title":"1. Static webpages"},{"location":"1_cli/tools_net/web_scraping/#2-api-reverse-engineering","text":"Useful for dynamic websites. Find the hidden api that makes XHR requests to fullfill the webpage. XMLHttpRequest is used heavily in AJAX programming. Step 1: See the requests that the web is doing: Chrome or Firefox dev tools > Network > XHR requests Step 2: Copy the target request as cURL (right click) Step 3: Paste the target request in Postman or Insomnia Step 4: Elaborate your own script using curl + jq","title":"2. API reverse engineering"},{"location":"1_cli/tools_net/web_scraping/#3-headless-browser-selenium","text":"Use Selenium or Headless browser for automate the interaction with the web. Selenium Google Chrome cli lynx lynx -dump -listonly http://aligajani.com google-chrome-stable --headless --disable-gpu --dump-dom 'URL' > ~/file.html","title":"3. Headless browser &amp; Selenium"},{"location":"1_cli/tools_net/web_scraping/#refenrences","text":"https://www.youtube.com/c/JohnWatsonRooney https://www.youtube.com/channel/UCBGkweoKCtSBx6GEXRYIWLg/videos https://www.youtube.com/playlist?list=PLcUid3OP_4OU0zHx1qlCMdB6pEP1zeaY3 https://www.youtube.com/watch?v=kmlYp8I1MJs&list=PLISuMnTdVU-xOHf3jEtiK1B_g5HFgXCb-","title":"Refenrences"},{"location":"1_cli/tools_net/DNS/readme/","text":"DNS Under the hood when you run curl: 1. Consult your DNS servers (stored in /etc/resolv.conf ) - 8.8.8.8 is Google DNS server! 2. curl call getaddrinfo is a 3. getaddrinfo makes a \"DNS request\" to 8.8.8.8 4. Finally the IP is obtained dig , nslookup : what's the IP for that domain? (DNS query) whois : is this domain registered? dig dig makes DNS queries! dig google.com nslookup whois DNS Server (static and dynamic, as dyndns)","title":"DNS"},{"location":"1_cli/tools_net/DNS/readme/#dns","text":"Under the hood when you run curl: 1. Consult your DNS servers (stored in /etc/resolv.conf ) - 8.8.8.8 is Google DNS server! 2. curl call getaddrinfo is a 3. getaddrinfo makes a \"DNS request\" to 8.8.8.8 4. Finally the IP is obtained dig , nslookup : what's the IP for that domain? (DNS query) whois : is this domain registered?","title":"DNS"},{"location":"1_cli/tools_net/DNS/readme/#dig","text":"dig makes DNS queries! dig google.com","title":"dig"},{"location":"1_cli/tools_net/DNS/readme/#nslookup","text":"","title":"nslookup"},{"location":"1_cli/tools_net/DNS/readme/#whois","text":"","title":"whois"},{"location":"1_cli/tools_net/DNS/readme/#dns-server","text":"(static and dynamic, as dyndns)","title":"DNS Server"},{"location":"1_cli/tools_net/DNS/server_dns/","text":"","title":"Server dns"},{"location":"2_python/debugging/","text":"Debugging print() : too simple import pdb; pdb.set_trace() : too complex import code; code.interact(local=locals()) : just right simply drops you into interpreter, perfect for 95% of debugging https://twitter.com/karpathy/status/1610822271157022720 Python debugging: ipdb Start the debugger: - python -m pdb my_program.py - python -m ipdb my_program.py Debugger commands: - s : step - c : countiue until ends or break - p var1 : print value of var1 - p var1,var2 : print value of var1 and var2 - p locals() : print value of all vars - l : list code and see lines - b 6 : create a break point at line 6 - q : Quit the debugger","title":"Debugging"},{"location":"2_python/debugging/#debugging","text":"print() : too simple import pdb; pdb.set_trace() : too complex import code; code.interact(local=locals()) : just right simply drops you into interpreter, perfect for 95% of debugging https://twitter.com/karpathy/status/1610822271157022720","title":"Debugging"},{"location":"2_python/debugging/#python-debugging-ipdb","text":"Start the debugger: - python -m pdb my_program.py - python -m ipdb my_program.py Debugger commands: - s : step - c : countiue until ends or break - p var1 : print value of var1 - p var1,var2 : print value of var1 and var2 - p locals() : print value of all vars - l : list code and see lines - b 6 : create a break point at line 6 - q : Quit the debugger","title":"Python debugging: ipdb"},{"location":"2_python/dot_prod/","text":"_ _USER _ _ _ITEM ___ _ W _B _ W _B [.1 .2 .4] [.5] [.2 .3 .6] [.2] affinity = 0,1 0,2 + 0,2 0,3 + 0,4*0,6 + 0,5 + 0,2 = 1,02 affinity = (0,1+0,5) (0,2+0,2) + (0,2+0,5) (0,3+0,2) + (0,4+0,5)*(0,6+0,2) = 1,31","title":"Dot prod"},{"location":"2_python/io_buffering/","text":"write bufferinf .write() por defecto, sino escribe m\u00e1s de 8KB, pytohn no escribe en disco y escribe en buffering. En estos casos solo escribe realmente en dico cuando .close() o .flush() Se puede cambiar el tam\u00f1ado del bufering al abrir un file: | Filte type | buffering=-1 (defualt) | buffering=0 | buffering=1 | buffering>1 | |-------------------------------------|-------------|----------------|---------------- | Text | io.DEFAULT_BUFFER_SIZE | - | line buffering | io.DEFAULT_BUFFER_SIZE | Binary | io.DEFAULT_BUFFER_SIZE | unbuffered | - | specified buffer size Error comun: No especificar el buffering y por defecto es=-1 Esto siginififica que solo escribirar en dicso cuando halla una escritoura mayor de 8192 bytes (8KB). Por loa tanto se va llenano la memoria del buffer con escrituras peque\u00f1as (menores de 8192 bytes) y finalemnte el OS mata el proceso. https://medium.com/@bramblexu/understand-the-buffer-policy-in-python-78e91e7759ca Numpy IO Numpy Read array np.load() --> \u274c Slow np.memmap() --> \u2705 Fast np.memmap(\"matrix_Nx512_float32\", dtype='float32', mode='r').reshape((-1,512)) Numpy Write array my_file = open(filepath, mode='wb') Open file in write binary mode Write my_arr.save(my_file) \u274c Write unncesary info (type, shape) my_arr.tofile(my_file) \u2705 Always write to disk my_file.write(my_arr.tobytes()) \u2705 Only writes to disk when buffer (8KB) is full. You can force to write by calling my_file.flush() or my_file.close() List Slicing withot copy data data = b\"abcdefgh\" data_view = memoryview(data) sub_data = data_view[1:3] https://julien.danjou.info/high-performance-in-python-with-zero-copy-and-the-buffer-protocol/","title":"Io buffering"},{"location":"2_python/io_buffering/#write-bufferinf","text":".write() por defecto, sino escribe m\u00e1s de 8KB, pytohn no escribe en disco y escribe en buffering. En estos casos solo escribe realmente en dico cuando .close() o .flush() Se puede cambiar el tam\u00f1ado del bufering al abrir un file: | Filte type | buffering=-1 (defualt) | buffering=0 | buffering=1 | buffering>1 | |-------------------------------------|-------------|----------------|---------------- | Text | io.DEFAULT_BUFFER_SIZE | - | line buffering | io.DEFAULT_BUFFER_SIZE | Binary | io.DEFAULT_BUFFER_SIZE | unbuffered | - | specified buffer size Error comun: No especificar el buffering y por defecto es=-1 Esto siginififica que solo escribirar en dicso cuando halla una escritoura mayor de 8192 bytes (8KB). Por loa tanto se va llenano la memoria del buffer con escrituras peque\u00f1as (menores de 8192 bytes) y finalemnte el OS mata el proceso. https://medium.com/@bramblexu/understand-the-buffer-policy-in-python-78e91e7759ca","title":"write bufferinf"},{"location":"2_python/io_buffering/#numpy-io","text":"","title":"Numpy IO"},{"location":"2_python/io_buffering/#numpy-read-array","text":"np.load() --> \u274c Slow np.memmap() --> \u2705 Fast np.memmap(\"matrix_Nx512_float32\", dtype='float32', mode='r').reshape((-1,512))","title":"Numpy Read array"},{"location":"2_python/io_buffering/#numpy-write-array","text":"my_file = open(filepath, mode='wb') Open file in write binary mode Write my_arr.save(my_file) \u274c Write unncesary info (type, shape) my_arr.tofile(my_file) \u2705 Always write to disk my_file.write(my_arr.tobytes()) \u2705 Only writes to disk when buffer (8KB) is full. You can force to write by calling my_file.flush() or my_file.close()","title":"Numpy Write array"},{"location":"2_python/io_buffering/#list-slicing-withot-copy-data","text":"data = b\"abcdefgh\" data_view = memoryview(data) sub_data = data_view[1:3] https://julien.danjou.info/high-performance-in-python-with-zero-copy-and-the-buffer-protocol/","title":"List Slicing withot copy data"},{"location":"2_python/ipc/","text":"https://cloudcity.io/blog/2019/02/27/things-i-wish-they-told-me-about-multiprocessing-in-python/ https://cloudcity.io/blog/2019/05/14/five-python-multiprocessing-tips-pycon-2019-video/ IPC in Python I nter P rocess C ommunication (IPC) is very improtant because process are independent (do not share memory and run in parallel). Index Shared memory -> the BAD approach Shared memory: multiprocessing.Value multiprocessing.Array multiprocessing.shared_memory : Stackoverflow answer Message passing -> the GOOD approach Socket: Unix domain socket: socket.socket(socket.AF_UNIX, socket.SOCK_STREAM) : connection based. Send consecutive bytes. socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM) : connection-less. Send independented datagrams. multiprocessing.connection.Listener('AF_UNIX') Internet socket: socket.socket(socket.AF_INET, socket.SOCK_STREAM) : Realiable (Uses TCP). socket.socket(socket.AF_INET, socket.SOCK_DGRAM) : Not realiable (Uses UDP). multiprocessing.connection.Listener('AF_INET') Pipe: multiprocessing.Pipe multiprocessing.connection.Listener('AF_PIPE') Queue: multiprocessing.Queue External libraries - Flask : Tradition web server with - zeromq : https://zeromq.org/ Remote Procedure call (RPC) Call fuctions/methods from outside. - RPyC - XML-RPC : https://docs.python.org/3/library/xmlrpc.client.html - gRPC : HTTP2 + Google protobuffers Sockets needs pickle to stringfy obj and send it - Client: `socket.send( pickle.dumps(variable) )` - Server: `data = pickle.loads( conn.recv(4096) )` Server (multiple connections) import socket import threading # Threaded function def handle_connection(conn): while True: data = conn.recv(1001) # Data is received from the conn if not data: print('No connection, Bye') # Releasing lock on exit break # DO SOMETHING WITH data # conn.send(data) # Send data back conn.close() def main(): # Create socket and listen to it. sock = socket.socket(...) # (socket.AF_INET, socket.SOCK_STREAM) sock.bind((HOST, PORT)) sock.listen(5) # Wait for connections (BLOCKING) while True: conn, addr = sock.accept() # <-- blocks here. print('Connected to :', addr[0], ':', addr[1]) client_process = Process(target=handle_connection, args=(conn)) client_process.start() sock.close() def main(): # Create socket and listen to it. sock = socket.socket(...) # (socket.AF_INET, socket.SOCK_STREAM) sock.bind((HOST, PORT)) socket.settimeout(0.1) socket.listen(1) # Wait for connections (NON BLOCKING) while True: try: conn, addr = socket.accept() print('Connected to :', addr[0], ':', addr[1]) client_process = Process(target=handle_connection, args=(conn)) client_process.start() except socket.timeout: continue sock.close() Better Sockets with Listener and Client Server (max 1 connection) from multiprocessing.connection import Listener address = ('localhost', 6000) # family is deduced to be 'AF_INET' listener = Listener(address, authkey=b'secret password') conn = listener.accept() # <--- This blocks! print 'connection accepted from', listener.last_accepted while True: msg = conn.recv() # <--- This blocks! # do something with msg if msg == 'close': conn.close() break listener.close() Server (multiple connections) from multiprocessing.connection import Listener listener = Listener(('localhost', 6000), authkey=b'secret password') running = True while running: conn = listener.accept() # <--- This blocks! print('connection accepted from', listener.last_accepted) while True: msg = conn.recv() # <--- This blocks! print(msg) if msg == 'close connection': conn.close() break if msg == 'close server': conn.close() running = False break listener.close() Client from multiprocessing.connection import Client address = ('localhost', 6000) conn = Client(address, authkey=b'secret password') conn.send('close') # can also send arbitrary objects: # conn.send(['a', 2.5, None, int, sum]) conn.close() Queues: multiprocessing.Queue Don\u2019t Share Resources, Pass Messages At first thought, it might seem like a good idea to have some sort of shared data structures that would be protected by locks. When there is only one shared structure, you can easily run into issues with blocking and contention. As such structures proliferate, however, the complexity and unexpected interactions multiply, potentially leading to deadlocks, and very likely leading to code that is difficult to maintain and test. The better option is to pass messages using multiprocessing.Queue objects. Queues should be used to pass all data between subprocesses. This leads to designs that \u201cchunkify\u201d the data into messages to be passed and handled, so that subprocesses can be more isolated and functional/task oriented. The Python Queue class is implemented on unix-like systems as a PIPE - where data that gets sent to the queue is serialized using the Python standard library pickle module. Queues are usually initialized by the main process and passed to the subprocess as part of their initialization. Source: https://cloudcity.io/blog/2019/02/27/things-i-wish-they-told-me-about-multiprocessing-in-python/ from multiprocessing import Process, Queue def f(q): q.put([42, None, 'hello']) if __name__ == '__main__': q = Queue() p = Process(target=f, args=(q,)) p.start() print(q.get()) # prints \"[42, None, 'hello']\" p.join() Pipes: from multiprocessing import Process, Pipe def f(conn): conn.send([42, None, 'hello']) conn.close() if __name__ == '__main__': parent_conn, child_conn = Pipe() p = Process(target=f, args=(child_conn,)) p.start() print(parent_conn.recv()) # prints \"[42, None, 'hello']\" p.join() Shared memory: multiprocessing.Value or multiprocessing.Array from multiprocessing import Process, Value, Array def f(n, a): n.value = 3.1415927 for i in range(len(a)): a[i] = -a[i] if __name__ == '__main__': num = Value('d', 0.0) arr = Array('i', range(10)) p = Process(target=f, args=(num, arr)) p.start() p.join() print(num.value) print(arr[:]) Example of full code ############################ import socket, pickle class VectorDB_client(): def __init__(self, ip, port): self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.connect((ip, port)) def send_py_obj(self, obj): self.sock.send( pickle.dumps(obj) ) ########################## # Threaded function # https://stackoverflow.com/questions/2915160/how-do-i-abort-a-socket-recv-from-another-thread-in-python def handle_connection(conn): while True: try: print(db) data = pickle.loads( conn.recv(4096) ) # <--- blocks print(data) if not data: print('No connection, Bye') break # Releasing lock on exit except socket.timeout: # If it was a timeout, we want to continue with recv continue except KeyboardInterrupt: break # DO SOMETHING WITH data # conn.send(data) # Send data back #socket.send( pickle.dumps(variable) ) print(f\"Closing VectorDB connection\") conn.close() if __name__ == '__main__': ############################### Parse command-line named arguments parser=argparse.ArgumentParser() parser.add_argument(\"--host\", help=\"Service host\") parser.add_argument(\"--port\", help=\"Service port\", type=int) args=parser.parse_args() ############################### Create socket server # Create socket and listen to it. sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.bind((args.host, args.port)) # INET socket needs ip and port #sock.bind(\"/tmp/socket_test.s\") # UNIX socket needs a socket file sock.settimeout(1) # 1 sec max for sock.accept() sock.listen(1) print(f\"VectorDB is listening on {args.host}:{args.port}\") # Wait for connections (NON BLOCKING) while True: try: conn, (client_ip, client_port) = sock.accept() # <--- blocks for N seconds print(f\"Connected to client: {client_ip}:{client_port}\") client_thread = threading.Thread(target=handle_connection, args=(conn,)) # <-- Comma is needed client_thread.start() except socket.timeout: #print(\"Listening again...\") continue except KeyboardInterrupt: break print(f\"Closing VectorDB server {args.host}:{args.port}\") sock.shutdown(socket.SHUT_RDWR) # closes the underlying connections sock.close() # Do signals propagate on subthreads? -> NO (YES if daemon) # # Python signal handlers are always executed in the main Python thread of the main interpreter, # even if the signal was received in another thread. # # After you send SIGINT with ^C, you will see that the main thread is killed # (no more 'Parent parenting' logs)and the child thread continues to run. # Do signals propagate on subprocess? -> YES","title":"Ipc"},{"location":"2_python/ipc/#ipc-in-python","text":"I nter P rocess C ommunication (IPC) is very improtant because process are independent (do not share memory and run in parallel).","title":"IPC in Python"},{"location":"2_python/ipc/#index","text":"","title":"Index"},{"location":"2_python/ipc/#shared-memory-the-bad-approach","text":"Shared memory: multiprocessing.Value multiprocessing.Array multiprocessing.shared_memory : Stackoverflow answer","title":"Shared memory -&gt; the BAD approach"},{"location":"2_python/ipc/#message-passing-the-good-approach","text":"Socket: Unix domain socket: socket.socket(socket.AF_UNIX, socket.SOCK_STREAM) : connection based. Send consecutive bytes. socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM) : connection-less. Send independented datagrams. multiprocessing.connection.Listener('AF_UNIX') Internet socket: socket.socket(socket.AF_INET, socket.SOCK_STREAM) : Realiable (Uses TCP). socket.socket(socket.AF_INET, socket.SOCK_DGRAM) : Not realiable (Uses UDP). multiprocessing.connection.Listener('AF_INET') Pipe: multiprocessing.Pipe multiprocessing.connection.Listener('AF_PIPE') Queue: multiprocessing.Queue External libraries - Flask : Tradition web server with - zeromq : https://zeromq.org/","title":"Message passing -&gt; the GOOD approach"},{"location":"2_python/ipc/#remote-procedure-call-rpc","text":"Call fuctions/methods from outside. - RPyC - XML-RPC : https://docs.python.org/3/library/xmlrpc.client.html - gRPC : HTTP2 + Google protobuffers","title":"Remote Procedure call (RPC)"},{"location":"2_python/ipc/#sockets","text":"needs pickle to stringfy obj and send it - Client: `socket.send( pickle.dumps(variable) )` - Server: `data = pickle.loads( conn.recv(4096) )`","title":"Sockets"},{"location":"2_python/ipc/#server-multiple-connections","text":"import socket import threading # Threaded function def handle_connection(conn): while True: data = conn.recv(1001) # Data is received from the conn if not data: print('No connection, Bye') # Releasing lock on exit break # DO SOMETHING WITH data # conn.send(data) # Send data back conn.close() def main(): # Create socket and listen to it. sock = socket.socket(...) # (socket.AF_INET, socket.SOCK_STREAM) sock.bind((HOST, PORT)) sock.listen(5) # Wait for connections (BLOCKING) while True: conn, addr = sock.accept() # <-- blocks here. print('Connected to :', addr[0], ':', addr[1]) client_process = Process(target=handle_connection, args=(conn)) client_process.start() sock.close() def main(): # Create socket and listen to it. sock = socket.socket(...) # (socket.AF_INET, socket.SOCK_STREAM) sock.bind((HOST, PORT)) socket.settimeout(0.1) socket.listen(1) # Wait for connections (NON BLOCKING) while True: try: conn, addr = socket.accept() print('Connected to :', addr[0], ':', addr[1]) client_process = Process(target=handle_connection, args=(conn)) client_process.start() except socket.timeout: continue sock.close()","title":"Server (multiple connections)"},{"location":"2_python/ipc/#better-sockets-with-listener-and-client","text":"","title":"Better Sockets with Listener and Client"},{"location":"2_python/ipc/#server-max-1-connection","text":"from multiprocessing.connection import Listener address = ('localhost', 6000) # family is deduced to be 'AF_INET' listener = Listener(address, authkey=b'secret password') conn = listener.accept() # <--- This blocks! print 'connection accepted from', listener.last_accepted while True: msg = conn.recv() # <--- This blocks! # do something with msg if msg == 'close': conn.close() break listener.close()","title":"Server (max 1 connection)"},{"location":"2_python/ipc/#server-multiple-connections_1","text":"from multiprocessing.connection import Listener listener = Listener(('localhost', 6000), authkey=b'secret password') running = True while running: conn = listener.accept() # <--- This blocks! print('connection accepted from', listener.last_accepted) while True: msg = conn.recv() # <--- This blocks! print(msg) if msg == 'close connection': conn.close() break if msg == 'close server': conn.close() running = False break listener.close()","title":"Server (multiple connections)"},{"location":"2_python/ipc/#client","text":"from multiprocessing.connection import Client address = ('localhost', 6000) conn = Client(address, authkey=b'secret password') conn.send('close') # can also send arbitrary objects: # conn.send(['a', 2.5, None, int, sum]) conn.close()","title":"Client"},{"location":"2_python/ipc/#queues-multiprocessingqueue","text":"Don\u2019t Share Resources, Pass Messages At first thought, it might seem like a good idea to have some sort of shared data structures that would be protected by locks. When there is only one shared structure, you can easily run into issues with blocking and contention. As such structures proliferate, however, the complexity and unexpected interactions multiply, potentially leading to deadlocks, and very likely leading to code that is difficult to maintain and test. The better option is to pass messages using multiprocessing.Queue objects. Queues should be used to pass all data between subprocesses. This leads to designs that \u201cchunkify\u201d the data into messages to be passed and handled, so that subprocesses can be more isolated and functional/task oriented. The Python Queue class is implemented on unix-like systems as a PIPE - where data that gets sent to the queue is serialized using the Python standard library pickle module. Queues are usually initialized by the main process and passed to the subprocess as part of their initialization. Source: https://cloudcity.io/blog/2019/02/27/things-i-wish-they-told-me-about-multiprocessing-in-python/ from multiprocessing import Process, Queue def f(q): q.put([42, None, 'hello']) if __name__ == '__main__': q = Queue() p = Process(target=f, args=(q,)) p.start() print(q.get()) # prints \"[42, None, 'hello']\" p.join()","title":"Queues: multiprocessing.Queue"},{"location":"2_python/ipc/#pipes","text":"from multiprocessing import Process, Pipe def f(conn): conn.send([42, None, 'hello']) conn.close() if __name__ == '__main__': parent_conn, child_conn = Pipe() p = Process(target=f, args=(child_conn,)) p.start() print(parent_conn.recv()) # prints \"[42, None, 'hello']\" p.join()","title":"Pipes:"},{"location":"2_python/ipc/#shared-memory-multiprocessingvalue-or-multiprocessingarray","text":"from multiprocessing import Process, Value, Array def f(n, a): n.value = 3.1415927 for i in range(len(a)): a[i] = -a[i] if __name__ == '__main__': num = Value('d', 0.0) arr = Array('i', range(10)) p = Process(target=f, args=(num, arr)) p.start() p.join() print(num.value) print(arr[:])","title":"Shared memory: multiprocessing.Value or multiprocessing.Array"},{"location":"2_python/ipc/#example-of-full-code","text":"############################ import socket, pickle class VectorDB_client(): def __init__(self, ip, port): self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.connect((ip, port)) def send_py_obj(self, obj): self.sock.send( pickle.dumps(obj) ) ########################## # Threaded function # https://stackoverflow.com/questions/2915160/how-do-i-abort-a-socket-recv-from-another-thread-in-python def handle_connection(conn): while True: try: print(db) data = pickle.loads( conn.recv(4096) ) # <--- blocks print(data) if not data: print('No connection, Bye') break # Releasing lock on exit except socket.timeout: # If it was a timeout, we want to continue with recv continue except KeyboardInterrupt: break # DO SOMETHING WITH data # conn.send(data) # Send data back #socket.send( pickle.dumps(variable) ) print(f\"Closing VectorDB connection\") conn.close() if __name__ == '__main__': ############################### Parse command-line named arguments parser=argparse.ArgumentParser() parser.add_argument(\"--host\", help=\"Service host\") parser.add_argument(\"--port\", help=\"Service port\", type=int) args=parser.parse_args() ############################### Create socket server # Create socket and listen to it. sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.bind((args.host, args.port)) # INET socket needs ip and port #sock.bind(\"/tmp/socket_test.s\") # UNIX socket needs a socket file sock.settimeout(1) # 1 sec max for sock.accept() sock.listen(1) print(f\"VectorDB is listening on {args.host}:{args.port}\") # Wait for connections (NON BLOCKING) while True: try: conn, (client_ip, client_port) = sock.accept() # <--- blocks for N seconds print(f\"Connected to client: {client_ip}:{client_port}\") client_thread = threading.Thread(target=handle_connection, args=(conn,)) # <-- Comma is needed client_thread.start() except socket.timeout: #print(\"Listening again...\") continue except KeyboardInterrupt: break print(f\"Closing VectorDB server {args.host}:{args.port}\") sock.shutdown(socket.SHUT_RDWR) # closes the underlying connections sock.close() # Do signals propagate on subthreads? -> NO (YES if daemon) # # Python signal handlers are always executed in the main Python thread of the main interpreter, # even if the signal was received in another thread. # # After you send SIGINT with ^C, you will see that the main thread is killed # (no more 'Parent parenting' logs)and the child thread continues to run. # Do signals propagate on subprocess? -> YES","title":"Example of full code"},{"location":"2_python/numpy/","text":"Write file_imgIdPerFaces = open(dest_path+'editorial_imgIdPerFaces_uint32', mode='wb') for path in tqdm(paths_editorial): np.array(img_id, dtype=\"uint32\").tofile(file_imgIds) np.load(path + \"/emb_img.npy\").tofile(file_imgEmbs) os.rename(dest_path+'editorial_imgIds_uint32', dest_path+f'editorial_imgIds_{num_total_imgs}_uint32') Read embs_creat = np.memmap(path+\"creativo_imgEmbs_1103426x512_float32\", dtype='float32', mode='r', shape=(1103426,512)) IO Redirection < > import sys, numpy sys.stdout.buffer.write(a.data) numpy.savetxt( sys.stdout.buffer, a ) https://stackoverflow.com/questions/51086704/append-numpy-matrix-to-binary-file-without-numpy-header","title":"Numpy"},{"location":"2_python/numpy/#write","text":"file_imgIdPerFaces = open(dest_path+'editorial_imgIdPerFaces_uint32', mode='wb') for path in tqdm(paths_editorial): np.array(img_id, dtype=\"uint32\").tofile(file_imgIds) np.load(path + \"/emb_img.npy\").tofile(file_imgEmbs) os.rename(dest_path+'editorial_imgIds_uint32', dest_path+f'editorial_imgIds_{num_total_imgs}_uint32')","title":"Write"},{"location":"2_python/numpy/#read","text":"embs_creat = np.memmap(path+\"creativo_imgEmbs_1103426x512_float32\", dtype='float32', mode='r', shape=(1103426,512))","title":"Read"},{"location":"2_python/numpy/#io-redirection","text":"import sys, numpy sys.stdout.buffer.write(a.data) numpy.savetxt( sys.stdout.buffer, a ) https://stackoverflow.com/questions/51086704/append-numpy-matrix-to-binary-file-without-numpy-header","title":"IO Redirection &lt; &gt;"},{"location":"2_python/parallel/","text":"IO intensive --> Concurrent --> Use Threads Python threads are only useful when functions take a long time because of IO (releases the GIL) Python threads are real system threads but parallel execution is forbidden because of GIL. Example of functions that releases the GIL: - Downloading - requesting an URL - opening a file... Python libraries that releases the GIL: - requsets - numpy - faiss - time.sleep(3) is not equivalent to a loop running for 3 seconds, burning CPU cycles while holding the GIL lock. The thread is switched away from for 3 seconds, allowing other threads to run. https://stackoverflow.com/a/61809931 http://www.dabeaz.com/python/UnderstandingGIL.pdf CPU instensive --> Parallel --> use Multiprocessing Conclusion asyncio threading multiprocessing Great for Concurrency Concurrency Parallelism _-_-_-_- _-_-_-_- ==== Great for IO intensive IO intensive CPU instensive swithing is controled by Program OS OS Access to same objects Yes Yes No, IPC is needed https://superfastpython.com/learning-paths/ from threading import Thread def worker(): \"\"\"thread worker function\"\"\" print('Worker') t = Thread(target=worker) t.start() Producer & consumer in parallel -> queue # SuperFastPython.com # example of using the queue with processes from time import sleep from random import random from multiprocessing import Process, Queue # generate work def producer(queue): print('Producer: Running', flush=True) # generate work for i in range(10): # generate a value value = random() # block sleep(value) # add to the queue queue.put(value) # all done queue.put(None) print('Producer: Done', flush=True) # consume work def consumer(queue): print('Consumer: Running', flush=True) # consume work while True: # get a unit of work item = queue.get() # check for stop if item is None: break # report print(f'>got {item}', flush=True) # all done print('Consumer: Done', flush=True) # entry point if __name__ == '__main__': # create the shared queue queue = Queue(maxsize=50) # start the consumer consumer_process = Process(target=consumer, args=(queue,)) consumer_process.start() # start the producer producer_process = Process(target=producer, args=(queue,)) producer_process.start() # wait for all processes to finish producer_process.join() consumer_process.join()","title":"Parallel"},{"location":"2_python/parallel/#io-intensive-concurrent-use-threads","text":"Python threads are only useful when functions take a long time because of IO (releases the GIL) Python threads are real system threads but parallel execution is forbidden because of GIL. Example of functions that releases the GIL: - Downloading - requesting an URL - opening a file... Python libraries that releases the GIL: - requsets - numpy - faiss - time.sleep(3) is not equivalent to a loop running for 3 seconds, burning CPU cycles while holding the GIL lock. The thread is switched away from for 3 seconds, allowing other threads to run. https://stackoverflow.com/a/61809931 http://www.dabeaz.com/python/UnderstandingGIL.pdf","title":"IO intensive --&gt; Concurrent --&gt; Use Threads"},{"location":"2_python/parallel/#cpu-instensive-parallel-use-multiprocessing","text":"","title":"CPU instensive --&gt; Parallel --&gt; use Multiprocessing"},{"location":"2_python/parallel/#conclusion","text":"asyncio threading multiprocessing Great for Concurrency Concurrency Parallelism _-_-_-_- _-_-_-_- ==== Great for IO intensive IO intensive CPU instensive swithing is controled by Program OS OS Access to same objects Yes Yes No, IPC is needed https://superfastpython.com/learning-paths/ from threading import Thread def worker(): \"\"\"thread worker function\"\"\" print('Worker') t = Thread(target=worker) t.start()","title":"Conclusion"},{"location":"2_python/parallel/#producer-consumer-in-parallel-queue","text":"# SuperFastPython.com # example of using the queue with processes from time import sleep from random import random from multiprocessing import Process, Queue # generate work def producer(queue): print('Producer: Running', flush=True) # generate work for i in range(10): # generate a value value = random() # block sleep(value) # add to the queue queue.put(value) # all done queue.put(None) print('Producer: Done', flush=True) # consume work def consumer(queue): print('Consumer: Running', flush=True) # consume work while True: # get a unit of work item = queue.get() # check for stop if item is None: break # report print(f'>got {item}', flush=True) # all done print('Consumer: Done', flush=True) # entry point if __name__ == '__main__': # create the shared queue queue = Queue(maxsize=50) # start the consumer consumer_process = Process(target=consumer, args=(queue,)) consumer_process.start() # start the producer producer_process = Process(target=producer, args=(queue,)) producer_process.start() # wait for all processes to finish producer_process.join() consumer_process.join()","title":"Producer &amp; consumer in parallel -&gt; queue"},{"location":"2_python/profiling/","text":"Profiling The lazy way: time in python: import time start = time.time() muy_fun() # Long code here print(time.time() - start) in jupyter: %time muy_fun() %timeit -r 2 -n 5 muy_fun() # -r: number of runs, -n: number of loops On the shell: $ time some_command - real : Real time. Other programs or internet connection affect. - user : User time. Amount of time spent in the CPU running user code - sys : Syestem time. Amount of time spent in the CPU running kernel code. CPU profiler There are two main types of CPU profilers: - Tracing profilers keep a record of every function call your program makes. - No son muy fiables porque acompa\u00f1an siempre al programa y esto puede interferir en el rendimiento - Sampling profilers probe your program periodically (commonly every millisecond) and record the program\u2019s stack. Here is a good intro article if you want more detail on this topic. CPU line profilers line_profiler : pip install line-profiler pprofile : pacman -S python-pprofile import time @profile def my_fun(): time.sleep(2) for i in range(3): print(\"print\") time.sleep(1) my_fun() $ kernprof -l -v program_with_my_fun.py Line # Hits Time Per Hit % Time Line Contents ============================================================== 3 @profile 4 def my_fun(): 5 1 2002083.0 2002083.0 40.0 time.sleep(2) 6 4 36.0 9.0 0.0 for i in range(3): 7 3 188.0 62.7 0.0 print(\"print\") 8 3 3002333.0 1000777.7 60.0 time.sleep(1) In jupyter %load_ext line_profiler %lprun -f func_to_profile func_to_profile(params) Memory profiler Install with pip install memory-profiler or pacamn -S python-memory-profiler @profile def my_func(): a = [1] * (10 ** 6) b = [2] * (2 * 10 ** 7) del b return a my_func() $ python -m memory_profiler mem.py Line # Mem usage Increment Line Contents ================================================ 1 38.637 MiB 38.637 MiB @profile 2 def my_func(): 3 46.090 MiB 7.453 MiB a = [1] * (10 ** 6) 4 198.715 MiB 152.625 MiB b = [2] * (2 * 10 ** 7) 5 46.270 MiB 0.000 MiB del b 6 46.270 MiB 0.000 MiB return a Memray A memory profiler for Python Magic trace magic-trace collects and displays high-resolution traces of what a process is doing","title":"Profiling"},{"location":"2_python/profiling/#profiling","text":"","title":"Profiling"},{"location":"2_python/profiling/#the-lazy-way-time","text":"in python: import time start = time.time() muy_fun() # Long code here print(time.time() - start) in jupyter: %time muy_fun() %timeit -r 2 -n 5 muy_fun() # -r: number of runs, -n: number of loops On the shell: $ time some_command - real : Real time. Other programs or internet connection affect. - user : User time. Amount of time spent in the CPU running user code - sys : Syestem time. Amount of time spent in the CPU running kernel code.","title":"The lazy way: time"},{"location":"2_python/profiling/#cpu-profiler","text":"There are two main types of CPU profilers: - Tracing profilers keep a record of every function call your program makes. - No son muy fiables porque acompa\u00f1an siempre al programa y esto puede interferir en el rendimiento - Sampling profilers probe your program periodically (commonly every millisecond) and record the program\u2019s stack. Here is a good intro article if you want more detail on this topic.","title":"CPU profiler"},{"location":"2_python/profiling/#cpu-line-profilers","text":"line_profiler : pip install line-profiler pprofile : pacman -S python-pprofile import time @profile def my_fun(): time.sleep(2) for i in range(3): print(\"print\") time.sleep(1) my_fun() $ kernprof -l -v program_with_my_fun.py Line # Hits Time Per Hit % Time Line Contents ============================================================== 3 @profile 4 def my_fun(): 5 1 2002083.0 2002083.0 40.0 time.sleep(2) 6 4 36.0 9.0 0.0 for i in range(3): 7 3 188.0 62.7 0.0 print(\"print\") 8 3 3002333.0 1000777.7 60.0 time.sleep(1) In jupyter %load_ext line_profiler %lprun -f func_to_profile func_to_profile(params)","title":"CPU line profilers"},{"location":"2_python/profiling/#memory-profiler","text":"Install with pip install memory-profiler or pacamn -S python-memory-profiler @profile def my_func(): a = [1] * (10 ** 6) b = [2] * (2 * 10 ** 7) del b return a my_func() $ python -m memory_profiler mem.py Line # Mem usage Increment Line Contents ================================================ 1 38.637 MiB 38.637 MiB @profile 2 def my_func(): 3 46.090 MiB 7.453 MiB a = [1] * (10 ** 6) 4 198.715 MiB 152.625 MiB b = [2] * (2 * 10 ** 7) 5 46.270 MiB 0.000 MiB del b 6 46.270 MiB 0.000 MiB return a","title":"Memory profiler"},{"location":"2_python/profiling/#memray","text":"A memory profiler for Python","title":"Memray"},{"location":"2_python/profiling/#magic-trace","text":"magic-trace collects and displays high-resolution traces of what a process is doing","title":"Magic trace"},{"location":"2_python/readme/","text":"Python Python script #!/usr/bin/python import sys for arg in reversed(sys.argv[1:]): print(arg)","title":"Python"},{"location":"2_python/readme/#python","text":"","title":"Python"},{"location":"2_python/readme/#python-script","text":"#!/usr/bin/python import sys for arg in reversed(sys.argv[1:]): print(arg)","title":"Python script"},{"location":"2_python/static_analisys/","text":"Static program analisis pyflakes my_program.py mypy my_program.py","title":"Static program analisis"},{"location":"2_python/static_analisys/#static-program-analisis","text":"pyflakes my_program.py mypy my_program.py","title":"Static program analisis"},{"location":"2_python/ai/Instance%20Segmentation/","text":"Instance Segmentation Instance segmentation is a challenging task, as it requires instance-level and pixel-wise predictions simultaneously. 3 categories: top-down, bottom-up, and single-stage methods. Top-down methods: detect-then-segment paradigm. Mask R-CNN family follow the Bottom-up methods: label-then-cluster problem. (learn per-pixel embeddings and then cluster them into instance groups) Singlestage instance segmentation framework on the top of onestage detectors. - YOLACT (Bolya et al. 2019) - CondInst (Tian, Shen, and Chen 2020) - SOLO (Wang et al. 2020b) Queries instance segmentation frameworks (DETR style) eliminating NMS postprocessing. - QueryInst (Fang et al. 2021) - SOLQ (Dong et al. 2021) However, they still need RoI cropping to separate different instances first, which may have the same limitations of the detect-then-segment pipeline. In this paper, we go for an end-to-end instance segmentation framework that neither relies on RoI cropping nor NMS post-processing","title":"Instance Segmentation"},{"location":"2_python/ai/Instance%20Segmentation/#instance-segmentation","text":"Instance segmentation is a challenging task, as it requires instance-level and pixel-wise predictions simultaneously. 3 categories: top-down, bottom-up, and single-stage methods. Top-down methods: detect-then-segment paradigm. Mask R-CNN family follow the Bottom-up methods: label-then-cluster problem. (learn per-pixel embeddings and then cluster them into instance groups) Singlestage instance segmentation framework on the top of onestage detectors. - YOLACT (Bolya et al. 2019) - CondInst (Tian, Shen, and Chen 2020) - SOLO (Wang et al. 2020b) Queries instance segmentation frameworks (DETR style) eliminating NMS postprocessing. - QueryInst (Fang et al. 2021) - SOLQ (Dong et al. 2021) However, they still need RoI cropping to separate different instances first, which may have the same limitations of the detect-then-segment pipeline. In this paper, we go for an end-to-end instance segmentation framework that neither relies on RoI cropping nor NMS post-processing","title":"Instance Segmentation"},{"location":"2_python/ai/deep_learning/","text":"Deep learning PRO 1. Read data from disk fast ERROR: Slow reading PIL OpenCV GOOD: Fast file reading turbojpeg: For faster VERY GOOD: Preparsear los ficheros y cargar diercamente el tensor Numpy Memmap or Torch storage FFCV Note: Buy NVMe drives and put the dataset there 2. Fast DataAug & transfoms ERROR Torchvision tranforms (based on PIL) Albumatations (based on OpenCV) GOOD Fastai agmentations (on GPU) Kornia: agmentations (on GPU) 3. Model optimizaation Quantization aware training Float16 4. Training loop optimization Composer 5. Distributed treainng (Several GPUs) Pytorch DDP : Data parallelisom DeepSpeed : : Model parallelisom FSDP References https://pytorch.org/blog/efficient-pytorch-io-library-for-large-datasets-many-files-many-gpus/ https://towardsdatascience.com/setting-a-strong-deep-learning-baseline-in-minutes-with-pytorch-c0dfe41f7d7 https://towardsdatascience.com/gpus-are-fast-datasets-are-your-bottleneck-e5ac9bf2ad27 https://towardsdatascience.com/pytorch-lightning-vs-deepspeed-vs-fsdp-vs-ffcv-vs-e0d6b2a95719 https://neptune.ai/blog/image-segmentation-tips-and-tricks-from-kaggle-competitions AVOID CUDA OUT OF MEMORY (OOM) ERROR. 5 + 1 tricks If you get a OOM error on the first batch, try... Trick Description Disadvantage 1. Smaller batch size Use Gradient Accumulation to simultate larger BS Slower training 2. Smaller input size Decrease image resolution Lower accuracy 3. Smaller model Lower accuracy 4. Half/Mixed precision Float16 instead of Float32 Lower accuracy. Training may not converge\u2026 5. Gradient checkpointing Compute some acts again instad of store them Slower training Gradient checkpointing is also known as Buffer checkpointing Gradient checkpointing reduces the model's memory cost by 60%..70% (at the cost of 25% greater training time). Extra 6th trick: Do not store the unnecesary cuda variables in the training loop. If you get a OOM error in the middle of training, you probably has an increasingly memeory leak. Delete it after the loss computation output = model(input) loss = loss_fn(output, target) del output gc.collect() Or do comoute the loss directly: loss = loss_fn(model(input), target) Operation Pytorch code GPU memory (0) Model to GPU model.cuda() model (1) Foward pass out = model(inp) model + activations + out (1) Loss func l = loss(out, tar) model + activations + out + l (1) Backward pass l.backward() model + out + l + grads (1) Optimizer step optimizer.step() model + out + l + grads + grads_mom (2) Foward pass out = model(inp) model + activations + out (2) Loss func l = loss(out, tar) model + activations + out + l (2) Backward pass l.backward() model + out + l + grads (2) Optimizer step optimizer.step() model + out + l + grads + grads_mom FAQ Why do I need to store the activations during the foward pass? Each layer with learnable parameters will need to store its input until the backward pass due to the chain rule Reference Gradient Accumulation Gradient Checkpointing 1 Gradient Checkpointing 2 Pytorch Performance Tuning Guide 7 Tips To Maximize PyTorch Performance Memory usage in Pytorch 1 Memory usage in Pytorch 2 Layer-Wise Learning Rate in PyTorch https://kozodoi.me/python/deep%20learning/pytorch/tutorial/2022/03/29/discriminative-lr.html","title":"Deep learning PRO"},{"location":"2_python/ai/deep_learning/#deep-learning-pro","text":"","title":"Deep learning PRO"},{"location":"2_python/ai/deep_learning/#1-read-data-from-disk-fast","text":"ERROR: Slow reading PIL OpenCV GOOD: Fast file reading turbojpeg: For faster VERY GOOD: Preparsear los ficheros y cargar diercamente el tensor Numpy Memmap or Torch storage FFCV Note: Buy NVMe drives and put the dataset there","title":"1. Read data from disk fast"},{"location":"2_python/ai/deep_learning/#2-fast-dataaug-transfoms","text":"ERROR Torchvision tranforms (based on PIL) Albumatations (based on OpenCV) GOOD Fastai agmentations (on GPU) Kornia: agmentations (on GPU)","title":"2. Fast DataAug &amp; transfoms"},{"location":"2_python/ai/deep_learning/#3-model-optimizaation","text":"Quantization aware training Float16","title":"3. Model optimizaation"},{"location":"2_python/ai/deep_learning/#4-training-loop-optimization","text":"Composer","title":"4. Training loop optimization"},{"location":"2_python/ai/deep_learning/#5-distributed-treainng-several-gpus","text":"Pytorch DDP : Data parallelisom DeepSpeed : : Model parallelisom FSDP","title":"5. Distributed treainng (Several GPUs)"},{"location":"2_python/ai/deep_learning/#references","text":"https://pytorch.org/blog/efficient-pytorch-io-library-for-large-datasets-many-files-many-gpus/ https://towardsdatascience.com/setting-a-strong-deep-learning-baseline-in-minutes-with-pytorch-c0dfe41f7d7 https://towardsdatascience.com/gpus-are-fast-datasets-are-your-bottleneck-e5ac9bf2ad27 https://towardsdatascience.com/pytorch-lightning-vs-deepspeed-vs-fsdp-vs-ffcv-vs-e0d6b2a95719 https://neptune.ai/blog/image-segmentation-tips-and-tricks-from-kaggle-competitions","title":"References"},{"location":"2_python/ai/deep_learning/#avoid-cuda-out-of-memory-oom-error-5-1-tricks","text":"If you get a OOM error on the first batch, try... Trick Description Disadvantage 1. Smaller batch size Use Gradient Accumulation to simultate larger BS Slower training 2. Smaller input size Decrease image resolution Lower accuracy 3. Smaller model Lower accuracy 4. Half/Mixed precision Float16 instead of Float32 Lower accuracy. Training may not converge\u2026 5. Gradient checkpointing Compute some acts again instad of store them Slower training Gradient checkpointing is also known as Buffer checkpointing Gradient checkpointing reduces the model's memory cost by 60%..70% (at the cost of 25% greater training time).","title":"AVOID CUDA OUT OF MEMORY (OOM) ERROR. 5 + 1 tricks"},{"location":"2_python/ai/deep_learning/#extra-6th-trick-do-not-store-the-unnecesary-cuda-variables-in-the-training-loop","text":"If you get a OOM error in the middle of training, you probably has an increasingly memeory leak. Delete it after the loss computation output = model(input) loss = loss_fn(output, target) del output gc.collect() Or do comoute the loss directly: loss = loss_fn(model(input), target) Operation Pytorch code GPU memory (0) Model to GPU model.cuda() model (1) Foward pass out = model(inp) model + activations + out (1) Loss func l = loss(out, tar) model + activations + out + l (1) Backward pass l.backward() model + out + l + grads (1) Optimizer step optimizer.step() model + out + l + grads + grads_mom (2) Foward pass out = model(inp) model + activations + out (2) Loss func l = loss(out, tar) model + activations + out + l (2) Backward pass l.backward() model + out + l + grads (2) Optimizer step optimizer.step() model + out + l + grads + grads_mom","title":"Extra 6th trick: Do not store the unnecesary cuda variables in the training loop."},{"location":"2_python/ai/deep_learning/#faq","text":"","title":"FAQ"},{"location":"2_python/ai/deep_learning/#why-do-i-need-to-store-the-activations-during-the-foward-pass","text":"Each layer with learnable parameters will need to store its input until the backward pass due to the chain rule","title":"Why do I need to store the activations during the foward pass?"},{"location":"2_python/ai/deep_learning/#reference","text":"Gradient Accumulation Gradient Checkpointing 1 Gradient Checkpointing 2 Pytorch Performance Tuning Guide 7 Tips To Maximize PyTorch Performance Memory usage in Pytorch 1 Memory usage in Pytorch 2","title":"Reference"},{"location":"2_python/ai/deep_learning/#layer-wise-learning-rate-in-pytorch","text":"https://kozodoi.me/python/deep%20learning/pytorch/tutorial/2022/03/29/discriminative-lr.html","title":"Layer-Wise Learning Rate in PyTorch"},{"location":"2_python/ai/onnx/","text":"import onnx # LOAD MODEL onnx_model = onnx.load(\"model.onnx\") # SAVE MODEL onnx.save(onnx_model, \"model.onnx\") # CREATE Tensors t1 = onnx.helper.make_tensor_value_info('input', onnx.TensorProto.FLOAT, [\"BS\", 3, \"H\", \"W\"]) t2 = onnx.helper.make_tensor_value_info('scalar_tensor', onnx.TensorProto.INT64, []) def get_input(model, name): for elem in model.graph.input: if elem.name == name: return elem def get_node(model, name): for elem in model.graph.node: if elem.name == name: return elem def get_output(model, name): for elem in model.graph.output: if elem.name == name: return elem","title":"Onnx"},{"location":"2_python/ai/pytorch-lightning/","text":"from pytorch_lightning.utilities.cli import LightningCLI cli = LightningCLI() fit Runs the full optimization routine. validate Perform one evaluation epoch over the validation set. test Perform one evaluation epoch over the test set. predict Run inference on your data. tune Runs routines to tune hyperparameters before training. $ python trainer.py test --trainer.limit_test_batches=10 [...] # CONFIG FILES trainer: max_epochs: 10 limit_train_batches: 100 callbacks: - class_path: pytorch_lightning.callbacks.EarlyStopping init_args: patience: 5 - class_path: pytorch_lightning.callbacks.LearningRateMonitor init_args: ... python trainer.py fit --print_config python trainer.py fit --config experiment_defaults.yaml --trainer.max_epochs 100 # python trainer.py --config config1.yaml \\ --config config2.yaml test --config config3.yaml [...] ## TRAIN # python trainer.py fit \\ # --optimizer=Adam \\ # --optimizer.lr=0.01 \\ # --lr_scheduler=ExponentialLR \\ # --lr_scheduler.gamma=0.1 \\ # --trainer.callbacks=EarlyStopping \\ # --trainer.callbacks.patience=5 \\ # --trainer.callbacks=LearningRateMonitor \\ --trainer.callbacks.logging_interval=epoch --trainer.accelerator: null --trainer.accumulate_grad_batches: 1 --trainer.amp_backend: native --trainer.amp_level: O2 --model=MyModel --model.feat_dim=64 --data=MyData python trainer.py test chpt_path=\"ypur_best_model.ckpt\" python trainer.py test --trainer.limit_test_batches=10","title":"Pytorch lightning"},{"location":"2_python/ai/pytorch-lightning/#fit-runs-the-full-optimization-routine","text":"","title":"fit         Runs the full optimization routine."},{"location":"2_python/ai/pytorch-lightning/#validate-perform-one-evaluation-epoch-over-the-validation-set","text":"","title":"validate    Perform one evaluation epoch over the validation set."},{"location":"2_python/ai/pytorch-lightning/#test-perform-one-evaluation-epoch-over-the-test-set","text":"","title":"test        Perform one evaluation epoch over the test set."},{"location":"2_python/ai/pytorch-lightning/#predict-run-inference-on-your-data","text":"","title":"predict     Run inference on your data."},{"location":"2_python/ai/pytorch-lightning/#tune-runs-routines-to-tune-hyperparameters-before-training","text":"$ python trainer.py test --trainer.limit_test_batches=10 [...]","title":"tune        Runs routines to tune hyperparameters before training."},{"location":"2_python/ai/pytorch-lightning/#config-files","text":"trainer: max_epochs: 10 limit_train_batches: 100 callbacks: - class_path: pytorch_lightning.callbacks.EarlyStopping init_args: patience: 5 - class_path: pytorch_lightning.callbacks.LearningRateMonitor init_args: ...","title":"# CONFIG FILES"},{"location":"2_python/ai/pytorch-lightning/#python-trainerpy-fit-print_config","text":"","title":"python trainer.py fit --print_config"},{"location":"2_python/ai/pytorch-lightning/#python-trainerpy-fit-config-experiment_defaultsyaml-trainermax_epochs-100","text":"# python trainer.py --config config1.yaml \\ --config config2.yaml test --config config3.yaml [...]","title":"python trainer.py fit --config experiment_defaults.yaml --trainer.max_epochs 100"},{"location":"2_python/ai/pytorch-lightning/#train","text":"# python trainer.py fit \\ # --optimizer=Adam \\ # --optimizer.lr=0.01 \\ # --lr_scheduler=ExponentialLR \\ # --lr_scheduler.gamma=0.1 \\ # --trainer.callbacks=EarlyStopping \\ # --trainer.callbacks.patience=5 \\ # --trainer.callbacks=LearningRateMonitor \\","title":"## TRAIN"},{"location":"2_python/ai/pytorch-lightning/#-trainercallbackslogging_intervalepoch","text":"","title":"--trainer.callbacks.logging_interval=epoch"},{"location":"2_python/ai/pytorch-lightning/#-traineraccelerator-null","text":"","title":"--trainer.accelerator: null"},{"location":"2_python/ai/pytorch-lightning/#-traineraccumulate_grad_batches-1","text":"","title":"--trainer.accumulate_grad_batches: 1"},{"location":"2_python/ai/pytorch-lightning/#-traineramp_backend-native","text":"","title":"--trainer.amp_backend: native"},{"location":"2_python/ai/pytorch-lightning/#-traineramp_level-o2","text":"--model=MyModel --model.feat_dim=64 --data=MyData","title":"--trainer.amp_level: O2"},{"location":"2_python/ai/pytorch-lightning/#python-trainerpy-test-chpt_pathypur_best_modelckpt","text":"","title":"python trainer.py test chpt_path=\"ypur_best_model.ckpt\""},{"location":"2_python/ai/pytorch-lightning/#python-trainerpy-test-trainerlimit_test_batches10","text":"","title":"python trainer.py test --trainer.limit_test_batches=10"},{"location":"2_python/ai/pytorch/","text":"Pytorch dataloader Naive implementatation Read batch 1 (B1) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502slow|slow| |slow| slow |unecesary\u2502 <-- No reads in parallel \u2502 CPU CORE1 \u2502read|read|...|read|Collate|copy from\u2502 <-- No queue/prefetching \u2502 Read batch 2 ... \u2502img1|img2| |imgN| |pag 2 pin\u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 <-- No queue/prefetching on GPU \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER B1 into MODEL \u2502 <-- Slow model \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 Read faster Fast hardaware Try to store your dataset in a fast storage RAM SSDs NVMe RAID SSD NVMe SSDs SATA RAID SSD SATA HDD RAID HDD SATA Other machine in local network (/mnt/media mounting point) Internet Fast decoding libjpg-turbo Using jpeg4py : jpeg.JPEG(img).decode() instead of np.array(Image.open(img)) example of usage Using Pillow>=9.0.0 source Notese que a partir de la la verion 9 de PIL, viene por defecto Comprobar que PIL usa libjpg-turbo python import PIL.features print(PIL.features.check_feature(\"libjpeg_turbo\")) Even faster: Precompute tensors and save the on disk For reading just memap, No need to decoding Numpy Memmap Torch storage FFCV Read batch 1 (B1) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502fast|fast| |fast| slow |unecesary\u2502 \u2502 CPU CORE1 \u2502read|read|...|read|Collate|copy from\u2502 \u2502 Read batch 2 ... \u2502img1|img2| |imgN| |pag 2 pin\u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER B1 into MODEL \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 Fast collate (= concat imags into batch) https://www.pankesh.com/posts/2019-05-02-pytorch-augmentation-with-libjpeg-turbo/ Read batch 1 (B1) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502fast|fast| |fast|fast|unecesary\u2502 \u2502 CPU CORE1 \u2502read|read|...|read|Coll|copy from\u2502 \u2502 Read batch 2 ... \u2502img1|img2| |imgN|ate |pag 2 pin\u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER B1 into MODEL \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 The collate_fn is also useful to discard broken images # a collate function that filters the None records. def collate_fn(batch): # batch looks like [(x0,y0), (x4,y4), (x2,y2)... ] batch = [(Id, Date, Img) for (Id, Date, Img) in batch if Img is not None] #batch = list(filter(lambda x: x is not None, batch)) # Other way to do the same if len(batch) == 0: # If all images are broken, retrun None and discard in dl for loop return None, None, None else: return torch.utils.data.dataloader.default_collate(batch) Optimization: Avoid unnecessary host copies pin_memory=True Host (CPU) data allocations are pageable by default. The GPU cannot access data directly from pageable host memory, so when a data transfer from pageable host memory to device memory is invoked, the CUDA driver must first allocate a temporary page-locked, or \u201cpinned\u201d, host array, copy the host data to the pinned array, and then transfer the data from the pinned array to device memory, as illustrated below. https://developer.nvidia.com/blog/how-optimize-data-transfers-cuda-cc/ if pin_memory=True is set on the Pytorch's dataloader, it will copy Tensors into device/CUDA pinned memory before returning them. Also, once you pin a tensor or storage, you can use asynchronous GPU copies. Just pass an additional non_blocking=True argument to a to() or a cuda() call. This can be used to overlap data transfers with computation. (Prefetching on GPU Optimization). Read batch 1 (B1) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502fast|fast| |fast|fast\u2502 \u2502 CPU CORE1 \u2502read|read|...|read|Coll\u2502 \u2502 Read batch 2 ... \u2502img1|img2| |imgN|ate \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER B1 into MODEL \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 Optimization: Read images in parallel num_workers \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE1 \u2502 Read batch 1 \u2502 \u2502 Read batch 4 \u2502 (worker1) \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u00b7 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE2 \u2502 Read batch 2 \u2502 \u00b7 \u2502 Read batch 5 \u2502 (worker2) \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u00b7 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u00b7 \u00b7 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE3 \u2502 Read batch 3 \u2502 \u00b7 \u00b7 \u2502 Read batch 6 \u2502 (worker3) \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u00b7 \u00b7 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2502B2 to GPU\u2502 \u2502B3 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER MODEL \u2502 \u2502 INFER MODEL \u2502 \u2502 INFER MODEL \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 Memory optimization Avoid to each worker make a copy of the dataset!!! https://ppwwyyxx.com/blog/2022/Demystify-RAM-Usage-in-Multiprocess-DataLoader/ Optimization: Prefetching on CPU (Queue) prefetch_factor This is the defual behavior of Pytroch's dataloader . It does prefetching on the CPU RAM. the prefetch_factor parameter of PyTorch DataLoader class. The prefetch_factor parameter only controls CPU-side loading of the parallel data loader processes \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE1 \u2502Read batch 1\u2502Read batch 4\u2502Read batch 7\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE2 \u2502Read batch 2\u2502Read batch 5\u2502 \u2502Read batch 8\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u00b7 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 CPU CORE3 \u2502Read batch 3\u2502Read batch 6\u2502 \u00b7 \u2502 Read B9 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u00b7 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2502B2 to GPU\u2502 \u2502B3 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 GPU \u2502INFER B1 into MODEL\u2502 \u2502INFER B2 into MODEL\u2502 \u2502INFER B3 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 But what are PyTorch DataLoaders really? Building a Multi-Process Data Loader from Scratch The full code for this project is available at github.com/teddykoker/tinyloader https://www.jpatrickpark.com/post/loader_sim/ Optimization: Prefetching on GPU \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE1 \u2502Read batch 1\u2502Read batch 4\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE2 \u2502Read batch 2\u2502Read batch 5\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE3 \u2502Read batch 3\u2502Read batch 6\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502B2 to GPU\u2502 \u2502B3 to GPU\u2502 \u2502B4 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502INFER B1 into MODEL\u2502INFER B2 into MODEL\u2502INFER B3 into MODEL\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 Prefetching Implementation #1: class data_prefetcher() in https://github.com/NVIDIA/apex/blob/master/examples/imagenet/main_amp.py#L265 Prefetching Implementation #2: Sacrife 1 data loader process into a prefetcher process https://www.jpatrickpark.com/post/prefetcher/ https://developer.nvidia.com/blog/how-overlap-data-transfers-cuda-cc/ Achieving overlap between data transfers and other operations requires the use of CUDA streams, so first let\u2019s learn about streams. Faster Model: TensorRT engine --into--> TorchScript module https://pytorch.org/TensorRT/ https://pytorch.org/TensorRT/_notebooks/lenet-getting-started.html https://pytorch.org/TensorRT/py_api/ts.html?highlight=embed#torch_tensorrt.ts.embed_engine_in_new_module Summary For getting fast training/inference Data reading: Use fast data staorage hardware (RAM, NVMe, RAID,...) Use fast data decoding (libjpeg-turbo for images) Even faster is you store precomted tensors and load them with either Numpy.memmap torch.Storage FFIO Dataloader Read images in parallel num_workers Avoid unnecessary host copies pin_memory=True Prefetching on CPU (CPU Queue) prefetch_factor Prefetching on GPU (GPU Queue) Model TensorRT CUDA Programming Pytorch my_stream = torch.cuda.Stream() with torch.cuda.stream(my_stream): # Send data to GPU (NO BLOCKING) data = data.cuda(non_blocking=True) # or data.to(\"cuda\", non_blocking=True) PyCUDA my_stream = cuda.Stream() # Send data to GPU (NO BLOCKING) cuda.memcpy_htod_async(dest=gpu_mem[name], src=cpu_mem[name], stream=my_stream) cuda.memcpy_dtoh_async(dest=cpu_mem[name], src=gpu_mem[name], stream=my_stream) Copy betwwnn numpy and pytorch Copy by value, Deep copy Copy by reference, Shallow copy Numpy to Pytorch torch.tensor(my_npArr) torch.from_numpy(my_npArr) Pytorch to Numpy np.array(my_tensor) my_tensor.numpy() Reference Paul Bridger Twiter , Blog Solving Machine Learning Performance Anti-Patterns: a Systematic Approach Jun, 2021 Object Detection at 2530 FPS with TensorRT and 8-Bit Quantization , Dec 2020 Horace He Twiter , Blog Making Deep Learning Go Brrrr From First Principles Mar, 2022 Another thing PyTorch 2.0 helps speed up - overhead Jan, 2023 Jungkyu Park Twiter Blog Visualizing data loaders to diagnose deep learning pipelines Apr, 2021 Data Prefetching on GPU in Deep Learning Feb, 2022 Yuxin Wu Twiter , Blog Demystify RAM Usage in Multi-Process Data Loaders Christian S. Perone https://blog.christianperone.com/2018/03/pytorch-internal-architecture-tour Building a Multi-Process Data Loader from Scratch","title":"Pytorch dataloader"},{"location":"2_python/ai/pytorch/#pytorch-dataloader","text":"","title":"Pytorch dataloader"},{"location":"2_python/ai/pytorch/#naive-implementatation","text":"Read batch 1 (B1) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502slow|slow| |slow| slow |unecesary\u2502 <-- No reads in parallel \u2502 CPU CORE1 \u2502read|read|...|read|Collate|copy from\u2502 <-- No queue/prefetching \u2502 Read batch 2 ... \u2502img1|img2| |imgN| |pag 2 pin\u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 <-- No queue/prefetching on GPU \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER B1 into MODEL \u2502 <-- Slow model \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518","title":"Naive implementatation"},{"location":"2_python/ai/pytorch/#read-faster","text":"","title":"Read faster"},{"location":"2_python/ai/pytorch/#fast-hardaware","text":"Try to store your dataset in a fast storage RAM SSDs NVMe RAID SSD NVMe SSDs SATA RAID SSD SATA HDD RAID HDD SATA Other machine in local network (/mnt/media mounting point) Internet","title":"Fast hardaware"},{"location":"2_python/ai/pytorch/#fast-decoding-libjpg-turbo","text":"Using jpeg4py : jpeg.JPEG(img).decode() instead of np.array(Image.open(img)) example of usage Using Pillow>=9.0.0 source Notese que a partir de la la verion 9 de PIL, viene por defecto Comprobar que PIL usa libjpg-turbo python import PIL.features print(PIL.features.check_feature(\"libjpeg_turbo\"))","title":"Fast decoding libjpg-turbo"},{"location":"2_python/ai/pytorch/#even-faster","text":"Precompute tensors and save the on disk For reading just memap, No need to decoding Numpy Memmap Torch storage FFCV Read batch 1 (B1) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502fast|fast| |fast| slow |unecesary\u2502 \u2502 CPU CORE1 \u2502read|read|...|read|Collate|copy from\u2502 \u2502 Read batch 2 ... \u2502img1|img2| |imgN| |pag 2 pin\u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER B1 into MODEL \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518","title":"Even faster:"},{"location":"2_python/ai/pytorch/#fast-collate-concat-imags-into-batch","text":"https://www.pankesh.com/posts/2019-05-02-pytorch-augmentation-with-libjpeg-turbo/ Read batch 1 (B1) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502fast|fast| |fast|fast|unecesary\u2502 \u2502 CPU CORE1 \u2502read|read|...|read|Coll|copy from\u2502 \u2502 Read batch 2 ... \u2502img1|img2| |imgN|ate |pag 2 pin\u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER B1 into MODEL \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 The collate_fn is also useful to discard broken images # a collate function that filters the None records. def collate_fn(batch): # batch looks like [(x0,y0), (x4,y4), (x2,y2)... ] batch = [(Id, Date, Img) for (Id, Date, Img) in batch if Img is not None] #batch = list(filter(lambda x: x is not None, batch)) # Other way to do the same if len(batch) == 0: # If all images are broken, retrun None and discard in dl for loop return None, None, None else: return torch.utils.data.dataloader.default_collate(batch)","title":"Fast collate (= concat imags into batch)"},{"location":"2_python/ai/pytorch/#optimization-avoid-unnecessary-host-copies-pin_memorytrue","text":"Host (CPU) data allocations are pageable by default. The GPU cannot access data directly from pageable host memory, so when a data transfer from pageable host memory to device memory is invoked, the CUDA driver must first allocate a temporary page-locked, or \u201cpinned\u201d, host array, copy the host data to the pinned array, and then transfer the data from the pinned array to device memory, as illustrated below. https://developer.nvidia.com/blog/how-optimize-data-transfers-cuda-cc/ if pin_memory=True is set on the Pytorch's dataloader, it will copy Tensors into device/CUDA pinned memory before returning them. Also, once you pin a tensor or storage, you can use asynchronous GPU copies. Just pass an additional non_blocking=True argument to a to() or a cuda() call. This can be used to overlap data transfers with computation. (Prefetching on GPU Optimization). Read batch 1 (B1) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502fast|fast| |fast|fast\u2502 \u2502 CPU CORE1 \u2502read|read|...|read|Coll\u2502 \u2502 Read batch 2 ... \u2502img1|img2| |imgN|ate \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER B1 into MODEL \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518","title":"Optimization: Avoid unnecessary host copies pin_memory=True"},{"location":"2_python/ai/pytorch/#optimization-read-images-in-parallel-num_workers","text":"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE1 \u2502 Read batch 1 \u2502 \u2502 Read batch 4 \u2502 (worker1) \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u00b7 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE2 \u2502 Read batch 2 \u2502 \u00b7 \u2502 Read batch 5 \u2502 (worker2) \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u00b7 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u00b7 \u00b7 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE3 \u2502 Read batch 3 \u2502 \u00b7 \u00b7 \u2502 Read batch 6 \u2502 (worker3) \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u00b7 \u00b7 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2502B2 to GPU\u2502 \u2502B3 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502 INFER MODEL \u2502 \u2502 INFER MODEL \u2502 \u2502 INFER MODEL \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518","title":"Optimization: Read images in parallel num_workers"},{"location":"2_python/ai/pytorch/#memory-optimization","text":"Avoid to each worker make a copy of the dataset!!! https://ppwwyyxx.com/blog/2022/Demystify-RAM-Usage-in-Multiprocess-DataLoader/","title":"Memory optimization"},{"location":"2_python/ai/pytorch/#optimization-prefetching-on-cpu-queue-prefetch_factor","text":"This is the defual behavior of Pytroch's dataloader . It does prefetching on the CPU RAM. the prefetch_factor parameter of PyTorch DataLoader class. The prefetch_factor parameter only controls CPU-side loading of the parallel data loader processes \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE1 \u2502Read batch 1\u2502Read batch 4\u2502Read batch 7\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE2 \u2502Read batch 2\u2502Read batch 5\u2502 \u2502Read batch 8\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u00b7 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 CPU CORE3 \u2502Read batch 3\u2502Read batch 6\u2502 \u00b7 \u2502 Read B9 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u00b7 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502 \u2502B2 to GPU\u2502 \u2502B3 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 GPU \u2502INFER B1 into MODEL\u2502 \u2502INFER B2 into MODEL\u2502 \u2502INFER B3 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 But what are PyTorch DataLoaders really? Building a Multi-Process Data Loader from Scratch The full code for this project is available at github.com/teddykoker/tinyloader https://www.jpatrickpark.com/post/loader_sim/","title":"Optimization: Prefetching on CPU (Queue) prefetch_factor"},{"location":"2_python/ai/pytorch/#optimization-prefetching-on-gpu","text":"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE1 \u2502Read batch 1\u2502Read batch 4\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE2 \u2502Read batch 2\u2502Read batch 5\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU CORE3 \u2502Read batch 3\u2502Read batch 6\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 CPU 2 GPU \u2502B1 to GPU\u2502B2 to GPU\u2502 \u2502B3 to GPU\u2502 \u2502B4 to GPU\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 GPU \u2502INFER B1 into MODEL\u2502INFER B2 into MODEL\u2502INFER B3 into MODEL\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 Prefetching Implementation #1: class data_prefetcher() in https://github.com/NVIDIA/apex/blob/master/examples/imagenet/main_amp.py#L265 Prefetching Implementation #2: Sacrife 1 data loader process into a prefetcher process https://www.jpatrickpark.com/post/prefetcher/ https://developer.nvidia.com/blog/how-overlap-data-transfers-cuda-cc/ Achieving overlap between data transfers and other operations requires the use of CUDA streams, so first let\u2019s learn about streams.","title":"Optimization: Prefetching on GPU"},{"location":"2_python/ai/pytorch/#faster-model-tensorrt-engine-into-torchscript-module","text":"https://pytorch.org/TensorRT/ https://pytorch.org/TensorRT/_notebooks/lenet-getting-started.html https://pytorch.org/TensorRT/py_api/ts.html?highlight=embed#torch_tensorrt.ts.embed_engine_in_new_module","title":"Faster Model: TensorRT engine --into--&gt; TorchScript module"},{"location":"2_python/ai/pytorch/#summary","text":"For getting fast training/inference Data reading: Use fast data staorage hardware (RAM, NVMe, RAID,...) Use fast data decoding (libjpeg-turbo for images) Even faster is you store precomted tensors and load them with either Numpy.memmap torch.Storage FFIO Dataloader Read images in parallel num_workers Avoid unnecessary host copies pin_memory=True Prefetching on CPU (CPU Queue) prefetch_factor Prefetching on GPU (GPU Queue) Model TensorRT","title":"Summary"},{"location":"2_python/ai/pytorch/#cuda-programming","text":"Pytorch my_stream = torch.cuda.Stream() with torch.cuda.stream(my_stream): # Send data to GPU (NO BLOCKING) data = data.cuda(non_blocking=True) # or data.to(\"cuda\", non_blocking=True) PyCUDA my_stream = cuda.Stream() # Send data to GPU (NO BLOCKING) cuda.memcpy_htod_async(dest=gpu_mem[name], src=cpu_mem[name], stream=my_stream) cuda.memcpy_dtoh_async(dest=cpu_mem[name], src=gpu_mem[name], stream=my_stream)","title":"CUDA Programming"},{"location":"2_python/ai/pytorch/#copy-betwwnn-numpy-and-pytorch","text":"Copy by value, Deep copy Copy by reference, Shallow copy Numpy to Pytorch torch.tensor(my_npArr) torch.from_numpy(my_npArr) Pytorch to Numpy np.array(my_tensor) my_tensor.numpy()","title":"Copy betwwnn numpy and pytorch"},{"location":"2_python/ai/pytorch/#reference","text":"Paul Bridger Twiter , Blog Solving Machine Learning Performance Anti-Patterns: a Systematic Approach Jun, 2021 Object Detection at 2530 FPS with TensorRT and 8-Bit Quantization , Dec 2020 Horace He Twiter , Blog Making Deep Learning Go Brrrr From First Principles Mar, 2022 Another thing PyTorch 2.0 helps speed up - overhead Jan, 2023 Jungkyu Park Twiter Blog Visualizing data loaders to diagnose deep learning pipelines Apr, 2021 Data Prefetching on GPU in Deep Learning Feb, 2022 Yuxin Wu Twiter , Blog Demystify RAM Usage in Multi-Process Data Loaders Christian S. Perone https://blog.christianperone.com/2018/03/pytorch-internal-architecture-tour Building a Multi-Process Data Loader from Scratch","title":"Reference"},{"location":"3_c/compilation_and_makefiles/","text":"Compilation _COMPILER_ _PROGRAM_ _GDB_ __OUTPUT__ gcc program.c -g -o program Compilation process By defoult -S generates 64bits assembly using AT&T syntax. And we want intel syntax, so -masm=intel And we want 32 bits, so -m32 gcc program.c -o program.o gcc program.cpp -o program.o _________________________________________________________________________________ / \\ / ______ \\ / / | \\ / gcc program.c -S -o program.s | AT&T | \\ ___/__ g++ program.cpp -S -o program.s | x86 | __V__ / | ----------------------------------> | asemb | objdump -S program.o / | | C/C++ | |_______| <-------------------------------- | Obj | gcc program.o -m32 -o program | file | ______ | file | ld program.o -m elf_i386 -o program | .c | gcc program.c -S -masm=intel -m32 / | nasm -f elf program.s (for linux) | .o |------------------------------------ | .cpp | g++ program.cpp -S -masm=intel -m32 | Intel | nasm -f exe program.s (for win) |______| |_______| ----------------------------------> | X86 | ---------------------------------> | asemb | | .s | objdump -S -M intel program.o |_______| <--------------------------------- .c/.cpp --------------COMPILER--------------> .s ------------ASSEMBLER----------------> .o --------------LINKER---------------> EXEC Makefile Run make . If the build seems slow, try make -j4 to use 4 threads.","title":"Compilation"},{"location":"3_c/compilation_and_makefiles/#compilation","text":"_COMPILER_ _PROGRAM_ _GDB_ __OUTPUT__ gcc program.c -g -o program","title":"Compilation"},{"location":"3_c/compilation_and_makefiles/#compilation-process","text":"By defoult -S generates 64bits assembly using AT&T syntax. And we want intel syntax, so -masm=intel And we want 32 bits, so -m32 gcc program.c -o program.o gcc program.cpp -o program.o _________________________________________________________________________________ / \\ / ______ \\ / / | \\ / gcc program.c -S -o program.s | AT&T | \\ ___/__ g++ program.cpp -S -o program.s | x86 | __V__ / | ----------------------------------> | asemb | objdump -S program.o / | | C/C++ | |_______| <-------------------------------- | Obj | gcc program.o -m32 -o program | file | ______ | file | ld program.o -m elf_i386 -o program | .c | gcc program.c -S -masm=intel -m32 / | nasm -f elf program.s (for linux) | .o |------------------------------------ | .cpp | g++ program.cpp -S -masm=intel -m32 | Intel | nasm -f exe program.s (for win) |______| |_______| ----------------------------------> | X86 | ---------------------------------> | asemb | | .s | objdump -S -M intel program.o |_______| <--------------------------------- .c/.cpp --------------COMPILER--------------> .s ------------ASSEMBLER----------------> .o --------------LINKER---------------> EXEC","title":"Compilation process"},{"location":"3_c/compilation_and_makefiles/#makefile","text":"Run make . If the build seems slow, try make -j4 to use 4 threads.","title":"Makefile"},{"location":"3_c/data_structures/","text":"Data structures Linked list https://www.youtube.com/watch?v=dti0F7w3yOQ Graph VIDEO","title":"Data structures"},{"location":"3_c/data_structures/#data-structures","text":"","title":"Data structures"},{"location":"3_c/data_structures/#linked-list","text":"https://www.youtube.com/watch?v=dti0F7w3yOQ","title":"Linked list"},{"location":"3_c/data_structures/#graph","text":"VIDEO","title":"Graph"},{"location":"3_c/debugging/","text":"C/C++ debugging gdb Debuggers Gdb [Documentation](https://www.gnu.org/software/gdb QEMU + GDB gdb-dashboard","title":"C/C++ debugging"},{"location":"3_c/debugging/#cc-debugging","text":"gdb","title":"C/C++ debugging"},{"location":"3_c/debugging/#debuggers","text":"Gdb [Documentation](https://www.gnu.org/software/gdb QEMU + GDB gdb-dashboard","title":"Debuggers"},{"location":"3_c/dynamic_memory/","text":"Memoria de un programa Est\u00e1tica: Tama\u00f1o fijo durante toda la ejecuci\u00f3n del programa text: C\u00f3digo (l\u00f3gica) del programa data: Varibles globales inicializadas bss: Varibles globales no inicializadas Autom\u00e1tica (stack): Llamadas a funciones Din\u00e1mica (heap): Memoria explicitamente alojada y desalojada malloc , free in C new , delete in C++ Allocate memory: malloc Aloja memoria del tama\u00f1o indicado y devuleve un puntero. int *p = malloc(n * sizeof(int)); Si no conces el tipo del puntero, puedes poner: int *p; p = malloc(n * sizeof(*p)); Si no se pudo alojar dicha memoria, devuelve un puntero NULL, as\u00ed que se debe controlarlo. if (p == NULL) { fprintf(stderr, \"malloc failed\\n\"); return(-1); } Desalojar memoria: free Cuando hallas acabado de usar esa memoria, la puedes liberar. free(p) malloc under the hood: brk or mmap syscall If i demand few memory probably the syscall will be brk() and memory is on the heap If i demand big memory probably the syscall will be mmap() and memory on mmap space Reference Jacob Sorber How processes get more memory. (mmap, brk) Low level learning The Origins of Process Memory","title":"Dynamic memory"},{"location":"3_c/dynamic_memory/#memoria-de-un-programa","text":"Est\u00e1tica: Tama\u00f1o fijo durante toda la ejecuci\u00f3n del programa text: C\u00f3digo (l\u00f3gica) del programa data: Varibles globales inicializadas bss: Varibles globales no inicializadas Autom\u00e1tica (stack): Llamadas a funciones Din\u00e1mica (heap): Memoria explicitamente alojada y desalojada malloc , free in C new , delete in C++","title":"Memoria de un programa"},{"location":"3_c/dynamic_memory/#allocate-memory-malloc","text":"Aloja memoria del tama\u00f1o indicado y devuleve un puntero. int *p = malloc(n * sizeof(int)); Si no conces el tipo del puntero, puedes poner: int *p; p = malloc(n * sizeof(*p)); Si no se pudo alojar dicha memoria, devuelve un puntero NULL, as\u00ed que se debe controlarlo. if (p == NULL) { fprintf(stderr, \"malloc failed\\n\"); return(-1); }","title":"Allocate memory: malloc"},{"location":"3_c/dynamic_memory/#desalojar-memoria-free","text":"Cuando hallas acabado de usar esa memoria, la puedes liberar. free(p)","title":"Desalojar memoria: free"},{"location":"3_c/dynamic_memory/#malloc-under-the-hood-brk-or-mmap-syscall","text":"If i demand few memory probably the syscall will be brk() and memory is on the heap If i demand big memory probably the syscall will be mmap() and memory on mmap space","title":"malloc under the hood: brk or mmap syscall"},{"location":"3_c/dynamic_memory/#reference","text":"Jacob Sorber How processes get more memory. (mmap, brk) Low level learning The Origins of Process Memory","title":"Reference"},{"location":"3_c/ipc/","text":"IPC in C Shared memory Shared memory segment Mutex Futex (Fast user-space locking) Semaphore Message passing Socket: Unix domain socket: socket.socket(socket.AF_UNIX, socket.SOCK_STREAM) : connection based. Send consecutive bytes. socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM) : connection-less. Send independented datagrams. Internet socket: socket.socket(socket.AF_INET, socket.SOCK_STREAM) : Realiable (Uses TCP). socket.socket(socket.AF_INET, socket.SOCK_DGRAM) : Not realiable (Uses UDP). Pipe Queue System V message queue POSIX message queue https://linasm.sourceforge.net/docs/syscalls/ipc.php System V message queue # Sys call Params Ret Description 68 MSGGET (key_t key, int msg_flags) int Creates (or connects to) a message queue 69 MSGSND Send a message to the message queue 70 MSGRCV Receive messages from the message queue 71 MSGCTL Changes permissions or closes the queue https://www.youtube.com/watch?v=sYHoKGTvA1w #include <sys/types.h> #include <sys/ipc.h> #include <sys/msg.h> // 1. Get IPC Key key_t ftok(const char *pathname, int proj_id); // 2. Get queue idenfier int msgget(key_t key, int msg_flags); int msgsnd(int msqid, const void *msg_ptr, size_t msg_sz, int msg_flg); ssize_t msgrcv(int msqid, void *msg_ptr, size_t msg_sz, long msg_typ, int msg_flg); POSIX message queue # Sys call Description 240 MQ_OPEN Open POSIX message queue 241 MQ_UNLINK Remove a message queue 242 MQ_TIMEDSEND Send a message to a message queue 243 MQ_TIMEDRECEIVE Receive a message from a message queue 244 MQ_NOTIFY Register for notification when a message is available 245 MQ_GETSETATTR Get/set message queue attributes https://www.youtube.com/watch?v=OYqX19lPb0A","title":"IPC in C"},{"location":"3_c/ipc/#ipc-in-c","text":"","title":"IPC in C"},{"location":"3_c/ipc/#shared-memory","text":"Shared memory segment Mutex Futex (Fast user-space locking) Semaphore","title":"Shared memory"},{"location":"3_c/ipc/#message-passing","text":"Socket: Unix domain socket: socket.socket(socket.AF_UNIX, socket.SOCK_STREAM) : connection based. Send consecutive bytes. socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM) : connection-less. Send independented datagrams. Internet socket: socket.socket(socket.AF_INET, socket.SOCK_STREAM) : Realiable (Uses TCP). socket.socket(socket.AF_INET, socket.SOCK_DGRAM) : Not realiable (Uses UDP). Pipe Queue System V message queue POSIX message queue https://linasm.sourceforge.net/docs/syscalls/ipc.php","title":"Message passing"},{"location":"3_c/ipc/#system-v-message-queue","text":"# Sys call Params Ret Description 68 MSGGET (key_t key, int msg_flags) int Creates (or connects to) a message queue 69 MSGSND Send a message to the message queue 70 MSGRCV Receive messages from the message queue 71 MSGCTL Changes permissions or closes the queue https://www.youtube.com/watch?v=sYHoKGTvA1w #include <sys/types.h> #include <sys/ipc.h> #include <sys/msg.h> // 1. Get IPC Key key_t ftok(const char *pathname, int proj_id); // 2. Get queue idenfier int msgget(key_t key, int msg_flags); int msgsnd(int msqid, const void *msg_ptr, size_t msg_sz, int msg_flg); ssize_t msgrcv(int msqid, void *msg_ptr, size_t msg_sz, long msg_typ, int msg_flg);","title":"System V message queue"},{"location":"3_c/ipc/#posix-message-queue","text":"# Sys call Description 240 MQ_OPEN Open POSIX message queue 241 MQ_UNLINK Remove a message queue 242 MQ_TIMEDSEND Send a message to a message queue 243 MQ_TIMEDRECEIVE Receive a message from a message queue 244 MQ_NOTIFY Register for notification when a message is available 245 MQ_GETSETATTR Get/set message queue attributes https://www.youtube.com/watch?v=OYqX19lPb0A","title":"POSIX message queue"},{"location":"3_c/pointers/","text":"Pointers ////////////////////////////// CREATING THE POINTERS Object* my_object_pointer = &my_object // Create pointer by reading the memory adress of exiting object Object* my_object_pointer = ObjectPtr(); // Create pointer by creating object int* int_pointer = NULL; // Create null pointer (C) Object* my_object_pointer = nullptr; // Create null pointer (C++) ////////////////////////////// USING THE POINTERS my_object.do_somthing() my_object->do_somthing() int_pointer++ // POINTER = POINTER + 4 bytes // sizeof(int) Pointer arithmetic https://www.youtube.com/watch?v=q24-QTbKQS8 Double pointer int16_t** audio_samples Arrays multidimensionales) double* array = malloc(M*N*sizeof(*array)); // Array (puntero) int (*array4)[NCOLUMNS] = malloc(nrows * sizeof(*array4)); // Punteros a arrays int (*array5)[NROWS][NCOLUMNS] = malloc(sizeof(*array)); // Punteros a arrays Referencia https://en.wikibooks.org/wiki/C_Programming/Common_practices#Dynamic_multidimensional_arrays http://c-faq.com/aryptr/dynmuldimary.html const in pointers There ar 2 things that can be const: the pointer itself The thing the pointer points to. char greeting[] = \"Hello\"; char* p = greeting; // non-const pointer, non-const data const char* p = greeting; // non-const pointer, const data char* const p = greeting; // const pointer, non-const data const char* const p = greeting; // const pointer, const data const char* const authorName = \"Scott Meyers\"; | ptr = &var2; | *ptr = 4; | |-------------------------|-----------------------------|--------------|-----------| | int * ptr | pointer to int | \u2705 | \u2705 | | int const * ptr | pointer to const int | \u2705 | \u274c | | int * const ptr | const pointer to int | \u274c | \u2705 | | int const * const ptr | const pointer to const int | \u274c | \u274c | https://stackoverflow.com/questions/1143262/what-is-the-difference-between-const-int-const-int-const-and-int-const","title":"Pointers"},{"location":"3_c/pointers/#pointers","text":"////////////////////////////// CREATING THE POINTERS Object* my_object_pointer = &my_object // Create pointer by reading the memory adress of exiting object Object* my_object_pointer = ObjectPtr(); // Create pointer by creating object int* int_pointer = NULL; // Create null pointer (C) Object* my_object_pointer = nullptr; // Create null pointer (C++) ////////////////////////////// USING THE POINTERS my_object.do_somthing() my_object->do_somthing() int_pointer++ // POINTER = POINTER + 4 bytes // sizeof(int)","title":"Pointers"},{"location":"3_c/pointers/#pointer-arithmetic","text":"https://www.youtube.com/watch?v=q24-QTbKQS8","title":"Pointer arithmetic"},{"location":"3_c/pointers/#double-pointer","text":"int16_t** audio_samples","title":"Double pointer"},{"location":"3_c/pointers/#arrays-multidimensionales","text":"double* array = malloc(M*N*sizeof(*array)); // Array (puntero) int (*array4)[NCOLUMNS] = malloc(nrows * sizeof(*array4)); // Punteros a arrays int (*array5)[NROWS][NCOLUMNS] = malloc(sizeof(*array)); // Punteros a arrays","title":"Arrays multidimensionales)"},{"location":"3_c/pointers/#referencia","text":"https://en.wikibooks.org/wiki/C_Programming/Common_practices#Dynamic_multidimensional_arrays http://c-faq.com/aryptr/dynmuldimary.html","title":"Referencia"},{"location":"3_c/pointers/#const-in-pointers","text":"There ar 2 things that can be const: the pointer itself The thing the pointer points to. char greeting[] = \"Hello\"; char* p = greeting; // non-const pointer, non-const data const char* p = greeting; // non-const pointer, const data char* const p = greeting; // const pointer, non-const data const char* const p = greeting; // const pointer, const data const char* const authorName = \"Scott Meyers\"; | ptr = &var2; | *ptr = 4; | |-------------------------|-----------------------------|--------------|-----------| | int * ptr | pointer to int | \u2705 | \u2705 | | int const * ptr | pointer to const int | \u2705 | \u274c | | int * const ptr | const pointer to int | \u274c | \u2705 | | int const * const ptr | const pointer to const int | \u274c | \u274c | https://stackoverflow.com/questions/1143262/what-is-the-difference-between-const-int-const-int-const-and-int-const","title":"const in pointers"},{"location":"3_c/readme/","text":"C and C++ The C Standard Library C C++ Defines Input Output #include <stdio.h> printf() , scanf() , puts() , gets() Booleans #include <stdbool.h> Memory #include <string.h> memcpy() , memset() Better ints #include <stdint.h> #include <cstdint> uint8_t , int64_t , ... std::size_t, std::vector, std::cout Other libraries Pytorch ATen (tensors on the CPU & GPU) Autograd (automatic differentiation) TensorRT OpenCV GStreamer Eigen (linear algebra) Ceres Solver OR-Tools SFML, SDL & OpenGL OpenCL WebAssembly Cython CUDA Types C and C++ types int char array Contiguos allocated in memory enum Only C++ types String Vector Contiguos allocated in memory Linked list : Sparse allocated in memory Hash table Map Integers Data Type Bytes signed Range unsigned Range char 1 int8_t : -128 to 127 uint8_t : 0 to 255 short == short int 2 int16_t : -32,768 to 32,767 uint16_t : 0 to 65,535 int 4 int32_t : -2,147,483,648 to 2,147,483,647 uint32_t : 0 to 4,294,967,295 long == long int 8 int64_t : -(2^63) to (2^63)-1 uint64_t : 0 to 18,446,744,073,709,551,615 long long == long long int 8 int64_t : -(2^63) to (2^63)-1 uint64_t : 0 to 18,446,744,073,709,551,615 Flaoting Point | float | 4 | | double | 8 | | long double | 12 | Clockwise/Spiral Rule \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502 \u256d\u2500\u256e \u2502 \u2502 ^ \u2502 \u2502 char * str[10];\u2502 str is an array of 10 pointers to chars ^ \u2502 \u2502 \u2502 \u2502 \u2570\u2500\u2500\u2500\u2500\u256f \u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f https://c-faq.com/decl/spiral.anderson.html Casting float position = static_cast (inference_count) Sizeof // C++ program to sizes of data types #include <iostream> using namespace std; int main() { cout << \"Size of char: \" << sizeof(char) << \" byte\" << endl; // 1 byte cout << \"Size of short int: \" << sizeof(short int) << \" bytes\" << endl; // 2 bytes cout << \"Size of int : \" << sizeof(int) << \" bytes\" << endl; // 4 bytes cout << \"Size of long int: \" << sizeof(long int) << \" bytes\" << endl; // 8 bytes cout << \"Size of float: \" << sizeof(float) << \" bytes\" << endl; // 4 bytes cout << \"Size of double: \" << sizeof(double) << \" bytes\" << endl; // 8 bytes cout << \"Size of wchar_t: \" << sizeof(wchar_t) << \" bytes\" << endl; // 4 bytes return 0; } User defined types ( struct , union , typedef , class , enum ) struct : Allow to store different data types sequentially in memory union : Allow to store different data types at the same location in memory // A union of pointers that points to memory for a given tensor. typedef union { int32_t* i32; int64_t* i64; float* f; TfLiteFloat16* f16; char* raw; const char* raw_const; uint8_t* uint8; bool* b; int16_t* i16; TfLiteComplex64* c64; int8_t* int8; } TfLitePtrUnion; Struct Option without typedef struct person { unsigned int isValid: 1; unsigned int age: 15; }; struct person juan; Option with typedef typedef struct { unsigned int isValid: 1; unsigned int age: 15; } person; person juan; Modifiers ( const , static , extern , ) auto Keyword to do automatic type inference. const and constexpr const double PI1 = 3.141592653589793; // constant. May be initialized at compile time or run time. constexpr double PI2 = 3.141592653589793; // compile-time constant. It shall be initialized at compile time. static In C++, a static variable within a function will hold its value across multiple runs of the function. #include <iostream> using namespace std; void func() { static int num = 1; cout << \"Value of num: \" << num << \"\\n\"; num++; } int main() { func(); // Value of num: 1 func(); // Value of num: 2 func(); // Value of num: 3 return 0; } extern atomic global alignas(8) alignas(8) const unsigned char g_model[] = { 0x1c, 0x00, 0x00, 0x00, 0x54, 0x46, 0x4c, 0x33, 0x14, 0x00, 0x20, 0x00, 0x1c, 0x00, 0x18, 0x00, 0x14, 0x00, 0x10, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x08, 0x00, 0x04, 0x00, 0x14, 0x00 } Tips & tricks Efficient loop in C int a = 10 + 1 while(--a) { // in range loop of 10 iters } References C https://en.wikibooks.org/wiki/C_Programming C++ Udacity C++ nanodegree https://www.learncpp.com Video: C++ for fun ... ctional programmers... ??? by Harald Achitz Profesor Retroman Curso 1: Programaci\u00f3n en C++ [2016-19] : Programaci\u00f3n de C++ nivel intermedio. Curso 2: C++ : Programaci\u00f3n de Videojuegos [2019/20] : Videojuego (Motor ECS) desde 0 Curso 3: C++ : Programaci\u00f3n de Videojuegos [2020/21] : Inteligencia Artificial del Videojuego Books Old C++: BOOK Effective C++ by Scott Meyers. (C++ 98) Modern C++: BOOK Effective Modern C++ by Scott Meyers. (C++ 14) Templates de c++ Cualquier charla de Scott Meyers. Profesor RetroMan (youtube channel)","title":"Readme"},{"location":"3_c/readme/#the-c-standard-library","text":"C C++ Defines Input Output #include <stdio.h> printf() , scanf() , puts() , gets() Booleans #include <stdbool.h> Memory #include <string.h> memcpy() , memset() Better ints #include <stdint.h> #include <cstdint> uint8_t , int64_t , ... std::size_t, std::vector, std::cout","title":"The C Standard Library"},{"location":"3_c/readme/#other-libraries","text":"Pytorch ATen (tensors on the CPU & GPU) Autograd (automatic differentiation) TensorRT OpenCV GStreamer Eigen (linear algebra) Ceres Solver OR-Tools SFML, SDL & OpenGL OpenCL WebAssembly Cython CUDA","title":"Other libraries"},{"location":"3_c/readme/#types","text":"C and C++ types int char array Contiguos allocated in memory enum Only C++ types String Vector Contiguos allocated in memory Linked list : Sparse allocated in memory Hash table Map","title":"Types"},{"location":"3_c/readme/#integers","text":"Data Type Bytes signed Range unsigned Range char 1 int8_t : -128 to 127 uint8_t : 0 to 255 short == short int 2 int16_t : -32,768 to 32,767 uint16_t : 0 to 65,535 int 4 int32_t : -2,147,483,648 to 2,147,483,647 uint32_t : 0 to 4,294,967,295 long == long int 8 int64_t : -(2^63) to (2^63)-1 uint64_t : 0 to 18,446,744,073,709,551,615 long long == long long int 8 int64_t : -(2^63) to (2^63)-1 uint64_t : 0 to 18,446,744,073,709,551,615","title":"Integers"},{"location":"3_c/readme/#flaoting-point","text":"| float | 4 | | double | 8 | | long double | 12 |","title":"Flaoting Point"},{"location":"3_c/readme/#clockwisespiral-rule","text":"\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502 \u256d\u2500\u256e \u2502 \u2502 ^ \u2502 \u2502 char * str[10];\u2502 str is an array of 10 pointers to chars ^ \u2502 \u2502 \u2502 \u2502 \u2570\u2500\u2500\u2500\u2500\u256f \u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f https://c-faq.com/decl/spiral.anderson.html","title":"Clockwise/Spiral Rule"},{"location":"3_c/readme/#casting","text":"float position = static_cast (inference_count)","title":"Casting"},{"location":"3_c/readme/#sizeof","text":"// C++ program to sizes of data types #include <iostream> using namespace std; int main() { cout << \"Size of char: \" << sizeof(char) << \" byte\" << endl; // 1 byte cout << \"Size of short int: \" << sizeof(short int) << \" bytes\" << endl; // 2 bytes cout << \"Size of int : \" << sizeof(int) << \" bytes\" << endl; // 4 bytes cout << \"Size of long int: \" << sizeof(long int) << \" bytes\" << endl; // 8 bytes cout << \"Size of float: \" << sizeof(float) << \" bytes\" << endl; // 4 bytes cout << \"Size of double: \" << sizeof(double) << \" bytes\" << endl; // 8 bytes cout << \"Size of wchar_t: \" << sizeof(wchar_t) << \" bytes\" << endl; // 4 bytes return 0; }","title":"Sizeof"},{"location":"3_c/readme/#user-defined-types-struct-union-typedef-class-enum","text":"struct : Allow to store different data types sequentially in memory union : Allow to store different data types at the same location in memory // A union of pointers that points to memory for a given tensor. typedef union { int32_t* i32; int64_t* i64; float* f; TfLiteFloat16* f16; char* raw; const char* raw_const; uint8_t* uint8; bool* b; int16_t* i16; TfLiteComplex64* c64; int8_t* int8; } TfLitePtrUnion;","title":"User defined types (struct, union, typedef, class, enum)"},{"location":"3_c/readme/#struct","text":"","title":"Struct"},{"location":"3_c/readme/#option-without-typedef","text":"struct person { unsigned int isValid: 1; unsigned int age: 15; }; struct person juan;","title":"Option without typedef"},{"location":"3_c/readme/#option-with-typedef","text":"typedef struct { unsigned int isValid: 1; unsigned int age: 15; } person; person juan;","title":"Option with typedef"},{"location":"3_c/readme/#modifiers-const-static-extern","text":"","title":"Modifiers (const, static, extern, )"},{"location":"3_c/readme/#auto","text":"Keyword to do automatic type inference.","title":"auto"},{"location":"3_c/readme/#const-and-constexpr","text":"const double PI1 = 3.141592653589793; // constant. May be initialized at compile time or run time. constexpr double PI2 = 3.141592653589793; // compile-time constant. It shall be initialized at compile time.","title":"const and constexpr"},{"location":"3_c/readme/#static","text":"In C++, a static variable within a function will hold its value across multiple runs of the function. #include <iostream> using namespace std; void func() { static int num = 1; cout << \"Value of num: \" << num << \"\\n\"; num++; } int main() { func(); // Value of num: 1 func(); // Value of num: 2 func(); // Value of num: 3 return 0; }","title":"static"},{"location":"3_c/readme/#extern","text":"","title":"extern"},{"location":"3_c/readme/#atomic","text":"","title":"atomic"},{"location":"3_c/readme/#global","text":"","title":"global"},{"location":"3_c/readme/#alignas8","text":"alignas(8) const unsigned char g_model[] = { 0x1c, 0x00, 0x00, 0x00, 0x54, 0x46, 0x4c, 0x33, 0x14, 0x00, 0x20, 0x00, 0x1c, 0x00, 0x18, 0x00, 0x14, 0x00, 0x10, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x08, 0x00, 0x04, 0x00, 0x14, 0x00 }","title":"alignas(8)"},{"location":"3_c/readme/#tips-tricks","text":"","title":"Tips &amp; tricks"},{"location":"3_c/readme/#efficient-loop-in-c","text":"int a = 10 + 1 while(--a) { // in range loop of 10 iters }","title":"Efficient loop in C"},{"location":"3_c/readme/#references","text":"C https://en.wikibooks.org/wiki/C_Programming C++ Udacity C++ nanodegree https://www.learncpp.com Video: C++ for fun ... ctional programmers... ??? by Harald Achitz Profesor Retroman Curso 1: Programaci\u00f3n en C++ [2016-19] : Programaci\u00f3n de C++ nivel intermedio. Curso 2: C++ : Programaci\u00f3n de Videojuegos [2019/20] : Videojuego (Motor ECS) desde 0 Curso 3: C++ : Programaci\u00f3n de Videojuegos [2020/21] : Inteligencia Artificial del Videojuego Books Old C++: BOOK Effective C++ by Scott Meyers. (C++ 98) Modern C++: BOOK Effective Modern C++ by Scott Meyers. (C++ 14) Templates de c++ Cualquier charla de Scott Meyers. Profesor RetroMan (youtube channel)","title":"References"},{"location":"3_c/syscalls/","text":"strace Is a cli tool to monitor the syscalls done by a process strace myprogram Build yout own strace https://www.youtube.com/watch?v=engduNoI6DE https://github.com/liexusong/build-strace-by-myself/blob/main/strace.c https://blog.nelhage.com/2010/08/write-yourself-an-strace-in-70-lines-of-code/ #include <sys/ptrace.h> #include <sys/reg.h> #include <sys/wait.h> #include <sys/types.h> #include <unistd.h> #include <stdlib.h> #include <stdio.h> #include <errno.h> #include <string.h> int do_child(int argc, char **argv); int do_trace(pid_t child); int main(int argc, char **argv) { if (argc < 2) { fprintf(stderr, \"Usage: %s prog args\\n\", argv[0]); exit(1); } pid_t child = fork(); if (child == 0) { // CHILD PROCESS: PROGRAM TO BE TRACED return do_child(argc-1, argv+1); } else { // PARENT (MAIN) PROCESS: SYCALLS TRACER return do_trace(child); } } int do_child(int argc, char **argv) { char *args [argc+1]; memcpy(args, argv, argc * sizeof(char*)); args[argc] = NULL; ptrace(PTRACE_TRACEME); // This process is going to be traced kill(getpid(), SIGSTOP); return execvp(args[0], args); // Execute } int do_trace(pid_t child) { int status, syscall, retval; waitpid(child, &status, 0); ptrace(PTRACE_SETOPTIONS, child, 0, PTRACE_O_TRACESYSGOOD); while(1) { if (wait_for_syscall(child) != 0) break; syscall = ptrace(PTRACE_PEEKUSER, child, sizeof(long)*ORIG_EAX); fprintf(stderr, \"syscall(%d) = \", syscall); if (wait_for_syscall(child) != 0) break; retval = ptrace(PTRACE_PEEKUSER, child, sizeof(long)*EAX); fprintf(stderr, \"%d\\n\", retval); } return 0; } int wait_for_syscall(pid_t child) { int status; while (1) { ptrace(PTRACE_SYSCALL, child, 0, 0); waitpid(child, &status, 0); if (WIFSTOPPED(status) && WSTOPSIG(status) & 0x80) return 0; if (WIFEXITED(status)) return 1; } } Appendix: Syscalls %clock Trace all system calls that read or modify system clocks. %creds Trace all system calls that read or modify user and group identifiers or capability sets. %desc Trace all file descriptor related system calls. %file Trace all system calls which take a file name as an argument. %fstat Trace fstat and fstatat syscall variants. %fstatfs Trace fstatfs, fstatfs64, fstatvfs, osf_fstatfs, and osf_fstatfs64 system calls. %ipc Trace all IPC related system calls. %lstat Trace lstat syscall variants. %memory Trace all memory mapping related system calls. %network Trace all the network related system calls. %process Trace all system calls which involve process management. %pure Trace syscalls that always succeed and have no arguments. %signal Trace all signal related system calls. %stat Trace stat syscall variants. %statfs Trace statfs, statfs64, statvfs, osf_statfs, and osf_statfs64 system calls. %%stat Trace syscalls used for requesting file status. %%statfs Trace syscalls related to file system statistics. File system File operations Directory operations Link operations Basic file attributes Extended file attributes File descriptor manipulations Read/Write Synchronized I/O Asynchronous I/O Multiplexed I/O Monitoring file events Miscellaneous Network Time Processes Signals IPC Pipe pipe pipe2 tee Shared memory shmget shmat shmctl Semaphores Futexes NUMA https://linasm.sourceforge.net/docs/syscalls/index.php # Syscall Description 0 read Read N bytes from file 1 write write N bytes at some file position (fp) 2 open Open file and get its fp 3 close Close file 4 stat 5 fstat 6 lstat 7 poll 8 lseek 9 mmap Memory map an entire file into RAM 10 mprotect 11 munmap 12 brk Change the HEAP pointer position 13 rt_sigaction 14 rt_sigprocmask 15 rt_sigreturn 16 ioctl 17 pread64 18 pwrite64 19 readv 20 writev 21 access 22 pipe 23 select 24 sched_yield 25 mremap 26 msync 27 mincore 28 madvise 29 shmget 30 shmat 31 shmctl 32 dup 33 dup2 34 pause 35 nanosleep 36 getitimer 37 alarm 38 setitimer 39 getpid 40 sendfile 41 socket 42 connect 43 accept 44 sendto 45 recvfrom 46 sendmsg 47 recvmsg 48 shutdown 49 bind 50 listen 51 getsockname 52 getpeername 53 socketpair 54 setsockopt 55 getsockopt 56 clone 57 fork 58 vfork 59 execve 60 exit 61 wait4 62 kill 63 uname 64 semget 65 semop 66 semctl 67 shmdt 68 msgget 69 msgsnd 70 msgrcv 71 msgctl 72 fcntl 73 flock 74 fsync 75 fdatasync 76 truncate 77 ftruncate 78 getdents 79 getcwd 80 chdir 81 fchdir 82 rename 83 mkdir 84 rmdir 85 creat 86 link 87 unlink 88 symlink 89 readlink 90 chmod 91 fchmod 92 chown 93 fchown 94 lchown 95 umask 96 gettimeofday 97 getrlimit 98 getrusage 99 sysinfo 100 times 101 ptrace 102 getuid 103 syslog 104 getgid 105 setuid 106 setgid 107 geteuid 108 getegid 109 setpgid 110 getppid 111 getpgrp 112 setsid 113 setreuid 114 setregid 115 getgroups 116 setgroups 117 setresuid 118 getresuid 119 setresgid 120 getresgid 121 getpgid 122 setfsuid 123 setfsgid 124 getsid 125 capget 126 capset 127 rt_sigpending 128 rt_sigtimedwait 129 rt_sigqueueinfo 130 rt_sigsuspend 131 sigaltstack 132 utime 133 mknod 134 uselib 135 personality 136 ustat 137 statfs 138 fstatfs 139 sysfs 140 getpriority 141 setpriority 142 sched_setparam 143 sched_getparam 144 sched_setscheduler 145 sched_getscheduler 146 sched_get_priority_max 147 sched_get_priority_min 148 sched_rr_get_interval 149 mlock 150 munlock 151 mlockall 152 munlockall 153 vhangup 154 modify_ldt 155 pivot_root 156 _sysctl 157 prctl 158 arch_prctl 159 adjtimex 160 setrlimit 161 chroot 162 sync 163 acct 164 settimeofday 165 mount 166 umount2 167 swapon 168 swapoff 169 reboot 170 sethostname 171 setdomainname 172 iopl 173 ioperm 174 create_module 175 init_module 176 delete_module 177 get_kernel_syms 178 query_module 179 quotactl 180 nfsservctl 181 getpmsg 182 putpmsg 183 afs_syscall 184 tuxcall 185 security 186 gettid 187 readahead 188 setxattr 189 lsetxattr 190 fsetxattr 191 getxattr 192 lgetxattr 193 fgetxattr 194 listxattr 195 llistxattr 196 flistxattr 197 removexattr 198 lremovexattr 199 fremovexattr 200 tkill 201 time 202 futex 203 sched_setaffinity 204 sched_getaffinity 205 set_thread_area 206 io_setup 207 io_destroy 208 io_getevents 209 io_submit 210 io_cancel 211 get_thread_area 212 lookup_dcookie 213 epoll_create 214 epoll_ctl_old 215 epoll_wait_old 216 remap_file_pages 217 getdents64 218 set_tid_address 219 restart_syscall 220 semtimedop 221 fadvise64 222 timer_create 223 timer_settime 224 timer_gettime 225 timer_getoverrun 226 timer_delete 227 clock_settime 228 clock_gettime 229 clock_getres 230 clock_nanosleep 231 exit_group 232 epoll_wait 233 epoll_ctl 234 tgkill 235 utimes 236 vserver 237 mbind 238 set_mempolicy 239 get_mempolicy 240 mq_open 241 mq_unlink 242 mq_timedsend 243 mq_timedreceive 244 mq_notify 245 mq_getsetattr 246 kexec_load 247 waitid 248 add_key 249 request_key 250 keyctl 251 ioprio_set 252 ioprio_get 253 inotify_init 254 inotify_add_watch 255 inotify_rm_watch 256 migrate_pages 257 openat 258 mkdirat 259 mknodat 260 fchownat 261 futimesat 262 newfstatat 263 unlinkat 264 renameat 265 linkat 266 symlinkat 267 readlinkat 268 fchmodat 269 faccessat 270 pselect6 271 ppoll 272 unshare 273 set_robust_list 274 get_robust_list 275 splice 276 tee 277 sync_file_range 278 vmsplice 279 move_pages 280 utimensat 281 epoll_pwait 282 signalfd 283 timerfd_create 284 eventfd 285 fallocate 286 timerfd_settime 287 timerfd_gettime 288 accept4 289 signalfd4 290 eventfd2 291 epoll_create1 292 dup3 293 pipe2 294 inotify_init1 295 preadv 296 pwritev 297 rt_tgsigqueueinfo 298 perf_event_open 299 recvmmsg 300 fanotify_init 301 fanotify_mark 302 prlimit64 303 name_to_handle_at 304 open_by_handle_at 305 clock_adjtime 306 syncfs 307 sendmmsg 308 setns 309 getcpu 310 process_vm_readv 311 process_vm_writev 312 kcmp 313 finit_module 314 sched_setattr 315 sched_getattr 316 renameat2 317 seccomp 318 getrandom 319 memfd_create 320 kexec_file_load 321 bpf 322 execveat 323 userfaultfd 324 membarrier 325 mlock2 326 copy_file_range 327 preadv2 328 pwritev2 329 pkey_mprotect 330 pkey_alloc 331 pkey_free 332 statx 333 io_pgetevents 334 rseq 424 pidfd_send_signal 425 io_uring_setup 426 io_uring_enter 427 io_uring_register 428 open_tree 429 move_mount 430 fsopen 431 fsconfig 432 fsmount 433 fspick 434 pidfd_open 435 clone3 436 close_range 437 openat2 438 pidfd_getfd 439 faccessat2 440 process_madvise 512 rt_sigaction 513 rt_sigreturn 514 ioctl 515 readv 516 writev 517 recvfrom 518 sendmsg 519 recvmsg 520 execve 521 ptrace 522 rt_sigpending 523 rt_sigtimedwait 524 rt_sigqueueinfo 525 sigaltstack 526 timer_create 527 mq_notify 528 kexec_load 529 waitid 530 set_robust_list 531 get_robust_list 532 vmsplice 533 move_pages 534 preadv 535 pwritev 536 rt_tgsigqueueinfo 537 recvmmsg 538 sendmmsg 539 process_vm_readv 540 process_vm_writev 541 setsockopt 542 getsockopt 543 io_setup 544 io_submit 545 execveat 546 preadv2 547 pwritev2","title":"Syscalls"},{"location":"3_c/syscalls/#strace","text":"Is a cli tool to monitor the syscalls done by a process strace myprogram","title":"strace"},{"location":"3_c/syscalls/#build-yout-own-strace","text":"https://www.youtube.com/watch?v=engduNoI6DE https://github.com/liexusong/build-strace-by-myself/blob/main/strace.c https://blog.nelhage.com/2010/08/write-yourself-an-strace-in-70-lines-of-code/ #include <sys/ptrace.h> #include <sys/reg.h> #include <sys/wait.h> #include <sys/types.h> #include <unistd.h> #include <stdlib.h> #include <stdio.h> #include <errno.h> #include <string.h> int do_child(int argc, char **argv); int do_trace(pid_t child); int main(int argc, char **argv) { if (argc < 2) { fprintf(stderr, \"Usage: %s prog args\\n\", argv[0]); exit(1); } pid_t child = fork(); if (child == 0) { // CHILD PROCESS: PROGRAM TO BE TRACED return do_child(argc-1, argv+1); } else { // PARENT (MAIN) PROCESS: SYCALLS TRACER return do_trace(child); } } int do_child(int argc, char **argv) { char *args [argc+1]; memcpy(args, argv, argc * sizeof(char*)); args[argc] = NULL; ptrace(PTRACE_TRACEME); // This process is going to be traced kill(getpid(), SIGSTOP); return execvp(args[0], args); // Execute } int do_trace(pid_t child) { int status, syscall, retval; waitpid(child, &status, 0); ptrace(PTRACE_SETOPTIONS, child, 0, PTRACE_O_TRACESYSGOOD); while(1) { if (wait_for_syscall(child) != 0) break; syscall = ptrace(PTRACE_PEEKUSER, child, sizeof(long)*ORIG_EAX); fprintf(stderr, \"syscall(%d) = \", syscall); if (wait_for_syscall(child) != 0) break; retval = ptrace(PTRACE_PEEKUSER, child, sizeof(long)*EAX); fprintf(stderr, \"%d\\n\", retval); } return 0; } int wait_for_syscall(pid_t child) { int status; while (1) { ptrace(PTRACE_SYSCALL, child, 0, 0); waitpid(child, &status, 0); if (WIFSTOPPED(status) && WSTOPSIG(status) & 0x80) return 0; if (WIFEXITED(status)) return 1; } }","title":"Build yout own strace"},{"location":"3_c/syscalls/#appendix-syscalls","text":"%clock Trace all system calls that read or modify system clocks. %creds Trace all system calls that read or modify user and group identifiers or capability sets. %desc Trace all file descriptor related system calls. %file Trace all system calls which take a file name as an argument. %fstat Trace fstat and fstatat syscall variants. %fstatfs Trace fstatfs, fstatfs64, fstatvfs, osf_fstatfs, and osf_fstatfs64 system calls. %ipc Trace all IPC related system calls. %lstat Trace lstat syscall variants. %memory Trace all memory mapping related system calls. %network Trace all the network related system calls. %process Trace all system calls which involve process management. %pure Trace syscalls that always succeed and have no arguments. %signal Trace all signal related system calls. %stat Trace stat syscall variants. %statfs Trace statfs, statfs64, statvfs, osf_statfs, and osf_statfs64 system calls. %%stat Trace syscalls used for requesting file status. %%statfs Trace syscalls related to file system statistics. File system File operations Directory operations Link operations Basic file attributes Extended file attributes File descriptor manipulations Read/Write Synchronized I/O Asynchronous I/O Multiplexed I/O Monitoring file events Miscellaneous Network Time Processes Signals IPC Pipe pipe pipe2 tee Shared memory shmget shmat shmctl Semaphores Futexes NUMA https://linasm.sourceforge.net/docs/syscalls/index.php # Syscall Description 0 read Read N bytes from file 1 write write N bytes at some file position (fp) 2 open Open file and get its fp 3 close Close file 4 stat 5 fstat 6 lstat 7 poll 8 lseek 9 mmap Memory map an entire file into RAM 10 mprotect 11 munmap 12 brk Change the HEAP pointer position 13 rt_sigaction 14 rt_sigprocmask 15 rt_sigreturn 16 ioctl 17 pread64 18 pwrite64 19 readv 20 writev 21 access 22 pipe 23 select 24 sched_yield 25 mremap 26 msync 27 mincore 28 madvise 29 shmget 30 shmat 31 shmctl 32 dup 33 dup2 34 pause 35 nanosleep 36 getitimer 37 alarm 38 setitimer 39 getpid 40 sendfile 41 socket 42 connect 43 accept 44 sendto 45 recvfrom 46 sendmsg 47 recvmsg 48 shutdown 49 bind 50 listen 51 getsockname 52 getpeername 53 socketpair 54 setsockopt 55 getsockopt 56 clone 57 fork 58 vfork 59 execve 60 exit 61 wait4 62 kill 63 uname 64 semget 65 semop 66 semctl 67 shmdt 68 msgget 69 msgsnd 70 msgrcv 71 msgctl 72 fcntl 73 flock 74 fsync 75 fdatasync 76 truncate 77 ftruncate 78 getdents 79 getcwd 80 chdir 81 fchdir 82 rename 83 mkdir 84 rmdir 85 creat 86 link 87 unlink 88 symlink 89 readlink 90 chmod 91 fchmod 92 chown 93 fchown 94 lchown 95 umask 96 gettimeofday 97 getrlimit 98 getrusage 99 sysinfo 100 times 101 ptrace 102 getuid 103 syslog 104 getgid 105 setuid 106 setgid 107 geteuid 108 getegid 109 setpgid 110 getppid 111 getpgrp 112 setsid 113 setreuid 114 setregid 115 getgroups 116 setgroups 117 setresuid 118 getresuid 119 setresgid 120 getresgid 121 getpgid 122 setfsuid 123 setfsgid 124 getsid 125 capget 126 capset 127 rt_sigpending 128 rt_sigtimedwait 129 rt_sigqueueinfo 130 rt_sigsuspend 131 sigaltstack 132 utime 133 mknod 134 uselib 135 personality 136 ustat 137 statfs 138 fstatfs 139 sysfs 140 getpriority 141 setpriority 142 sched_setparam 143 sched_getparam 144 sched_setscheduler 145 sched_getscheduler 146 sched_get_priority_max 147 sched_get_priority_min 148 sched_rr_get_interval 149 mlock 150 munlock 151 mlockall 152 munlockall 153 vhangup 154 modify_ldt 155 pivot_root 156 _sysctl 157 prctl 158 arch_prctl 159 adjtimex 160 setrlimit 161 chroot 162 sync 163 acct 164 settimeofday 165 mount 166 umount2 167 swapon 168 swapoff 169 reboot 170 sethostname 171 setdomainname 172 iopl 173 ioperm 174 create_module 175 init_module 176 delete_module 177 get_kernel_syms 178 query_module 179 quotactl 180 nfsservctl 181 getpmsg 182 putpmsg 183 afs_syscall 184 tuxcall 185 security 186 gettid 187 readahead 188 setxattr 189 lsetxattr 190 fsetxattr 191 getxattr 192 lgetxattr 193 fgetxattr 194 listxattr 195 llistxattr 196 flistxattr 197 removexattr 198 lremovexattr 199 fremovexattr 200 tkill 201 time 202 futex 203 sched_setaffinity 204 sched_getaffinity 205 set_thread_area 206 io_setup 207 io_destroy 208 io_getevents 209 io_submit 210 io_cancel 211 get_thread_area 212 lookup_dcookie 213 epoll_create 214 epoll_ctl_old 215 epoll_wait_old 216 remap_file_pages 217 getdents64 218 set_tid_address 219 restart_syscall 220 semtimedop 221 fadvise64 222 timer_create 223 timer_settime 224 timer_gettime 225 timer_getoverrun 226 timer_delete 227 clock_settime 228 clock_gettime 229 clock_getres 230 clock_nanosleep 231 exit_group 232 epoll_wait 233 epoll_ctl 234 tgkill 235 utimes 236 vserver 237 mbind 238 set_mempolicy 239 get_mempolicy 240 mq_open 241 mq_unlink 242 mq_timedsend 243 mq_timedreceive 244 mq_notify 245 mq_getsetattr 246 kexec_load 247 waitid 248 add_key 249 request_key 250 keyctl 251 ioprio_set 252 ioprio_get 253 inotify_init 254 inotify_add_watch 255 inotify_rm_watch 256 migrate_pages 257 openat 258 mkdirat 259 mknodat 260 fchownat 261 futimesat 262 newfstatat 263 unlinkat 264 renameat 265 linkat 266 symlinkat 267 readlinkat 268 fchmodat 269 faccessat 270 pselect6 271 ppoll 272 unshare 273 set_robust_list 274 get_robust_list 275 splice 276 tee 277 sync_file_range 278 vmsplice 279 move_pages 280 utimensat 281 epoll_pwait 282 signalfd 283 timerfd_create 284 eventfd 285 fallocate 286 timerfd_settime 287 timerfd_gettime 288 accept4 289 signalfd4 290 eventfd2 291 epoll_create1 292 dup3 293 pipe2 294 inotify_init1 295 preadv 296 pwritev 297 rt_tgsigqueueinfo 298 perf_event_open 299 recvmmsg 300 fanotify_init 301 fanotify_mark 302 prlimit64 303 name_to_handle_at 304 open_by_handle_at 305 clock_adjtime 306 syncfs 307 sendmmsg 308 setns 309 getcpu 310 process_vm_readv 311 process_vm_writev 312 kcmp 313 finit_module 314 sched_setattr 315 sched_getattr 316 renameat2 317 seccomp 318 getrandom 319 memfd_create 320 kexec_file_load 321 bpf 322 execveat 323 userfaultfd 324 membarrier 325 mlock2 326 copy_file_range 327 preadv2 328 pwritev2 329 pkey_mprotect 330 pkey_alloc 331 pkey_free 332 statx 333 io_pgetevents 334 rseq 424 pidfd_send_signal 425 io_uring_setup 426 io_uring_enter 427 io_uring_register 428 open_tree 429 move_mount 430 fsopen 431 fsconfig 432 fsmount 433 fspick 434 pidfd_open 435 clone3 436 close_range 437 openat2 438 pidfd_getfd 439 faccessat2 440 process_madvise 512 rt_sigaction 513 rt_sigreturn 514 ioctl 515 readv 516 writev 517 recvfrom 518 sendmsg 519 recvmsg 520 execve 521 ptrace 522 rt_sigpending 523 rt_sigtimedwait 524 rt_sigqueueinfo 525 sigaltstack 526 timer_create 527 mq_notify 528 kexec_load 529 waitid 530 set_robust_list 531 get_robust_list 532 vmsplice 533 move_pages 534 preadv 535 pwritev 536 rt_tgsigqueueinfo 537 recvmmsg 538 sendmmsg 539 process_vm_readv 540 process_vm_writev 541 setsockopt 542 getsockopt 543 io_setup 544 io_submit 545 execveat 546 preadv2 547 pwritev2","title":"Appendix: Syscalls"},{"location":"3_c/embedded%20systems/readme/","text":"Embedded systems Micocontrollers (MCUs) CPU Bits Cores Clock (MHz) Memory (SRAM) Storage (Flash) TF Others Price Arduino Uno (Rev3) AVR 8 1 16..20 2KB 32KB \u274c 20\u20ac Raspberry Pi Pico ARM Cortex-M0+ 32 2 125..133 264KB 2MB \u2705 4\u20ac Arduino Nano 33 BLE ARM Cortex-M4 32 1 64..xxx 256KB 1MB \u2705 \ud83d\udd37 17\u20ac Arduino Nano 33 BLE Sense ARM Cortex-M4 32 1 64..xxx 256KB 1MB \u2705 \ud83d\udd37\ud83c\udfa4\ud83e\udded 32\u20ac Adafruit EdgeBadge ARM Cortex-M4 32 1 120 192KB 2.5MB \u2705 31\u20ac SparkFun Edge ARM Cortex-M4 32 1 48..96 384KB 1MB \u2705 \ud83d\udd37\ud83c\udfa4\ud83e\udded 16\u20ac Espressif ESP8266 Xtensa LX106 32 1 80..160 64KB 4MB \u274c \ud83c\udf10\ud83d\udd37 2\u20ac Espressif ESP32 Xtensa LX6 32 2 160..240 520KiB 4MB \u2705 \ud83c\udf10\ud83d\udd37 3\u20ac Espressif ESP-EYE Xtensa LX6 32 2 160..240 520KiB 4MB \u2705 \ud83c\udf10\ud83d\udd37\ud83c\udfa4\ud83d\udcf7 18\u20ac Other microcontrollers STM32 Texas Instruments MSP430 TinyPico Legend \ud83c\udf10: WiFi \ud83d\udd37: Bluetooth \ud83d\udcf7: Camera \ud83c\udfa4: Microphone \ud83e\udded: Accelerometer with magnetometer Common architectures: ARM Cortex-M, RISC-V, Hexagon, Xtensa Jacob Sorber works a lot with Texas Instruments MSP430 https://wokwi.com/ https://vivonomicon.com/2019/03/30/getting-started-with-bare-metal-esp32-programming/ Single Board Computers (SBCs) Rememeber that: System on Module (SoM) + Carrier Board (CB) --------------------------- Single Board Computer (SBC) CPU Bits Cores Clock (GHz) Memory (RAM) GPU Price Raspberry Pi 1 ARM11 1176JZF-S 32 1 0.7 0.25,0.5GB VideoCore IV Raspberry Pi 2 ARMv7-A Cortex-A7 32 4 0.9 1 GB VideoCore IV Raspberry Pi 3 ARMv8-A Cortex-A53 64 4 1.4 1 GB VideoCore IV Raspberry Pi 4 ARMv8-A Cortex-A72 64 4 1.5 1,2,4,8GB VideoCore VI 40,80\u20ac Jetson Nano ARMv8-A Cortex-A57 64 4 1.43 2 GB 128CUDA cores Maxwell 77\u20ac Jetson Nano B01 ARMv8-A Cortex-A57 64 4 1.43 4 GB 128CUDA cores Maxwell 156\u20ac Coral Dev board ARMv8-A Cortex-A53 64 4 1.5 1 GB Vivante GC7000Lite 136\u20ac Coral Dev board mini ARMv8-A Cortex-A35 64 4 1.5 2 GB IMG PowerVR GE8300 110\u20ac Coral Dev board micro CPU cores GPU cores TPU cores NVDLA Power Connector Price Jetson Nano 4 ARM A57 @ 1.43GHz 128 Maxwell @ 921 MHz - - 5W / 10W 77\u20ac, 156\u20ac Jetson TX1 4 ARM A57 @ 1.73GHz 256 Maxwell @ 998MHz - - 10 W $300 Jetson TX2 4 ARM A57 @ 2GHz 256 Pascal @ 1.3 GHz - - 7.5W / 15W 500\u20ac Jetson Xavier NX 6 ARM Carmel 384 Volta 48 Volta 2 10W / 15W / 20W 260 pins SO-DIMM 430\u20ac Jetson AGX Xavier 8 ARM Carmel @ 2.26 GHz 512 Volta 64 Volta 2 10W / 15W / 30W 699 pins 750\u20ac Jetson Orin NX 8 ARM A78AE 1024 Ampere 32 Ampere 2 v2.0 10W / 15W / 25W 260 pins SO-DIMM no yet Jetson AGX Orin 12 ARM A78AE 2048 Ampere 64 Ampere 2 v2.0 15W / 30W / 50W 699 pins no yet NVDLA The NVDLA (Nvidia Deep Learning Accelerator) is an alternative to the GPU, and it can be used with minimal change in software. It is not as fast as the GPU but is extremely power efficient. So, if you need your application to run at all times and power consumption is an issue, you should try to use the DLAs. Programming IDE Compiler Emulator Uploader AVR (Arduino) Arduino IDE avr-gcc avr-dude MSP430 Energia.nu msp430-gcc mspdebug ESP32 ESP IDF esp32-gcc ESP8266 ESP IDF esp8266-gcc Raspberry Pi 2B qemu-system-aarch64 -M raspi2b Raspberry Pi 3B qemu-system-aarch64 -M raspi3b ARM64 aarch64-linux-gnu-gcc ESP IDF: Espressif IoT Development Framework Getting Started with Programming in AVR C | Attiny45 Blink LED Tutorial Main issues in Embedded systems programming Issue number 1: Memory limit Issue number 2: Power consumption 1mW -> 1 a\u00f1o con una bater\u00eda de bot\u00f3n Red neuronal -> 1mW Sensor de camara -> 10mW References Hardware https://qengineering.eu/deep-learning-with-raspberry-pi-and-alternatives.html https://qengineering.eu/computer-vision-with-raspberry-pi-and-alternatives.html https://www.fastcompression.com/blog/jetson-benchmark-comparison.htm Jacob Sorber Embedded Systems playlist Links Juanjo. Cubren RPI, Arduino y ESP32 que son mis placas de desarrollo favoritas. https://projects.raspberrypi.org/en https://docs.platformio.org/en/latest/ https://www.arduino.cc/en/Tutorial/HomePage https://arduinojson.org/book/ https://magpi.raspberrypi.org/ https://www.itead.cc/blog https://www.esploradores.com/","title":"Readme"},{"location":"3_c/embedded%20systems/readme/#micocontrollers-mcus","text":"CPU Bits Cores Clock (MHz) Memory (SRAM) Storage (Flash) TF Others Price Arduino Uno (Rev3) AVR 8 1 16..20 2KB 32KB \u274c 20\u20ac Raspberry Pi Pico ARM Cortex-M0+ 32 2 125..133 264KB 2MB \u2705 4\u20ac Arduino Nano 33 BLE ARM Cortex-M4 32 1 64..xxx 256KB 1MB \u2705 \ud83d\udd37 17\u20ac Arduino Nano 33 BLE Sense ARM Cortex-M4 32 1 64..xxx 256KB 1MB \u2705 \ud83d\udd37\ud83c\udfa4\ud83e\udded 32\u20ac Adafruit EdgeBadge ARM Cortex-M4 32 1 120 192KB 2.5MB \u2705 31\u20ac SparkFun Edge ARM Cortex-M4 32 1 48..96 384KB 1MB \u2705 \ud83d\udd37\ud83c\udfa4\ud83e\udded 16\u20ac Espressif ESP8266 Xtensa LX106 32 1 80..160 64KB 4MB \u274c \ud83c\udf10\ud83d\udd37 2\u20ac Espressif ESP32 Xtensa LX6 32 2 160..240 520KiB 4MB \u2705 \ud83c\udf10\ud83d\udd37 3\u20ac Espressif ESP-EYE Xtensa LX6 32 2 160..240 520KiB 4MB \u2705 \ud83c\udf10\ud83d\udd37\ud83c\udfa4\ud83d\udcf7 18\u20ac Other microcontrollers STM32 Texas Instruments MSP430 TinyPico Legend \ud83c\udf10: WiFi \ud83d\udd37: Bluetooth \ud83d\udcf7: Camera \ud83c\udfa4: Microphone \ud83e\udded: Accelerometer with magnetometer Common architectures: ARM Cortex-M, RISC-V, Hexagon, Xtensa Jacob Sorber works a lot with Texas Instruments MSP430 https://wokwi.com/ https://vivonomicon.com/2019/03/30/getting-started-with-bare-metal-esp32-programming/","title":"Micocontrollers (MCUs)"},{"location":"3_c/embedded%20systems/readme/#single-board-computers-sbcs","text":"Rememeber that: System on Module (SoM) + Carrier Board (CB) --------------------------- Single Board Computer (SBC) CPU Bits Cores Clock (GHz) Memory (RAM) GPU Price Raspberry Pi 1 ARM11 1176JZF-S 32 1 0.7 0.25,0.5GB VideoCore IV Raspberry Pi 2 ARMv7-A Cortex-A7 32 4 0.9 1 GB VideoCore IV Raspberry Pi 3 ARMv8-A Cortex-A53 64 4 1.4 1 GB VideoCore IV Raspberry Pi 4 ARMv8-A Cortex-A72 64 4 1.5 1,2,4,8GB VideoCore VI 40,80\u20ac Jetson Nano ARMv8-A Cortex-A57 64 4 1.43 2 GB 128CUDA cores Maxwell 77\u20ac Jetson Nano B01 ARMv8-A Cortex-A57 64 4 1.43 4 GB 128CUDA cores Maxwell 156\u20ac Coral Dev board ARMv8-A Cortex-A53 64 4 1.5 1 GB Vivante GC7000Lite 136\u20ac Coral Dev board mini ARMv8-A Cortex-A35 64 4 1.5 2 GB IMG PowerVR GE8300 110\u20ac Coral Dev board micro CPU cores GPU cores TPU cores NVDLA Power Connector Price Jetson Nano 4 ARM A57 @ 1.43GHz 128 Maxwell @ 921 MHz - - 5W / 10W 77\u20ac, 156\u20ac Jetson TX1 4 ARM A57 @ 1.73GHz 256 Maxwell @ 998MHz - - 10 W $300 Jetson TX2 4 ARM A57 @ 2GHz 256 Pascal @ 1.3 GHz - - 7.5W / 15W 500\u20ac Jetson Xavier NX 6 ARM Carmel 384 Volta 48 Volta 2 10W / 15W / 20W 260 pins SO-DIMM 430\u20ac Jetson AGX Xavier 8 ARM Carmel @ 2.26 GHz 512 Volta 64 Volta 2 10W / 15W / 30W 699 pins 750\u20ac Jetson Orin NX 8 ARM A78AE 1024 Ampere 32 Ampere 2 v2.0 10W / 15W / 25W 260 pins SO-DIMM no yet Jetson AGX Orin 12 ARM A78AE 2048 Ampere 64 Ampere 2 v2.0 15W / 30W / 50W 699 pins no yet","title":"Single Board Computers (SBCs)"},{"location":"3_c/embedded%20systems/readme/#nvdla","text":"The NVDLA (Nvidia Deep Learning Accelerator) is an alternative to the GPU, and it can be used with minimal change in software. It is not as fast as the GPU but is extremely power efficient. So, if you need your application to run at all times and power consumption is an issue, you should try to use the DLAs.","title":"NVDLA"},{"location":"3_c/embedded%20systems/readme/#programming","text":"IDE Compiler Emulator Uploader AVR (Arduino) Arduino IDE avr-gcc avr-dude MSP430 Energia.nu msp430-gcc mspdebug ESP32 ESP IDF esp32-gcc ESP8266 ESP IDF esp8266-gcc Raspberry Pi 2B qemu-system-aarch64 -M raspi2b Raspberry Pi 3B qemu-system-aarch64 -M raspi3b ARM64 aarch64-linux-gnu-gcc ESP IDF: Espressif IoT Development Framework Getting Started with Programming in AVR C | Attiny45 Blink LED Tutorial","title":"Programming"},{"location":"3_c/embedded%20systems/readme/#main-issues-in-embedded-systems-programming","text":"","title":"Main issues in Embedded systems programming"},{"location":"3_c/embedded%20systems/readme/#issue-number-1-memory-limit","text":"","title":"Issue number 1: Memory limit"},{"location":"3_c/embedded%20systems/readme/#issue-number-2-power-consumption","text":"1mW -> 1 a\u00f1o con una bater\u00eda de bot\u00f3n Red neuronal -> 1mW Sensor de camara -> 10mW","title":"Issue number 2: Power consumption"},{"location":"3_c/embedded%20systems/readme/#references","text":"Hardware https://qengineering.eu/deep-learning-with-raspberry-pi-and-alternatives.html https://qengineering.eu/computer-vision-with-raspberry-pi-and-alternatives.html https://www.fastcompression.com/blog/jetson-benchmark-comparison.htm Jacob Sorber Embedded Systems playlist Links Juanjo. Cubren RPI, Arduino y ESP32 que son mis placas de desarrollo favoritas. https://projects.raspberrypi.org/en https://docs.platformio.org/en/latest/ https://www.arduino.cc/en/Tutorial/HomePage https://arduinojson.org/book/ https://magpi.raspberrypi.org/ https://www.itead.cc/blog https://www.esploradores.com/","title":"References"},{"location":"3_c/embedded%20systems/Arduino/readme/","text":"Arduino Main functions setup() and loop() functions are called automatically by the Arduino environment Pins | | Input | Output |------------------------------- | Digital | | Analog | analogWrite(LED_BUILTIN, brightness); (PWM) To dim our built-in LED, we can use a technique called pulse width modulation (PWM). If we switch an output pin on and off extremely rapidly, the pin\u2019s output voltage becomes a factor of the ratio between time spent in the off and on states. If the pin spends 50% of the time in each state, its output voltage will be 50% of its maxi\u2010 mum. If it spends 75% in the on state and 25% in the off state, its voltage will be 75% of its maximum.","title":"Readme"},{"location":"3_c/embedded%20systems/Arduino/readme/#main-functions","text":"setup() and loop() functions are called automatically by the Arduino environment","title":"Main functions"},{"location":"3_c/embedded%20systems/Arduino/readme/#pins","text":"| | Input | Output |------------------------------- | Digital | | Analog | analogWrite(LED_BUILTIN, brightness); (PWM) To dim our built-in LED, we can use a technique called pulse width modulation (PWM). If we switch an output pin on and off extremely rapidly, the pin\u2019s output voltage becomes a factor of the ratio between time spent in the off and on states. If the pin spends 50% of the time in each state, its output voltage will be 50% of its maxi\u2010 mum. If it spends 75% in the on state and 25% in the off state, its voltage will be 75% of its maximum.","title":"Pins"},{"location":"3_c/embedded%20systems/ESP32/readme/","text":"","title":"Readme"},{"location":"3_c/embedded%20systems/Raspberry-Pi/readme/","text":"\u2518 \u250c \u2510 \u2514 \u2500 \u2502 \u251c \u2524 Raspbarry 3B (BCM2837) \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 CPU: ARMv8 RAM GPU: VideoCore IV \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 0000 0000 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502 \u2502 \u2502 \u2502 \u2502 Core 1 \u2502 \u2502 Core 2 \u2502 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502<============>\u2502 \u2502<===>\u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 \u2502 \u2502 Core 3 \u2502 \u2502 Core 4 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502QPU\u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 \u2502 3EFF FFFF \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2502 Memory-mapped I/O (MMIO) \u2502 \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502 \u2502 3F00 0000 \u2502 \u2502 \u2502 \u2502 3F00 3000 \u2502 System Timer \u2502 \u2502 \u2502 3F00 B000 \u2502 Interrupt controller \u2502 \u2502 \u2502 3F00 B880 \u2502 VideoCore mailbox \u2502 \u2502 \u2502 3F10 0000 \u2502 Power management \u2502 \u2502 \u2502 3F10 4000 \u2502 Random Number Generator \u2502 \u2502 3F20 0000 \u2502 General Purpose IO controller \u2502 \u2502 3F20 1000 \u2502 UART0 (serial port, PL011) \u2502 \u2502 3F21 5000 \u2502 UART1 (serial port, AUX mini UART) \u2502 \u2502 3F30 0000 \u2502 External Mass Media Controller (SD card reader) \u2502 \u2502 3F98 0000 \u2502 Universal Serial Bus controller \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 4096 bytes in an area known as Vertex Program Memory","title":"Readme"},{"location":"3_c/embedded%20systems/TinyML%20%28tensorflow-lite-micro%29/readme/","text":"Introduction TensorFlow Lite for Microcontrollers is written in C++ 11 and requires a 32-bit platform . It has been tested extensively with many processors based on the Arm Cortex-M Series architecture, and has been ported to other architectures including ESP32. STEP 1: Train a model Train a small TensorFlow model that can fit your target device and contains supported operations. Note if you are going to apply post-training quantization later, you can also apply quantization aware training in this step. STEP 2: Convert to TensorFlow Lite Convert to a TensorFlow Lite model using the TensorFlow Lite converter. By default, the weights and biases in a model are stored as 32-bit floating-point numbers (there is no quantization) converter = tf.lite.TFLiteConverter.from_keras_model(my_keras_model) # OPTION A converter = tf.lite.TFLiteConverter.from_saved_model(saved_model_path) # OPTION B tflite_model = converter.convert() open(\"my_model_float32.tflite\", \"wb\").write(tflite_model) # Save the model to disk Convert the model with Full integer quantization. (4x smaller, 3x+ speedup) def representative_dataset(): for i in range(500): yield([x_train[i].reshape(1, 1)]) converter.optimizations = [tf.lite.Optimize.DEFAULT] # Set the optimization flag. converter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8] converter.inference_input_type = tf.int8 converter.inference_output_type = tf.int8 converter.representative_dataset = representative_dataset # Provide a representative dataset to ensure we quantize correctly. tflite_model = converter.convert() open(\"my_model_int8.tflite\", \"wb\").write(tflite_model) # Save the model to disk 3. Convert to TensorFlow Micro Convert to a C byte array using standard tools to store it in a read-only program memory on device. MODEL_TFLITE = \"my_model_int8.tflite\" MODEL_MICRO = \"my_model_int8.cc\" # Convert to a C source file, i.e, a TensorFlow Lite for Microcontrollers model #!xxd -i my_model_int8.tflite > my_model_int8.cc !xxd -i {MODEL_TFLITE} > {MODEL_MICRO} # Update variable names REPLACE_TEXT = MODEL_TFLITE.replace('/', '_').replace('.', '_') !sed -i 's/'{REPLACE_TEXT}'/g_model/g' {MODEL_MICRO} 4. Inference on c++11 Run inference on device using the C++ library and process the results. // 1. Include the library headers #include <math.h> #include \"tensorflow/lite/micro/all_ops_resolver.h\" // provides the operations used by the interpreter to run the model. #include \"tensorflow/lite/micro/micro_error_reporter.h\" // outputs debug information. #include \"tensorflow/lite/micro/micro_interpreter.h\" // contains code to load and run models. #include \"tensorflow/lite/micro/testing/micro_test.h\" #include \"tensorflow/lite/schema/schema_generated.h\" // contains the schema for the TensorFlow Lite FlatBuffer model file format. // 2. Include the model header #include \"tensorflow/lite/micro/examples/hello_world/hello_world_model_data.h\" ////////////////////////////////////// 3. Include the unit test framework header TF_LITE_MICRO_TESTS_BEGIN TF_LITE_MICRO_TEST(LoadModelAndPerformInference) { // Define the input and the expected output float x = 0.0f; float y_true = sin(x); // Set up logging tflite::MicroErrorReporter micro_error_reporter; // Map the model into a usable data structure. This doesn't involve any // copying or parsing, it's a very lightweight operation. const tflite::Model* model = ::tflite::GetModel(g_hello_world_model_data); if (model->version() != TFLITE_SCHEMA_VERSION) { TF_LITE_REPORT_ERROR(&micro_error_reporter, \"Model provided is schema version %d not equal \" \"to supported version %d.\\n\", model->version(), TFLITE_SCHEMA_VERSION); } // This pulls in all the operation implementations we need tflite::AllOpsResolver resolver; constexpr int kTensorArenaSize = 2000; uint8_t tensor_arena[kTensorArenaSize]; // Build an interpreter to run the model with tflite::MicroInterpreter interpreter(model, resolver, tensor_arena, kTensorArenaSize, &micro_error_reporter); // Allocate memory from the tensor_arena for the model's tensors TF_LITE_MICRO_EXPECT_EQ(interpreter.AllocateTensors(), kTfLiteOk); // Obtain a pointer to the model's input tensor TfLiteTensor* input = interpreter.input(0); // Make sure the input has the properties we expect TF_LITE_MICRO_EXPECT_NE(nullptr, input); // The property \"dims\" tells us the tensor's shape. It has one element for // each dimension. Our input is a 2D tensor containing 1 element, so \"dims\" // should have size 2. TF_LITE_MICRO_EXPECT_EQ(2, input->dims->size); // The value of each element gives the length of the corresponding tensor. // We should expect two single element tensors (one is contained within the // other). TF_LITE_MICRO_EXPECT_EQ(1, input->dims->data[0]); TF_LITE_MICRO_EXPECT_EQ(1, input->dims->data[1]); // The input is an 8 bit integer value TF_LITE_MICRO_EXPECT_EQ(kTfLiteInt8, input->type); // Get the input quantization parameters float input_scale = input->params.scale; int input_zero_point = input->params.zero_point; // Quantize the input from floating-point to integer int8_t x_quantized = x / input_scale + input_zero_point; // Place the quantized input in the model's input tensor input->data.int8[0] = x_quantized; // Run the model and check that it succeeds TfLiteStatus invoke_status = interpreter.Invoke(); TF_LITE_MICRO_EXPECT_EQ(kTfLiteOk, invoke_status); // Obtain a pointer to the output tensor and make sure it has the // properties we expect. It should be the same as the input tensor. TfLiteTensor* output = interpreter.output(0); TF_LITE_MICRO_EXPECT_EQ(2, output->dims->size); TF_LITE_MICRO_EXPECT_EQ(1, output->dims->data[0]); TF_LITE_MICRO_EXPECT_EQ(1, output->dims->data[1]); TF_LITE_MICRO_EXPECT_EQ(kTfLiteInt8, output->type); // Get the output quantization parameters float output_scale = output->params.scale; int output_zero_point = output->params.zero_point; // Obtain the quantized output from model's output tensor int8_t y_pred_quantized = output->data.int8[0]; // Dequantize the output from integer to floating-point float y_pred = (y_pred_quantized - output_zero_point) * output_scale; // Check if the output is within a small range of the expected output float epsilon = 0.05f; TF_LITE_MICRO_EXPECT_NEAR(y_true, y_pred, epsilon); // Run inference on several more values and confirm the expected outputs x = 1.f; y_true = sin(x); input->data.int8[0] = x / input_scale + input_zero_point; interpreter.Invoke(); y_pred = (output->data.int8[0] - output_zero_point) * output_scale; TF_LITE_MICRO_EXPECT_NEAR(y_true, y_pred, epsilon); x = 3.f; y_true = sin(x); input->data.int8[0] = x / input_scale + input_zero_point; interpreter.Invoke(); y_pred = (output->data.int8[0] - output_zero_point) * output_scale; TF_LITE_MICRO_EXPECT_NEAR(y_true, y_pred, epsilon); x = 5.f; y_true = sin(x); input->data.int8[0] = x / input_scale + input_zero_point; interpreter.Invoke(); y_pred = (output->data.int8[0] - output_zero_point) * output_scale; TF_LITE_MICRO_EXPECT_NEAR(y_true, y_pred, epsilon); } TF_LITE_MICRO_TESTS_END Reference https://www.tensorflow.org/lite/microcontrollers/get_started_low_level https://github.com/Benja1972/TinyML_arduino","title":"Introduction"},{"location":"3_c/embedded%20systems/TinyML%20%28tensorflow-lite-micro%29/readme/#introduction","text":"TensorFlow Lite for Microcontrollers is written in C++ 11 and requires a 32-bit platform . It has been tested extensively with many processors based on the Arm Cortex-M Series architecture, and has been ported to other architectures including ESP32.","title":"Introduction"},{"location":"3_c/embedded%20systems/TinyML%20%28tensorflow-lite-micro%29/readme/#step-1-train-a-model","text":"Train a small TensorFlow model that can fit your target device and contains supported operations. Note if you are going to apply post-training quantization later, you can also apply quantization aware training in this step.","title":"STEP 1: Train a model"},{"location":"3_c/embedded%20systems/TinyML%20%28tensorflow-lite-micro%29/readme/#step-2-convert-to-tensorflow-lite","text":"Convert to a TensorFlow Lite model using the TensorFlow Lite converter. By default, the weights and biases in a model are stored as 32-bit floating-point numbers (there is no quantization) converter = tf.lite.TFLiteConverter.from_keras_model(my_keras_model) # OPTION A converter = tf.lite.TFLiteConverter.from_saved_model(saved_model_path) # OPTION B tflite_model = converter.convert() open(\"my_model_float32.tflite\", \"wb\").write(tflite_model) # Save the model to disk Convert the model with Full integer quantization. (4x smaller, 3x+ speedup) def representative_dataset(): for i in range(500): yield([x_train[i].reshape(1, 1)]) converter.optimizations = [tf.lite.Optimize.DEFAULT] # Set the optimization flag. converter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8] converter.inference_input_type = tf.int8 converter.inference_output_type = tf.int8 converter.representative_dataset = representative_dataset # Provide a representative dataset to ensure we quantize correctly. tflite_model = converter.convert() open(\"my_model_int8.tflite\", \"wb\").write(tflite_model) # Save the model to disk","title":"STEP 2: Convert to TensorFlow Lite"},{"location":"3_c/embedded%20systems/TinyML%20%28tensorflow-lite-micro%29/readme/#3-convert-to-tensorflow-micro","text":"Convert to a C byte array using standard tools to store it in a read-only program memory on device. MODEL_TFLITE = \"my_model_int8.tflite\" MODEL_MICRO = \"my_model_int8.cc\" # Convert to a C source file, i.e, a TensorFlow Lite for Microcontrollers model #!xxd -i my_model_int8.tflite > my_model_int8.cc !xxd -i {MODEL_TFLITE} > {MODEL_MICRO} # Update variable names REPLACE_TEXT = MODEL_TFLITE.replace('/', '_').replace('.', '_') !sed -i 's/'{REPLACE_TEXT}'/g_model/g' {MODEL_MICRO}","title":"3. Convert to TensorFlow Micro"},{"location":"3_c/embedded%20systems/TinyML%20%28tensorflow-lite-micro%29/readme/#4-inference-on-c11","text":"Run inference on device using the C++ library and process the results. // 1. Include the library headers #include <math.h> #include \"tensorflow/lite/micro/all_ops_resolver.h\" // provides the operations used by the interpreter to run the model. #include \"tensorflow/lite/micro/micro_error_reporter.h\" // outputs debug information. #include \"tensorflow/lite/micro/micro_interpreter.h\" // contains code to load and run models. #include \"tensorflow/lite/micro/testing/micro_test.h\" #include \"tensorflow/lite/schema/schema_generated.h\" // contains the schema for the TensorFlow Lite FlatBuffer model file format. // 2. Include the model header #include \"tensorflow/lite/micro/examples/hello_world/hello_world_model_data.h\" ////////////////////////////////////// 3. Include the unit test framework header TF_LITE_MICRO_TESTS_BEGIN TF_LITE_MICRO_TEST(LoadModelAndPerformInference) { // Define the input and the expected output float x = 0.0f; float y_true = sin(x); // Set up logging tflite::MicroErrorReporter micro_error_reporter; // Map the model into a usable data structure. This doesn't involve any // copying or parsing, it's a very lightweight operation. const tflite::Model* model = ::tflite::GetModel(g_hello_world_model_data); if (model->version() != TFLITE_SCHEMA_VERSION) { TF_LITE_REPORT_ERROR(&micro_error_reporter, \"Model provided is schema version %d not equal \" \"to supported version %d.\\n\", model->version(), TFLITE_SCHEMA_VERSION); } // This pulls in all the operation implementations we need tflite::AllOpsResolver resolver; constexpr int kTensorArenaSize = 2000; uint8_t tensor_arena[kTensorArenaSize]; // Build an interpreter to run the model with tflite::MicroInterpreter interpreter(model, resolver, tensor_arena, kTensorArenaSize, &micro_error_reporter); // Allocate memory from the tensor_arena for the model's tensors TF_LITE_MICRO_EXPECT_EQ(interpreter.AllocateTensors(), kTfLiteOk); // Obtain a pointer to the model's input tensor TfLiteTensor* input = interpreter.input(0); // Make sure the input has the properties we expect TF_LITE_MICRO_EXPECT_NE(nullptr, input); // The property \"dims\" tells us the tensor's shape. It has one element for // each dimension. Our input is a 2D tensor containing 1 element, so \"dims\" // should have size 2. TF_LITE_MICRO_EXPECT_EQ(2, input->dims->size); // The value of each element gives the length of the corresponding tensor. // We should expect two single element tensors (one is contained within the // other). TF_LITE_MICRO_EXPECT_EQ(1, input->dims->data[0]); TF_LITE_MICRO_EXPECT_EQ(1, input->dims->data[1]); // The input is an 8 bit integer value TF_LITE_MICRO_EXPECT_EQ(kTfLiteInt8, input->type); // Get the input quantization parameters float input_scale = input->params.scale; int input_zero_point = input->params.zero_point; // Quantize the input from floating-point to integer int8_t x_quantized = x / input_scale + input_zero_point; // Place the quantized input in the model's input tensor input->data.int8[0] = x_quantized; // Run the model and check that it succeeds TfLiteStatus invoke_status = interpreter.Invoke(); TF_LITE_MICRO_EXPECT_EQ(kTfLiteOk, invoke_status); // Obtain a pointer to the output tensor and make sure it has the // properties we expect. It should be the same as the input tensor. TfLiteTensor* output = interpreter.output(0); TF_LITE_MICRO_EXPECT_EQ(2, output->dims->size); TF_LITE_MICRO_EXPECT_EQ(1, output->dims->data[0]); TF_LITE_MICRO_EXPECT_EQ(1, output->dims->data[1]); TF_LITE_MICRO_EXPECT_EQ(kTfLiteInt8, output->type); // Get the output quantization parameters float output_scale = output->params.scale; int output_zero_point = output->params.zero_point; // Obtain the quantized output from model's output tensor int8_t y_pred_quantized = output->data.int8[0]; // Dequantize the output from integer to floating-point float y_pred = (y_pred_quantized - output_zero_point) * output_scale; // Check if the output is within a small range of the expected output float epsilon = 0.05f; TF_LITE_MICRO_EXPECT_NEAR(y_true, y_pred, epsilon); // Run inference on several more values and confirm the expected outputs x = 1.f; y_true = sin(x); input->data.int8[0] = x / input_scale + input_zero_point; interpreter.Invoke(); y_pred = (output->data.int8[0] - output_zero_point) * output_scale; TF_LITE_MICRO_EXPECT_NEAR(y_true, y_pred, epsilon); x = 3.f; y_true = sin(x); input->data.int8[0] = x / input_scale + input_zero_point; interpreter.Invoke(); y_pred = (output->data.int8[0] - output_zero_point) * output_scale; TF_LITE_MICRO_EXPECT_NEAR(y_true, y_pred, epsilon); x = 5.f; y_true = sin(x); input->data.int8[0] = x / input_scale + input_zero_point; interpreter.Invoke(); y_pred = (output->data.int8[0] - output_zero_point) * output_scale; TF_LITE_MICRO_EXPECT_NEAR(y_true, y_pred, epsilon); } TF_LITE_MICRO_TESTS_END","title":"4. Inference on c++11"},{"location":"3_c/embedded%20systems/TinyML%20%28tensorflow-lite-micro%29/readme/#reference","text":"https://www.tensorflow.org/lite/microcontrollers/get_started_low_level https://github.com/Benja1972/TinyML_arduino","title":"Reference"},{"location":"3_c/embedded%20systems/custom%20PCB/readme/","text":"Custom PCB You not use Arduino (or other development board) as a final product. You need something more compact and solid to use in production. Thats the motivation to design your own PCB (Printed Circuit Board). Steps Pick up the program gEDA : es una suite de programas de c\u00f3digo abierto para el dise\u00f1o de esquemas el\u00e9ctricos y circuitos impresos. gschem : un editor gr\u00e1fico para el dise\u00f1o de los esquemas el\u00e9ctricos; pcb : la herramienta para el enrutamiento de las pistas y para el dise\u00f1o del circuito impreso; gerbv : un visor para analizar los archivos de producci\u00f3n (standard gerber); xgsch2pcb : una interfaz gr\u00e1fica para la gesti\u00f3n de los proyectos; Icarus y gtkwave : dos programas para llevar a cabo simulaciones sobre circuitos y visualizar los resultados. Eagle : Similar to gEDA. free or cheap $ (Used by Jacob Sorber) Eagle tutorials on sparkfun La versi\u00f3n gratuita tiene un \u00e1rea de trabajo limitada a 10 x 15 cm. KiCad : Open source (Used by @info_libertas) Fritzing : un programa de c\u00f3digo abierto muy intuitivo con el cual es posible trabajar en placas de prueba, esquemas el\u00e9ctricos y dise\u00f1os finales. 123D Circuits : es un programa de Autodesk que se utiliza online para dise\u00f1ar y simular circuitos. Altium : $$$ expensive EasyEDA : Design the schematic Here you define the logic and connectivity of your circuit. Design the layout Here you design the actual shape, size and paths of your circuit. Export to a known format El formato est\u00e1ndar que aceptan las f\u00e1bricas es el Gerber (se ven con: gerbv, kicad, etc.) Pick up the manufacter and order your PCB JLCPCB (Used by @info_libertas) PCBWay (Used by @info_libertas) They have open source projects: http://pcbway.com/project NextPCB (sponsored by Jacob Sorber) Assamble your PCB with some SMDs (Soldar los chips a la placa) @info_libertas: JBC CD-2SB + andonstar ADSM 201 (ambos descatalogados, ahora habr\u00e1 mejores) + flux + trenza + paciencia Glosary PCB : P rinted C ircuit B oard SMD : S urface- M ount D evice (Chips you connect on top of the PCB) PCB + SMDs = Finished board Reference Video of Jacob Sorber Tweet of @info_libertas","title":"Readme"},{"location":"3_c/embedded%20systems/custom%20PCB/readme/#steps","text":"Pick up the program gEDA : es una suite de programas de c\u00f3digo abierto para el dise\u00f1o de esquemas el\u00e9ctricos y circuitos impresos. gschem : un editor gr\u00e1fico para el dise\u00f1o de los esquemas el\u00e9ctricos; pcb : la herramienta para el enrutamiento de las pistas y para el dise\u00f1o del circuito impreso; gerbv : un visor para analizar los archivos de producci\u00f3n (standard gerber); xgsch2pcb : una interfaz gr\u00e1fica para la gesti\u00f3n de los proyectos; Icarus y gtkwave : dos programas para llevar a cabo simulaciones sobre circuitos y visualizar los resultados. Eagle : Similar to gEDA. free or cheap $ (Used by Jacob Sorber) Eagle tutorials on sparkfun La versi\u00f3n gratuita tiene un \u00e1rea de trabajo limitada a 10 x 15 cm. KiCad : Open source (Used by @info_libertas) Fritzing : un programa de c\u00f3digo abierto muy intuitivo con el cual es posible trabajar en placas de prueba, esquemas el\u00e9ctricos y dise\u00f1os finales. 123D Circuits : es un programa de Autodesk que se utiliza online para dise\u00f1ar y simular circuitos. Altium : $$$ expensive EasyEDA : Design the schematic Here you define the logic and connectivity of your circuit. Design the layout Here you design the actual shape, size and paths of your circuit. Export to a known format El formato est\u00e1ndar que aceptan las f\u00e1bricas es el Gerber (se ven con: gerbv, kicad, etc.) Pick up the manufacter and order your PCB JLCPCB (Used by @info_libertas) PCBWay (Used by @info_libertas) They have open source projects: http://pcbway.com/project NextPCB (sponsored by Jacob Sorber) Assamble your PCB with some SMDs (Soldar los chips a la placa) @info_libertas: JBC CD-2SB + andonstar ADSM 201 (ambos descatalogados, ahora habr\u00e1 mejores) + flux + trenza + paciencia","title":"Steps"},{"location":"3_c/embedded%20systems/custom%20PCB/readme/#glosary","text":"PCB : P rinted C ircuit B oard SMD : S urface- M ount D evice (Chips you connect on top of the PCB) PCB + SMDs = Finished board","title":"Glosary"},{"location":"3_c/embedded%20systems/custom%20PCB/readme/#reference","text":"Video of Jacob Sorber Tweet of @info_libertas","title":"Reference"},{"location":"3_c/embedded%20systems/sensors/readme/","text":"Sensors Current 5V como de 3.3V. Si tu Arduino es de 5V no deber\u00eda tener ning\u00fan problema para leer la se\u00f1al de senbsores de 3.3V, ya cualquier tensi\u00f3n que sobre pase 2.5V es le\u00eddo como HIGH en Arduino. Kalman filter Image Stereo Visi\u00f3n nocturna Ultrawide With autofocus Multisctrum Thermal Imaging Sound Microphone Velocity Radar sensors using the doppler effect Distance Returns an analog value with the distance. | | Ultrasonic (sonar) | IR triangulation | LiDAR | ToF (Time of Flight) | Radar |-----------------------------|-----------------------------------------|-------------- | Emits and recives | High-frequency sound | Infrared light | UV light | | Detects tranparent surfaces | yes \ud83d\ude42 | No \ud83d\ude41 | No \ud83d\ude41 | | Safe for human eyes | yes \ud83d\ude42 | | No \ud83d\ude41 | | Invariant to dust | yes \ud83d\ude42 | Invariant to temperature | yes \ud83d\ude42 | Invariant to light | yes \ud83d\ude42 | Max range | ~10m | | Application | Slow & near objects | https://www.terabee.com/choosing-right-distance-sensor-your-application/ Technology Sensor Range Angle Voltage Current Price Ultrasound HC-SR04 2cm - 400cm 5V 15mA 1,80 \u20ac Ultrasound Grove 3cm \u2013 350cm 3.3V/5V 8mA Infrared 2cm - 30cm 35\u00b0 Infrared GP2Y0A21YK 10cm - 80cm 10\u20ac External Movement/Presence sensor Returns a boolean value if the presence of an objects appears. Sensor Emmiter Detector Application Price PIR sensor (Pasive InfraRed) No Infrared Room presence 0,80\u20ac IR sensor Infrared Infrared Magnetic (Reed Switch) Magnetic Magnetic The door is open/close Magnetic (Hall effect) No Magnetic Magnetometer Optical sensor (Transmissive) Light Light Sensor puerta ascensor Optical sensor (Reflective) Light Light Sensor puerta ascensor Internal Movement sensor (aka IMU) Vibration sensor Tilt sensor 3-axis Accelerometer 3-axis Gyroscope 3-axis Magnetometer (aka Compass) Wheel-speed sensor Chip Sensors Price Note MPU-6050 3D Acc + 3D Gyr 5\u20ac HMC5883L / GY-271 3D Mag LSM9DS1 3D Acc + 3D Gyr + 3D Mag 20\u20ac Incluido en Arduino Nano 33 BLE Sense) Navigation GPS Force & Presure car Seat Sensor de peatones Peso (balanza) Manual interface Rotary Encoder Module Joystic Button Biometrics Muscle Sensor Pulse Oximeter Heart Rate Sensor Fingerprint Scanner car seat occupancy sensor PULS\u00cdMETRO Y OX\u00cdMETRO CON ARDUINO Y MAX30102 Gas Sensor Detects Heater Voltage MQ-2 Methane, Butane, LPG, smoke 5V MQ-3 Alcohol, Ethanol, smoke 5V MQ-4 Methane, CNG Gas 5V MQ-5 Natural gas, LPG 5V MQ-6 LPG, butane gas 5V MQ-7 Carbon Monoxide Alternating 5V and 1.4V MQ-8 Hydrogen Gas 5V MQ-9 Carbon Monoxide, flammable gasses. Alternating 5V and 1.4V MQ131 Ozone 6V MQ135 Air Quality (Benzene, Alcohol, smoke) 5V MQ136 Hydrogen Sulfide gas 5V MQ137 Ammonia 5V MQ138 Benzene, Toluene, Alcohol, Acetone, Propane, Formaldehyde gas, Hydrogen 5V MQ214 Methane, Natural gas 6V MQ216 Natural gas, Coal gas 5V MQ303A Alcohol, Ethanol, smoke 0.9V MQ306A LPG, butane gas 0.9V MQ307A Carbon Monoxide Alternating 0.2V and 0.9V. MQ309A Carbon Monoxide, flammable gasses Alternating 0.2V and 0.9V MG811 Carbon Dioxide (CO2) 6V AQ-104 Air quality - Soil soil moisture sensor Weather Temerature Humity pressure sensor | | Sensor | Example |------------|--------------------- | Light | Photoresistor | | Temerature | Thermal sensor | TMP36 [40\u00b0C...+125\u00b0] 0.1\u00b0C resolution | Humidity | | DHT11 | Presure | Barometer | BMP180 (5\u20ac) | Flame | Flame IR sensor | KY-026 (detects wavelengths ranging from 760nm to 1100nm in the infrared spectrum) | Raindrop | Raindrop Sensor | | CO2 sensor | Wind","title":"Sensors"},{"location":"3_c/embedded%20systems/sensors/readme/#sensors","text":"","title":"Sensors"},{"location":"3_c/embedded%20systems/sensors/readme/#current","text":"5V como de 3.3V. Si tu Arduino es de 5V no deber\u00eda tener ning\u00fan problema para leer la se\u00f1al de senbsores de 3.3V, ya cualquier tensi\u00f3n que sobre pase 2.5V es le\u00eddo como HIGH en Arduino.","title":"Current"},{"location":"3_c/embedded%20systems/sensors/readme/#kalman-filter","text":"","title":"Kalman filter"},{"location":"3_c/embedded%20systems/sensors/readme/#image","text":"Stereo Visi\u00f3n nocturna Ultrawide With autofocus Multisctrum Thermal Imaging","title":"Image"},{"location":"3_c/embedded%20systems/sensors/readme/#sound","text":"Microphone","title":"Sound"},{"location":"3_c/embedded%20systems/sensors/readme/#velocity","text":"Radar sensors using the doppler effect","title":"Velocity"},{"location":"3_c/embedded%20systems/sensors/readme/#distance","text":"Returns an analog value with the distance. | | Ultrasonic (sonar) | IR triangulation | LiDAR | ToF (Time of Flight) | Radar |-----------------------------|-----------------------------------------|-------------- | Emits and recives | High-frequency sound | Infrared light | UV light | | Detects tranparent surfaces | yes \ud83d\ude42 | No \ud83d\ude41 | No \ud83d\ude41 | | Safe for human eyes | yes \ud83d\ude42 | | No \ud83d\ude41 | | Invariant to dust | yes \ud83d\ude42 | Invariant to temperature | yes \ud83d\ude42 | Invariant to light | yes \ud83d\ude42 | Max range | ~10m | | Application | Slow & near objects | https://www.terabee.com/choosing-right-distance-sensor-your-application/ Technology Sensor Range Angle Voltage Current Price Ultrasound HC-SR04 2cm - 400cm 5V 15mA 1,80 \u20ac Ultrasound Grove 3cm \u2013 350cm 3.3V/5V 8mA Infrared 2cm - 30cm 35\u00b0 Infrared GP2Y0A21YK 10cm - 80cm 10\u20ac","title":"Distance"},{"location":"3_c/embedded%20systems/sensors/readme/#external-movementpresence-sensor","text":"Returns a boolean value if the presence of an objects appears. Sensor Emmiter Detector Application Price PIR sensor (Pasive InfraRed) No Infrared Room presence 0,80\u20ac IR sensor Infrared Infrared Magnetic (Reed Switch) Magnetic Magnetic The door is open/close Magnetic (Hall effect) No Magnetic Magnetometer Optical sensor (Transmissive) Light Light Sensor puerta ascensor Optical sensor (Reflective) Light Light Sensor puerta ascensor","title":"External Movement/Presence sensor"},{"location":"3_c/embedded%20systems/sensors/readme/#internal-movement-sensor-aka-imu","text":"Vibration sensor Tilt sensor 3-axis Accelerometer 3-axis Gyroscope 3-axis Magnetometer (aka Compass) Wheel-speed sensor Chip Sensors Price Note MPU-6050 3D Acc + 3D Gyr 5\u20ac HMC5883L / GY-271 3D Mag LSM9DS1 3D Acc + 3D Gyr + 3D Mag 20\u20ac Incluido en Arduino Nano 33 BLE Sense)","title":"Internal Movement sensor (aka IMU)"},{"location":"3_c/embedded%20systems/sensors/readme/#navigation","text":"GPS","title":"Navigation"},{"location":"3_c/embedded%20systems/sensors/readme/#force-presure","text":"car Seat Sensor de peatones Peso (balanza)","title":"Force &amp; Presure"},{"location":"3_c/embedded%20systems/sensors/readme/#manual-interface","text":"Rotary Encoder Module Joystic Button","title":"Manual interface"},{"location":"3_c/embedded%20systems/sensors/readme/#biometrics","text":"Muscle Sensor Pulse Oximeter Heart Rate Sensor Fingerprint Scanner car seat occupancy sensor PULS\u00cdMETRO Y OX\u00cdMETRO CON ARDUINO Y MAX30102","title":"Biometrics"},{"location":"3_c/embedded%20systems/sensors/readme/#gas","text":"Sensor Detects Heater Voltage MQ-2 Methane, Butane, LPG, smoke 5V MQ-3 Alcohol, Ethanol, smoke 5V MQ-4 Methane, CNG Gas 5V MQ-5 Natural gas, LPG 5V MQ-6 LPG, butane gas 5V MQ-7 Carbon Monoxide Alternating 5V and 1.4V MQ-8 Hydrogen Gas 5V MQ-9 Carbon Monoxide, flammable gasses. Alternating 5V and 1.4V MQ131 Ozone 6V MQ135 Air Quality (Benzene, Alcohol, smoke) 5V MQ136 Hydrogen Sulfide gas 5V MQ137 Ammonia 5V MQ138 Benzene, Toluene, Alcohol, Acetone, Propane, Formaldehyde gas, Hydrogen 5V MQ214 Methane, Natural gas 6V MQ216 Natural gas, Coal gas 5V MQ303A Alcohol, Ethanol, smoke 0.9V MQ306A LPG, butane gas 0.9V MQ307A Carbon Monoxide Alternating 0.2V and 0.9V. MQ309A Carbon Monoxide, flammable gasses Alternating 0.2V and 0.9V MG811 Carbon Dioxide (CO2) 6V AQ-104 Air quality -","title":"Gas"},{"location":"3_c/embedded%20systems/sensors/readme/#soil","text":"soil moisture sensor","title":"Soil"},{"location":"3_c/embedded%20systems/sensors/readme/#weather","text":"Temerature Humity pressure sensor | | Sensor | Example |------------|--------------------- | Light | Photoresistor | | Temerature | Thermal sensor | TMP36 [40\u00b0C...+125\u00b0] 0.1\u00b0C resolution | Humidity | | DHT11 | Presure | Barometer | BMP180 (5\u20ac) | Flame | Flame IR sensor | KY-026 (detects wavelengths ranging from 760nm to 1100nm in the infrared spectrum) | Raindrop | Raindrop Sensor | | CO2 sensor | Wind","title":"Weather"},{"location":"4_assembly/readme/","text":"\ud83d\udda5\ufe0f Architectures History Date Arch Bits RAM Memory Speed Transistors 8080 1974 8 bits 2 MHz 6000 6502 1975 8 bits 1 MHz 3510 Zilog z80 1976 8 bits 16 bits (64Kb) 2.5 MHz 8500 8086 1978 X86 16 bits 20 bits (1Mb) 5 MHz 29K 68000 1979 16 bits 8 MHz 68K i286 1982 X86 16 bits 6 MHz 134K MIPS 1983 32 bits 2 MHz 25K i386 1985 X86 32 bits 16 MHz 275K i486 1989 32 bits 25 MHz 1180K Pentium 1993 32 bits 60 MHz 3.1M Pentium 4E 2004 X86 64 bits 2800-3800 125M https://en.wikipedia.org/wiki/Microprocessor_chronology CISC vs RISC CISC RISC Larger more complex instruction set Small simple instruction set Fewer registers Larger set of registers Variable lenght instructions Fixed lenght instructions Instructions cant take multiple clock cycles to execute Each instruction takes 1 clock cycle (except DIV ) Can perform arithmetic + memory acces in the same instruction Memory and arithmetic instructions are separated Source: https://www.youtube.com/watch?v=GBRdzaAxHB8 \ud83d\udda5\ufe0f Architectures (and emulators) ``` sudo pacman -S nasm # A 80x86 assembler designed for portability and modularity sudo pacman -S fasm # Fast and efficient self-assembling x86 assembler for DOS, Windows and Linux sudo pacman -S aarch64-linux-gnu-gcc # The GNU Compiler Collection - cross compiler for ARM64 target sudo pacman -S aarch64-linux-gnu-binutils # A set of programs to assemble and manipulate binary and object files for the ARM64 target sudo pacman -S qemu # A generic and open source machine emulator and virtualizer sudo pacman -S qemu-arch-extra # QEMU for foreign architectures ``` Family Instruction Length Common Machines QEMU Assembler x86 CISC 1..15 bytes Intel and AMD PCs qemu-system-i386 qemu-system-x86_64 nasm ARM RISC 2 bytes or 4 bytes iPhone, Android, Raspberry qemu-system-arm qemu-system-aarch64 aarch64-linux-gnu-gcc RISC-V RISC 4 bytes qemu-system-riscv32 qemu-system-riscv64 MIPS RISC 4 bytes qemu-system-mips PowerPC RISC 4 bytes qemu-system-ppc64 AVR RISC 1 byte Arduino microcontrollers qemu-system-avr QEMU *ARM: Thumb mode: 2 bytes per instruction ARM mode: 4 bytes per instruction Online assemblers X86 https://kobzol.github.io/davis ARM OakSim cpulator RISC-V https://www.cs.cornell.edu/courses/cs3410/2019sp/riscv/interpreter SIMD SIMD: Fixed vector lenth and element lenh on HARDWARE BAD becaouse they significally increase the instrusion set (from 80 to around 1400 instructions) Used for: When the need was primarily needed for short vectors in multimedia settings (1990s, 2000s) Ref: https://www.sigarch.org/simd-instructions-considered-harmful Vector instruction-set: Variable vector lenth and element lenh on HARDWARE Good, used in RISC-V (actually the V in RISC-V stands for both 5 and for Vector) Used for: excellent choice for machine learning applications Vector computers gather objects from main memory and put them into long, sequential vector registers. the assembly code instructions are not tied to specific vector lengths Branching (jumps) Branching is quite bad for a pipelined microprocessor. In pipelining instructions are queued up and the execution of one instruction begins before the execution of an earlier one is done. Soultion: Conditional Instructions - x86 Conditional Moves (introduced in i686): CMP ax, 42 CMOVE bx, 33 ; bx \u2190 33 if ax = 42 CMOVNE bx, 12 ; bx \u2190 12 if ax \u2260 42 Assemblers STEP 1: WRITE PROGRAM : Assemble your program into machine code ( .img ) as : the portable GNU assembler. nasm : the Netwide Assembler, a portable 80x86 assembler nasm program.asm -o program.img nasm program.asm -o program.bin -O3 -f bin fasm STEP 2: RUN PROGRAM : OPTION A : Run your code into an emulator (QEMU) qemu-system-i386 -hda program.img qemu-system-i386 -fda program.img Floppy qemu -M pc -soundhw pcspk -fda program.bin OPTION B : Run your code real hardware (Copy your image into a USB stick) Insert an USB, determine its device ( /dev/sdX ) with sudo lsblk or sudo fdisk -l Pick the .img file and: sudo dd if=program.img of=/dev/sdX bs=512 insert the USB in a computer during boot, hit some special hardware dependant key, usually F12, Esc choose to boot from the USB Nice Stackoverovleow answer References General References X86 WikiBook: x86 Assembly x86 Bare Metal Examples Bootloader https://www.joe-bergeron.com/posts/Writing%20a%20Tiny%20x86%20Bootloader/ https://www.alanfoster.me/posts/writing-a-bootloader http://3zanders.co.uk/2017/10/13/writing-a-bootloader ARM Embedded Systems with ARM (Youtube channel) QIRA by George Hotz Videogames References Profesor RetroMan (youtube channel) FABIEN SANGLARD'S WEBSITE List of Boot Sector Games Queso Fuego (youtube channel) Pong in 386 Space invaders in x86 Snake in x86 retro game in a tweet Operating Systems References Operating Systems: From 0 to 1 Nand to Tetris (Coursera free course) Build a Modern Computer from First Principles (project-centered course) Part 1 ( HARDWARE ): From NAND to the HACK computer Week 1: Elementary Logic Gates (Nand, Not, And, Or, Xor, Mux, Dmux) Week 2: Arithmetic Logic Unit (Halfdder, FullAdder, Add16, Inc16, ALU) Week 3: Registers and Memory (Bit Register, RAM8, RAM64, RAM512) Week 4: Writting low-level programs Week 5: Computer Architecture (Memory, CPU, Computer) Week 6: Develop an Assembler Part 2 ( SOFTWARE ): From the HACK computer to Tetris Course book: The Elements of Computing Systems: Building a Modern Computer from First Principles Open Security Training Beginner Introductory Intel x86 Introduction to ARM The Life of Binaries Malware Dynamic Analysis Introduction to Trusted Computing Intermediate Intermediate Intel x86 Introduction to Software Exploits Exploits 2: Exploitation in the Windows Environment Advanced Rootkits: What they are, and how to find them Introduction to Reverse Engineering Software Reverse Engineering Malware Advanced x86: Virtualization with Intel VT-x","title":"\ud83d\udda5\ufe0f Architectures History"},{"location":"4_assembly/readme/#architectures-history","text":"Date Arch Bits RAM Memory Speed Transistors 8080 1974 8 bits 2 MHz 6000 6502 1975 8 bits 1 MHz 3510 Zilog z80 1976 8 bits 16 bits (64Kb) 2.5 MHz 8500 8086 1978 X86 16 bits 20 bits (1Mb) 5 MHz 29K 68000 1979 16 bits 8 MHz 68K i286 1982 X86 16 bits 6 MHz 134K MIPS 1983 32 bits 2 MHz 25K i386 1985 X86 32 bits 16 MHz 275K i486 1989 32 bits 25 MHz 1180K Pentium 1993 32 bits 60 MHz 3.1M Pentium 4E 2004 X86 64 bits 2800-3800 125M https://en.wikipedia.org/wiki/Microprocessor_chronology","title":"\ud83d\udda5\ufe0f Architectures History"},{"location":"4_assembly/readme/#cisc-vs-risc","text":"CISC RISC Larger more complex instruction set Small simple instruction set Fewer registers Larger set of registers Variable lenght instructions Fixed lenght instructions Instructions cant take multiple clock cycles to execute Each instruction takes 1 clock cycle (except DIV ) Can perform arithmetic + memory acces in the same instruction Memory and arithmetic instructions are separated Source: https://www.youtube.com/watch?v=GBRdzaAxHB8","title":"CISC vs RISC"},{"location":"4_assembly/readme/#architectures-and-emulators","text":"``` sudo pacman -S nasm # A 80x86 assembler designed for portability and modularity sudo pacman -S fasm # Fast and efficient self-assembling x86 assembler for DOS, Windows and Linux sudo pacman -S aarch64-linux-gnu-gcc # The GNU Compiler Collection - cross compiler for ARM64 target sudo pacman -S aarch64-linux-gnu-binutils # A set of programs to assemble and manipulate binary and object files for the ARM64 target sudo pacman -S qemu # A generic and open source machine emulator and virtualizer sudo pacman -S qemu-arch-extra # QEMU for foreign architectures ``` Family Instruction Length Common Machines QEMU Assembler x86 CISC 1..15 bytes Intel and AMD PCs qemu-system-i386 qemu-system-x86_64 nasm ARM RISC 2 bytes or 4 bytes iPhone, Android, Raspberry qemu-system-arm qemu-system-aarch64 aarch64-linux-gnu-gcc RISC-V RISC 4 bytes qemu-system-riscv32 qemu-system-riscv64 MIPS RISC 4 bytes qemu-system-mips PowerPC RISC 4 bytes qemu-system-ppc64 AVR RISC 1 byte Arduino microcontrollers qemu-system-avr QEMU *ARM: Thumb mode: 2 bytes per instruction ARM mode: 4 bytes per instruction","title":"\ud83d\udda5\ufe0f Architectures (and emulators)"},{"location":"4_assembly/readme/#online-assemblers","text":"X86 https://kobzol.github.io/davis ARM OakSim cpulator RISC-V https://www.cs.cornell.edu/courses/cs3410/2019sp/riscv/interpreter","title":"Online assemblers"},{"location":"4_assembly/readme/#simd","text":"SIMD: Fixed vector lenth and element lenh on HARDWARE BAD becaouse they significally increase the instrusion set (from 80 to around 1400 instructions) Used for: When the need was primarily needed for short vectors in multimedia settings (1990s, 2000s) Ref: https://www.sigarch.org/simd-instructions-considered-harmful Vector instruction-set: Variable vector lenth and element lenh on HARDWARE Good, used in RISC-V (actually the V in RISC-V stands for both 5 and for Vector) Used for: excellent choice for machine learning applications Vector computers gather objects from main memory and put them into long, sequential vector registers. the assembly code instructions are not tied to specific vector lengths","title":"SIMD"},{"location":"4_assembly/readme/#branching-jumps","text":"Branching is quite bad for a pipelined microprocessor. In pipelining instructions are queued up and the execution of one instruction begins before the execution of an earlier one is done. Soultion: Conditional Instructions - x86 Conditional Moves (introduced in i686): CMP ax, 42 CMOVE bx, 33 ; bx \u2190 33 if ax = 42 CMOVNE bx, 12 ; bx \u2190 12 if ax \u2260 42","title":"Branching (jumps)"},{"location":"4_assembly/readme/#assemblers","text":"STEP 1: WRITE PROGRAM : Assemble your program into machine code ( .img ) as : the portable GNU assembler. nasm : the Netwide Assembler, a portable 80x86 assembler nasm program.asm -o program.img nasm program.asm -o program.bin -O3 -f bin fasm STEP 2: RUN PROGRAM : OPTION A : Run your code into an emulator (QEMU) qemu-system-i386 -hda program.img qemu-system-i386 -fda program.img Floppy qemu -M pc -soundhw pcspk -fda program.bin OPTION B : Run your code real hardware (Copy your image into a USB stick) Insert an USB, determine its device ( /dev/sdX ) with sudo lsblk or sudo fdisk -l Pick the .img file and: sudo dd if=program.img of=/dev/sdX bs=512 insert the USB in a computer during boot, hit some special hardware dependant key, usually F12, Esc choose to boot from the USB Nice Stackoverovleow answer","title":"Assemblers"},{"location":"4_assembly/readme/#references","text":"","title":"References"},{"location":"4_assembly/readme/#general-references","text":"X86 WikiBook: x86 Assembly x86 Bare Metal Examples Bootloader https://www.joe-bergeron.com/posts/Writing%20a%20Tiny%20x86%20Bootloader/ https://www.alanfoster.me/posts/writing-a-bootloader http://3zanders.co.uk/2017/10/13/writing-a-bootloader ARM Embedded Systems with ARM (Youtube channel) QIRA by George Hotz","title":"General References"},{"location":"4_assembly/readme/#videogames-references","text":"Profesor RetroMan (youtube channel) FABIEN SANGLARD'S WEBSITE List of Boot Sector Games Queso Fuego (youtube channel) Pong in 386 Space invaders in x86 Snake in x86 retro game in a tweet","title":"Videogames References"},{"location":"4_assembly/readme/#operating-systems-references","text":"Operating Systems: From 0 to 1","title":"Operating Systems References"},{"location":"4_assembly/readme/#nand-to-tetris-coursera-free-course","text":"Build a Modern Computer from First Principles (project-centered course) Part 1 ( HARDWARE ): From NAND to the HACK computer Week 1: Elementary Logic Gates (Nand, Not, And, Or, Xor, Mux, Dmux) Week 2: Arithmetic Logic Unit (Halfdder, FullAdder, Add16, Inc16, ALU) Week 3: Registers and Memory (Bit Register, RAM8, RAM64, RAM512) Week 4: Writting low-level programs Week 5: Computer Architecture (Memory, CPU, Computer) Week 6: Develop an Assembler Part 2 ( SOFTWARE ): From the HACK computer to Tetris Course book: The Elements of Computing Systems: Building a Modern Computer from First Principles","title":"Nand to Tetris (Coursera free course)"},{"location":"4_assembly/readme/#open-security-training","text":"Beginner Introductory Intel x86 Introduction to ARM The Life of Binaries Malware Dynamic Analysis Introduction to Trusted Computing Intermediate Intermediate Intel x86 Introduction to Software Exploits Exploits 2: Exploitation in the Windows Environment Advanced Rootkits: What they are, and how to find them Introduction to Reverse Engineering Software Reverse Engineering Malware Advanced x86: Virtualization with Intel VT-x","title":"Open Security Training"},{"location":"4_assembly/syscalls/","text":"Syscalls linux system calls table Syscalls x86 32bits Specify the syscall number into EAX . Specify the syscall paramenters into EBX , ECX , EDX , ESI , EDI , EBP Invoque interruption: INT 0x80 Syscall EAX EBX Param 1 ECX Param 2 EDX Param 3 Description exit 1 int status Exit the program with some status code. write 4 int FileDesc char* buffer size_t count Write n bytes (count) from the buffer to a file descriptor Reference Syscalls x86 64bits Specify the syscall number into RAX . Specify the syscall paramenters into RBX , RCX , RDX , RSI , RDI , RBP Invoque the syscall: SYSCALL","title":"Syscalls"},{"location":"4_assembly/syscalls/#syscalls","text":"linux system calls table","title":"Syscalls"},{"location":"4_assembly/syscalls/#syscalls-x86-32bits","text":"Specify the syscall number into EAX . Specify the syscall paramenters into EBX , ECX , EDX , ESI , EDI , EBP Invoque interruption: INT 0x80 Syscall EAX EBX Param 1 ECX Param 2 EDX Param 3 Description exit 1 int status Exit the program with some status code. write 4 int FileDesc char* buffer size_t count Write n bytes (count) from the buffer to a file descriptor Reference","title":"Syscalls x86 32bits"},{"location":"4_assembly/syscalls/#syscalls-x86-64bits","text":"Specify the syscall number into RAX . Specify the syscall paramenters into RBX , RCX , RDX , RSI , RDI , RBP Invoque the syscall: SYSCALL","title":"Syscalls x86 64bits"},{"location":"4_assembly/ARM/readme/","text":"ARM History ARM v7 : Released in 2007. ARM v8 : Released in 2013. Introduced the 64 bits. ARM v9 : Annouonced in 2021. Focus on secure execution and compartmentalisation. Registers ARM 32 bits: r0, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, r11, r12, sp, lr, pc ARM 64 bits: X0 to X30, SP, PC Instructions Every instruction takes 4 bytes in machine code. (2 bytes in thumb mode). Arithmetic (64 bits integer): ADD , ADC , SUB , SBC , RSB , RSC ADD X4, X3, X2 X4 = X3 + X2 Logical: AND , ORR , EOR , BIC Comparison: CMP , CMN , TST , TEQ Data movement (64 bits addresing): MOV , MVN Immediate to register: MOV X2, #0x6E3A (limited to 16 bits) (1 intruction) mov r0, #5 ; r0 = 5 mov r1, r0 ; r1 = r0 Load Load Immediate: LDR X2, #0x1234ABCD1234ABCD (limited to 64 bits) (several intructions) Load Adress: LDR X2, =some_label (limited to 64 bits) (several intructions) LoaD from memory: LDR X2, [X1] LoaD from memory with offset: LDR X2, [X1, #8] Store STore Regiter into memory: STR X2, [X1] Branching (Jumps) B to_label : Branch (unconditinal jump) BEQ to_label : Branch if EQual (if zero flag==1) Others NOP : Do nothing More info: ARM Cortex-A Series Programmer\u2019s Guide for ARMv8-A SIMD Insturctions (ARM NEON) Tools sudo pacman -S aarch64-linux-gnu-gcc # The GNU Compiler Collection - cross compiler for ARM64 target sudo pacman -S aarch64-linux-gnu-binutils # A set of programs to assemble and manipulate binary and object files for the ARM64 target sudo pacman -S qemu # A generic and open source machine emulator and virtualizer sudo pacman -S qemu-arch-extra # QEMU for foreign architectures aarch64-linux-gnu-as : The assembler aarch64-linux-gnu-gcc : The C compiler aarch64-linux-gnu-ld : The linker aarch64-linux-gnu-objcopy : To convert ELF executable into IMG format aarch64-linux-gnu-objdump : Utility to disassemble executables (for debugging) aarch64-linux-gnu-readelf : An useful utility to dump sections and segments in executables (for debugging) References BroadCom VideoCore IV Architecture Guide https://github.com/nineties/py-videocore https://github.com/Idein/py-videocore6 ARM ARM Cortex-A Series Programmer\u2019s Guide for ARMv8-A Arm Cortex-A53 MPCore Processor Technical Reference Manual QEMU QEMU for Raspberry Raspberry Pi BareMetal https://github.com/bztsrc/raspi3-tutorial https://www.youtube.com/playlist?list=PLVxiWMqQvhg9FCteL7I0aohj1_YiUx1x8 https://github.com/raspberrypi/documentation/tree/master/hardware/raspberrypi","title":"ARM"},{"location":"4_assembly/ARM/readme/#arm","text":"","title":"ARM"},{"location":"4_assembly/ARM/readme/#history","text":"ARM v7 : Released in 2007. ARM v8 : Released in 2013. Introduced the 64 bits. ARM v9 : Annouonced in 2021. Focus on secure execution and compartmentalisation.","title":"History"},{"location":"4_assembly/ARM/readme/#registers","text":"ARM 32 bits: r0, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, r11, r12, sp, lr, pc ARM 64 bits: X0 to X30, SP, PC","title":"Registers"},{"location":"4_assembly/ARM/readme/#instructions","text":"Every instruction takes 4 bytes in machine code. (2 bytes in thumb mode). Arithmetic (64 bits integer): ADD , ADC , SUB , SBC , RSB , RSC ADD X4, X3, X2 X4 = X3 + X2 Logical: AND , ORR , EOR , BIC Comparison: CMP , CMN , TST , TEQ Data movement (64 bits addresing): MOV , MVN Immediate to register: MOV X2, #0x6E3A (limited to 16 bits) (1 intruction) mov r0, #5 ; r0 = 5 mov r1, r0 ; r1 = r0 Load Load Immediate: LDR X2, #0x1234ABCD1234ABCD (limited to 64 bits) (several intructions) Load Adress: LDR X2, =some_label (limited to 64 bits) (several intructions) LoaD from memory: LDR X2, [X1] LoaD from memory with offset: LDR X2, [X1, #8] Store STore Regiter into memory: STR X2, [X1] Branching (Jumps) B to_label : Branch (unconditinal jump) BEQ to_label : Branch if EQual (if zero flag==1) Others NOP : Do nothing More info: ARM Cortex-A Series Programmer\u2019s Guide for ARMv8-A","title":"Instructions"},{"location":"4_assembly/ARM/readme/#simd-insturctions-arm-neon","text":"","title":"SIMD Insturctions (ARM NEON)"},{"location":"4_assembly/ARM/readme/#tools","text":"sudo pacman -S aarch64-linux-gnu-gcc # The GNU Compiler Collection - cross compiler for ARM64 target sudo pacman -S aarch64-linux-gnu-binutils # A set of programs to assemble and manipulate binary and object files for the ARM64 target sudo pacman -S qemu # A generic and open source machine emulator and virtualizer sudo pacman -S qemu-arch-extra # QEMU for foreign architectures aarch64-linux-gnu-as : The assembler aarch64-linux-gnu-gcc : The C compiler aarch64-linux-gnu-ld : The linker aarch64-linux-gnu-objcopy : To convert ELF executable into IMG format aarch64-linux-gnu-objdump : Utility to disassemble executables (for debugging) aarch64-linux-gnu-readelf : An useful utility to dump sections and segments in executables (for debugging)","title":"Tools"},{"location":"4_assembly/ARM/readme/#references","text":"BroadCom VideoCore IV Architecture Guide https://github.com/nineties/py-videocore https://github.com/Idein/py-videocore6 ARM ARM Cortex-A Series Programmer\u2019s Guide for ARMv8-A Arm Cortex-A53 MPCore Processor Technical Reference Manual QEMU QEMU for Raspberry Raspberry Pi BareMetal https://github.com/bztsrc/raspi3-tutorial https://www.youtube.com/playlist?list=PLVxiWMqQvhg9FCteL7I0aohj1_YiUx1x8 https://github.com/raspberrypi/documentation/tree/master/hardware/raspberrypi","title":"References"},{"location":"4_assembly/RISC-V/readme/","text":"Links RISC-V Interpreter RISC-V Cheatsheet","title":"Readme"},{"location":"4_assembly/RISC-V/readme/#links","text":"RISC-V Interpreter RISC-V Cheatsheet","title":"Links"},{"location":"4_assembly/Reverse%20engineering/readme/","text":"Reverse engeneerging Identify the architecture (CPU + Memory) the binay is working with This will tell you the register sizes, etc. find a disassembler Dis51: target a single architecture Dis66k: custom-written for automotive reverse engineering CATS dasm IDA Pro: Supports more embedded target but is very expensive Hopper dasmx objdump bosch EDC17CP09 Automatic Transmission 325d 204hp Bosch EDC17CP45 The ECU is a common target of reverse engineering, sometimes referred to as chip tuning. the most popular ECU hack is modifying the fuel map to alter the balance of fuel efficiency and performance in order to give you a higher-performance vehicle","title":"Reverse engeneerging"},{"location":"4_assembly/Reverse%20engineering/readme/#reverse-engeneerging","text":"Identify the architecture (CPU + Memory) the binay is working with This will tell you the register sizes, etc. find a disassembler Dis51: target a single architecture Dis66k: custom-written for automotive reverse engineering CATS dasm IDA Pro: Supports more embedded target but is very expensive Hopper dasmx objdump bosch EDC17CP09 Automatic Transmission 325d 204hp Bosch EDC17CP45 The ECU is a common target of reverse engineering, sometimes referred to as chip tuning. the most popular ECU hack is modifying the fuel map to alter the balance of fuel efficiency and performance in order to give you a higher-performance vehicle","title":"Reverse engeneerging"},{"location":"4_assembly/x86/readme/","text":"Diagram CPU x86 32bits RAM (4GB) I/O Devices |------------------------------------------------------------| 0x0000|-------------------------|------- 0x00|-------------------| | | | Interrupt Vector Table | | | | 32bits General Purpose Registers 16bits Status | 0x0400|.........................| | | | |----------------|--------|--------| |----------------| | | BIOS Data Area 256 Bytes| | | | |\"accumulator\" [EAX] AH (AX) AL | | C| | 0x0500|.........................| | | | |----------------|--------|--------| |----------------| | | | 0x40| Time Counter chip | (used for random) | | \"base\" [EBX] BH (BX) BL | | 0x7C00|.........................| BASE | | | |----------------|--------|--------| 16bits Segments | | Boot Sector (512 Bytes) | RAM | | | | \"counter\" [ECX] CH (CX) CL | |----------------| | 0x7E00|.........................| MEMORY |-------------------| | |----------------|--------|--------| | [CS] Code Seg | | | | 640 KB | | \"data\" [EDX] DH (DX) DL | |----------------| | | | | |----------------|--------|--------| | [DS] Data Seg | | | | | |----------------| | 0x9FC0|.........................| | 32bits Index Registers | [ES] Extra Seg | | | | | |----------------------------------| |----------------| | | Extended BIOS Data Area | | | [ESI] Source Index | | [FS] More extra| | | | | |----------------------------------| |----------------| | 0xA0000|-------------------------|------- | | [EDI] Destination Index | | [GS] More extra| | | VGA Graphic mode (64KB) | | |----------------------------------| |----------------| | 0xB0000| ..................... | VIDEO | | [ESP] Stack Pointer | | [SS] Stack Seg | | | B&W text mode (32KB) | MEMORY | |----------------------------------| |----------------| | 0xB8000| ..................... | 128KB | | [EBP] Base Pointer | | | Color text mode (32KB) | | |----------------------------------| | 0xC0000|-------------------------|------- | | | | | |----------------------------------| | | | | | [EIP] Instruction Pointer | aka Program Counter | | | | |----------------------------------| | 0xFFFF|-------------------------| | | |------------------------------------------------------------| 32bits address bus for up to 4GB of flat addresable RAM. Types Define byte db my_number: db 10010001b ; Saves byte in binary format my_number: db 145 ; Saves byte in decimal format my_number: db 0xAF, AFh ; Saves byte in Hexadecinal format my_char: db \"a\" ; Saves the ASCII byte represtantion of a char my_string: db \u2019Hello world\u2019, 0 ; Saves evert character inside a byte. Last char sholulb be te null char (0) db 01001010b, 74, 4Ah, 0x4A, 4ah, 0x4a, \"J\", 'J' Define same byte in different ways. Machine code: 4A 4A 4A 4A 4A 4A 4A 4A Define word dw my_number: dw AF3Bh Conditional jumps (after compare) cmp x, y ; Do the comparison (x and y are registers or values) je address ; jump if equal (x == y) jne address ; jump if not equal (x != y) ; Compare signed numbers jl address ; jump if less than (x < y) jle address ; jump if less than or equal (x <= y) jg address ; jump if greater than (x > y) jge address ; jump if greater than or equal (x >= y) ; Compare unsigned numbers JB adress ; Jump if Below (x < y) JBE adress ; Jump if below or equal (x <= y) JA adress ; Jump if Above (x > y) JAE adress ; Jump if above or equal (x >= y) http://unixwiz.net/techtips/x86-jumps.html Functions mov al , \"H\" ; Pass parameters to function (al=\"H\") call some_function ; Call function some_function: pusha ; Push all register values to the stack (OPTIONAL FOR SAFETY) ; Do the code ; You can safely destroy registers here popa ; Restore original register values (OPTIONAL FOR SAFETY) ret ; Jump back after the function call Modes Real Mode Protected Mode Long Mode Bits for data (word size) 16 bits 32 bits 64 bits Bits for memory 20 (Max 1 MB) 32 bits Memory protection no yes Virtual memory (Paging) no yes 32bit offsets no yes More than 1MB no yes Notes Bootsector default Real mode: Real memory addresses. Protected mode: virtual memory. Instruction set Additional instruction sets available, including the floating point, MMX, and SSE operations. Bootsector Note that at booting time, the firts program to execute is the bootsector (512 bit). This code is in 16bit in Real Mode that means that we only can access x86-16bits registers and the maximun memory is 1Mb. http://kernelx.weebly.com/writing-a-bootsector.html https://www.cs.bham.ac.uk/~exr/lectures/opsys/10_11/lectures/os-dev.pdf ---> voy por 3.3.2 x86 assembly language has two main syntaxs: Intel and AT&T. Intel syntax AT&T syntax OS Windows and DOS Linux, Unix and MacOS Assemblers NASM, FASM, MASM, TASM, and YASM GNU Assembler (GAS) Memory sections Can write during execution |-----------------|--------------------------------------------------|--------- | section .text | Memory space for the code of the program | no | section .data | Memory space for the initialized variables | yes | section .bss | Extra future memory space that the program needs | yes Hello world ```asm section .data my_message db \"hola\",0x0A,0 # Define bytes \"hola\\n\" 0x0A=\\n 0=End of String in C section .text","title":"Diagram"},{"location":"4_assembly/x86/readme/#diagram","text":"CPU x86 32bits RAM (4GB) I/O Devices |------------------------------------------------------------| 0x0000|-------------------------|------- 0x00|-------------------| | | | Interrupt Vector Table | | | | 32bits General Purpose Registers 16bits Status | 0x0400|.........................| | | | |----------------|--------|--------| |----------------| | | BIOS Data Area 256 Bytes| | | | |\"accumulator\" [EAX] AH (AX) AL | | C| | 0x0500|.........................| | | | |----------------|--------|--------| |----------------| | | | 0x40| Time Counter chip | (used for random) | | \"base\" [EBX] BH (BX) BL | | 0x7C00|.........................| BASE | | | |----------------|--------|--------| 16bits Segments | | Boot Sector (512 Bytes) | RAM | | | | \"counter\" [ECX] CH (CX) CL | |----------------| | 0x7E00|.........................| MEMORY |-------------------| | |----------------|--------|--------| | [CS] Code Seg | | | | 640 KB | | \"data\" [EDX] DH (DX) DL | |----------------| | | | | |----------------|--------|--------| | [DS] Data Seg | | | | | |----------------| | 0x9FC0|.........................| | 32bits Index Registers | [ES] Extra Seg | | | | | |----------------------------------| |----------------| | | Extended BIOS Data Area | | | [ESI] Source Index | | [FS] More extra| | | | | |----------------------------------| |----------------| | 0xA0000|-------------------------|------- | | [EDI] Destination Index | | [GS] More extra| | | VGA Graphic mode (64KB) | | |----------------------------------| |----------------| | 0xB0000| ..................... | VIDEO | | [ESP] Stack Pointer | | [SS] Stack Seg | | | B&W text mode (32KB) | MEMORY | |----------------------------------| |----------------| | 0xB8000| ..................... | 128KB | | [EBP] Base Pointer | | | Color text mode (32KB) | | |----------------------------------| | 0xC0000|-------------------------|------- | | | | | |----------------------------------| | | | | | [EIP] Instruction Pointer | aka Program Counter | | | | |----------------------------------| | 0xFFFF|-------------------------| | | |------------------------------------------------------------| 32bits address bus for up to 4GB of flat addresable RAM.","title":"Diagram"},{"location":"4_assembly/x86/readme/#types","text":"","title":"Types"},{"location":"4_assembly/x86/readme/#define-byte-db","text":"my_number: db 10010001b ; Saves byte in binary format my_number: db 145 ; Saves byte in decimal format my_number: db 0xAF, AFh ; Saves byte in Hexadecinal format my_char: db \"a\" ; Saves the ASCII byte represtantion of a char my_string: db \u2019Hello world\u2019, 0 ; Saves evert character inside a byte. Last char sholulb be te null char (0) db 01001010b, 74, 4Ah, 0x4A, 4ah, 0x4a, \"J\", 'J' Define same byte in different ways. Machine code: 4A 4A 4A 4A 4A 4A 4A 4A","title":"Define byte db"},{"location":"4_assembly/x86/readme/#define-word-dw","text":"my_number: dw AF3Bh","title":"Define word dw"},{"location":"4_assembly/x86/readme/#conditional-jumps-after-compare","text":"cmp x, y ; Do the comparison (x and y are registers or values) je address ; jump if equal (x == y) jne address ; jump if not equal (x != y) ; Compare signed numbers jl address ; jump if less than (x < y) jle address ; jump if less than or equal (x <= y) jg address ; jump if greater than (x > y) jge address ; jump if greater than or equal (x >= y) ; Compare unsigned numbers JB adress ; Jump if Below (x < y) JBE adress ; Jump if below or equal (x <= y) JA adress ; Jump if Above (x > y) JAE adress ; Jump if above or equal (x >= y) http://unixwiz.net/techtips/x86-jumps.html","title":"Conditional jumps (after compare)"},{"location":"4_assembly/x86/readme/#functions","text":"mov al , \"H\" ; Pass parameters to function (al=\"H\") call some_function ; Call function some_function: pusha ; Push all register values to the stack (OPTIONAL FOR SAFETY) ; Do the code ; You can safely destroy registers here popa ; Restore original register values (OPTIONAL FOR SAFETY) ret ; Jump back after the function call","title":"Functions"},{"location":"4_assembly/x86/readme/#modes","text":"Real Mode Protected Mode Long Mode Bits for data (word size) 16 bits 32 bits 64 bits Bits for memory 20 (Max 1 MB) 32 bits Memory protection no yes Virtual memory (Paging) no yes 32bit offsets no yes More than 1MB no yes Notes Bootsector default Real mode: Real memory addresses. Protected mode: virtual memory.","title":"Modes"},{"location":"4_assembly/x86/readme/#instruction-set","text":"Additional instruction sets available, including the floating point, MMX, and SSE operations. Bootsector Note that at booting time, the firts program to execute is the bootsector (512 bit). This code is in 16bit in Real Mode that means that we only can access x86-16bits registers and the maximun memory is 1Mb. http://kernelx.weebly.com/writing-a-bootsector.html https://www.cs.bham.ac.uk/~exr/lectures/opsys/10_11/lectures/os-dev.pdf ---> voy por 3.3.2 x86 assembly language has two main syntaxs: Intel and AT&T. Intel syntax AT&T syntax OS Windows and DOS Linux, Unix and MacOS Assemblers NASM, FASM, MASM, TASM, and YASM GNU Assembler (GAS)","title":"Instruction set"},{"location":"4_assembly/x86/readme/#memory-sections","text":"Can write during execution |-----------------|--------------------------------------------------|--------- | section .text | Memory space for the code of the program | no | section .data | Memory space for the initialized variables | yes | section .bss | Extra future memory space that the program needs | yes","title":"Memory sections"},{"location":"4_assembly/x86/readme/#hello-world","text":"```asm section .data my_message db \"hola\",0x0A,0 # Define bytes \"hola\\n\" 0x0A=\\n 0=End of String in C section .text","title":"Hello world"},{"location":"4_assembly/x86/bootsector%20programs/readme/","text":"x86 booting At booting time, the boot software reads the first 512 bytes of some device (floppy disks, CD-ROM drive, or hard drive) and place it at address 0x7C00 The BIOS software is loaded from firmware into memory. Interrupt service routines (ISRs) It performs various operations: RAM detection and other hardware detection/initializations Attempts to find a device which will load the os. (floppy disks, CD-ROM drive, and then hard drive). Execute the bootsector software (16bits Real mode) Copy the first 512 bytes of some device into address 0x7C00 of RAM . This 512 btytes are called Boot sector or Master Boot Record . The last word (2 bytes) of the boot sector must be 0xAA55 . Change to 32 bits protected mode The bootsector shold have the Global Descriptor Table (GDT) , which defines memory segments and their protected-mode attributes. Set a single bit in a special CPU control register to make the actual switch. Now we can access longer registers (eax, ebx, ...). And adress up to 4GB of RAM. But we can no longer use BIOS calls :( http://kernelx.weebly.com/writing-a-bootsector.html Video memory The video memory of the VGA is mapped to the PC's memory via a window in the range between segments 0xA0000 and 0xBFFFF in the PC's real mode address space (A000:0000 and B000:FFFF ). Typically, these starting segments are: 0xA0000 for EGA/VGA graphics modes (64 KB) 0xB0000 for monochrome text mode (32 KB) 0xB8000 for color text mode and CGA-compatible graphics modes (32 KB) Interruptions a mechanism that allow the CPU temporarily to halt what it is doing and run some other, higher-priority instructions before returning to the original task. The BIOS loads into memory some pieces of code to handle this interruptions: Interrupt service routines (ISRs) Interrupt 0x10 causes the screen-related ISR to be invoked Interrupt 0x13, the disk-related I/O Set video mode ( AH = 0x00 and the 10h interruption ) AL Resolution Colors Video memory Free memory 0x12 640x480 16 (4 bits) 153.600 bytes (0xA000:AF9FF) (AFA00:AFFFF) 0x13 320x200 256 (8 bits) 64.000 bytes mov AH 0x00 ; necesary mov AL XXXX ; TEXT MODES --> Video memory start at 0xb8000 ; ; mov AL 00h 40x25 characters. 16 greys ; mov AL 01h 40x25 characters. 16 colors ; mov AL 02h 80x25 characters. 16 greys ; mov AL 03h 80x25 characters. 16 colors ; ; VGA (GRAPHIC) MODES --> Video memory start at 0xA000 ; ; mov AL 11h 2 colors ; mov AL 12h 640x480 16 colors 153.600 bytes ; mov AL 13h 320x200 256 colors 64.000 bytes (1 byte) int 0x10. ; Call the the 10h interruption","title":"x86 booting"},{"location":"4_assembly/x86/bootsector%20programs/readme/#x86-booting","text":"At booting time, the boot software reads the first 512 bytes of some device (floppy disks, CD-ROM drive, or hard drive) and place it at address 0x7C00 The BIOS software is loaded from firmware into memory. Interrupt service routines (ISRs) It performs various operations: RAM detection and other hardware detection/initializations Attempts to find a device which will load the os. (floppy disks, CD-ROM drive, and then hard drive). Execute the bootsector software (16bits Real mode) Copy the first 512 bytes of some device into address 0x7C00 of RAM . This 512 btytes are called Boot sector or Master Boot Record . The last word (2 bytes) of the boot sector must be 0xAA55 . Change to 32 bits protected mode The bootsector shold have the Global Descriptor Table (GDT) , which defines memory segments and their protected-mode attributes. Set a single bit in a special CPU control register to make the actual switch. Now we can access longer registers (eax, ebx, ...). And adress up to 4GB of RAM. But we can no longer use BIOS calls :( http://kernelx.weebly.com/writing-a-bootsector.html","title":"x86 booting"},{"location":"4_assembly/x86/bootsector%20programs/readme/#video-memory","text":"The video memory of the VGA is mapped to the PC's memory via a window in the range between segments 0xA0000 and 0xBFFFF in the PC's real mode address space (A000:0000 and B000:FFFF ). Typically, these starting segments are: 0xA0000 for EGA/VGA graphics modes (64 KB) 0xB0000 for monochrome text mode (32 KB) 0xB8000 for color text mode and CGA-compatible graphics modes (32 KB)","title":"Video memory"},{"location":"4_assembly/x86/bootsector%20programs/readme/#interruptions","text":"a mechanism that allow the CPU temporarily to halt what it is doing and run some other, higher-priority instructions before returning to the original task. The BIOS loads into memory some pieces of code to handle this interruptions: Interrupt service routines (ISRs) Interrupt 0x10 causes the screen-related ISR to be invoked Interrupt 0x13, the disk-related I/O","title":"Interruptions"},{"location":"4_assembly/x86/bootsector%20programs/readme/#set-video-mode-ah-0x00-and-the-10h-interruption","text":"AL Resolution Colors Video memory Free memory 0x12 640x480 16 (4 bits) 153.600 bytes (0xA000:AF9FF) (AFA00:AFFFF) 0x13 320x200 256 (8 bits) 64.000 bytes mov AH 0x00 ; necesary mov AL XXXX ; TEXT MODES --> Video memory start at 0xb8000 ; ; mov AL 00h 40x25 characters. 16 greys ; mov AL 01h 40x25 characters. 16 colors ; mov AL 02h 80x25 characters. 16 greys ; mov AL 03h 80x25 characters. 16 colors ; ; VGA (GRAPHIC) MODES --> Video memory start at 0xA000 ; ; mov AL 11h 2 colors ; mov AL 12h 640x480 16 colors 153.600 bytes ; mov AL 13h 320x200 256 colors 64.000 bytes (1 byte) int 0x10. ; Call the the 10h interruption","title":"Set video mode (AH = 0x00 and the 10h interruption)"},{"location":"4_assembly/z80/readme/","text":"Diagram CPU z80 |-----------------------| RAM (64KB) = 65536 Bytes | | |-------------------------| | General Registers | |0000... OS ...0FFF| | |--------|--------| |<================>|1000... OS ...1FFF| | | A | Flags | |<=== DATA BUS ===>|2000... OS ...2FFF| | |--------|--------| |<=== 8 BITS ===>|3000... OS ...3FFF| | | B | C | |<================>|4000... PROGRAM ...4FFF| OUR PROGRAM starts at 4000 fowards | |--------|--------| | |5000... PROGRAM ...5FFF| | | D | E | | |6000... PROGRAM ...6FFF| | |--------|--------| |=================>|7000... ~ ...7FFF| | | H . L | |=================>|8000... ~ ...8FFF| | |--------|--------| |=================>|9000... ~ ...9FFF| | |== ADRESS BUS ===>|A000... STACK ...AFFF| | |-----------------| |== 16 BITS ===>|B000... STACK ...BFFF| STACK starts at BFFF backwards | | Program Counter | |=================>|C000... VIDEO ...CFFF| VIDEO starts at C000 fowards | |-----------------| |=================>|D000... VIDEO ...DFFF| | | Stack Pointer | |=================>|E000... VIDEO ...EFFF| | |-----------------| | |F000... VIDEO ...FFFF| | | |-------------------------| |-----------------------| Z80 is LITTLE ENDIAN: Bytes are saved in reverse order in memory Bytes 45 67 FA -----> Memory FA 67 45 Instruction Set There are 256 different instrucctions Numbers: n 12 : for writing 12 in decimal. #0C : for writing 12 in hexadecimal. %00001100 : for writing 12 in binary. Write CPU registers Opcode Instruction Description Bytes Cycles Notes 3E __ LD A, n A = 8BITS_VALUE 2 06 __ LD B, n B = 8BITS_VALUE 2 26 __ LD H, n H = 8BITS_VALUE 2 21 LD LH, nn LH = 16BITS_VALUE 3 3A LD A, (ADR) A = *ADR 3 EB EX DE,HL DE = HL; HL = DE 1 Ex change DE and HL values. Operations in CPU Opcode Instruction Description Bytes Cycles Modifies Flags 3C INC A A = A + 1 1 3D DEC A A = A - 1 1 23 INC HL HL = HL + 1 1 D6 __ SUB n A = A - n 2 7 yes FE __ CP n A - n 2 7 yes 76 HALT Wait 0.003 secs 1 4 \u21aa\ufe0f Jumps Jump Absolute : Change the PC (Program Counter) to a given memory adress. Jump Relative : Sum to the current PC (Program Counter) a \u00b1128 value. Opcode Instruction Pseudocode Flags Cond. Description Bytes C3 JP ____ PC = ____ Jump Absolute (Big jump) 3 18 __ JR __ PC = PC + __ Jump Relative (\u00b1128 jump) 2 CD CALL ____ push(PC+1); PC = ____ Jump & save next addr on stack 3 C9 RET PC = pop() Jump back to last stack addr 1 C8 RET Z if Z: PC = pop() If Zero Jump to last stack addr 1 C2 JP NZ ____ if NZ: PC = ____ If Not Zero Jump Absolute (Big jump) 3 20 __ JR NZ, __ if NZ: PC = PC + __ If Not Zero Jump Relative (\u00b1128 jump) 2 C0 RET NZ if NZ: PC = pop() If Not Zero Jump to last stack addr 1 Write in memory Opcode Instruction Description Bytes Number of cycles 32 LD (ADR), A *ADR = A 3 Used for write video memory 22 LD (ADR), LH *ADR = LH 3 36 __ LD (HL), n *LH = VALUE 2 Assembly utility Write directly on memory with: | | | Example | |----------|-------------------------------|-----------------------------------------------------------------------------------| | DB | D efine B yte (8 bits) | DB #30, 10, %01100110 writes on memory: 30 0A 66 | | DW | D efine W ord (16 bits) | DW #C000, 64, %11110000 writes: 00 C0 40 00 00 FF (because little endian) | Assembly automatization extras There are several things from assembly language that Dont exists in machine code : $ Dollar sign to compute current memery psition of the program Function labels","title":"Diagram"},{"location":"4_assembly/z80/readme/#diagram","text":"CPU z80 |-----------------------| RAM (64KB) = 65536 Bytes | | |-------------------------| | General Registers | |0000... OS ...0FFF| | |--------|--------| |<================>|1000... OS ...1FFF| | | A | Flags | |<=== DATA BUS ===>|2000... OS ...2FFF| | |--------|--------| |<=== 8 BITS ===>|3000... OS ...3FFF| | | B | C | |<================>|4000... PROGRAM ...4FFF| OUR PROGRAM starts at 4000 fowards | |--------|--------| | |5000... PROGRAM ...5FFF| | | D | E | | |6000... PROGRAM ...6FFF| | |--------|--------| |=================>|7000... ~ ...7FFF| | | H . L | |=================>|8000... ~ ...8FFF| | |--------|--------| |=================>|9000... ~ ...9FFF| | |== ADRESS BUS ===>|A000... STACK ...AFFF| | |-----------------| |== 16 BITS ===>|B000... STACK ...BFFF| STACK starts at BFFF backwards | | Program Counter | |=================>|C000... VIDEO ...CFFF| VIDEO starts at C000 fowards | |-----------------| |=================>|D000... VIDEO ...DFFF| | | Stack Pointer | |=================>|E000... VIDEO ...EFFF| | |-----------------| | |F000... VIDEO ...FFFF| | | |-------------------------| |-----------------------| Z80 is LITTLE ENDIAN: Bytes are saved in reverse order in memory Bytes 45 67 FA -----> Memory FA 67 45","title":"Diagram"},{"location":"4_assembly/z80/readme/#instruction-set","text":"There are 256 different instrucctions","title":"Instruction Set"},{"location":"4_assembly/z80/readme/#numbers-n","text":"12 : for writing 12 in decimal. #0C : for writing 12 in hexadecimal. %00001100 : for writing 12 in binary.","title":"Numbers: n"},{"location":"4_assembly/z80/readme/#write-cpu-registers","text":"Opcode Instruction Description Bytes Cycles Notes 3E __ LD A, n A = 8BITS_VALUE 2 06 __ LD B, n B = 8BITS_VALUE 2 26 __ LD H, n H = 8BITS_VALUE 2 21 LD LH, nn LH = 16BITS_VALUE 3 3A LD A, (ADR) A = *ADR 3 EB EX DE,HL DE = HL; HL = DE 1 Ex change DE and HL values.","title":"Write CPU registers"},{"location":"4_assembly/z80/readme/#operations-in-cpu","text":"Opcode Instruction Description Bytes Cycles Modifies Flags 3C INC A A = A + 1 1 3D DEC A A = A - 1 1 23 INC HL HL = HL + 1 1 D6 __ SUB n A = A - n 2 7 yes FE __ CP n A - n 2 7 yes 76 HALT Wait 0.003 secs 1 4","title":"Operations in CPU"},{"location":"4_assembly/z80/readme/#jumps","text":"Jump Absolute : Change the PC (Program Counter) to a given memory adress. Jump Relative : Sum to the current PC (Program Counter) a \u00b1128 value. Opcode Instruction Pseudocode Flags Cond. Description Bytes C3 JP ____ PC = ____ Jump Absolute (Big jump) 3 18 __ JR __ PC = PC + __ Jump Relative (\u00b1128 jump) 2 CD CALL ____ push(PC+1); PC = ____ Jump & save next addr on stack 3 C9 RET PC = pop() Jump back to last stack addr 1 C8 RET Z if Z: PC = pop() If Zero Jump to last stack addr 1 C2 JP NZ ____ if NZ: PC = ____ If Not Zero Jump Absolute (Big jump) 3 20 __ JR NZ, __ if NZ: PC = PC + __ If Not Zero Jump Relative (\u00b1128 jump) 2 C0 RET NZ if NZ: PC = pop() If Not Zero Jump to last stack addr 1","title":"\u21aa\ufe0f Jumps"},{"location":"4_assembly/z80/readme/#write-in-memory","text":"Opcode Instruction Description Bytes Number of cycles 32 LD (ADR), A *ADR = A 3 Used for write video memory 22 LD (ADR), LH *ADR = LH 3 36 __ LD (HL), n *LH = VALUE 2","title":"Write in memory"},{"location":"4_assembly/z80/readme/#assembly-utility","text":"Write directly on memory with: | | | Example | |----------|-------------------------------|-----------------------------------------------------------------------------------| | DB | D efine B yte (8 bits) | DB #30, 10, %01100110 writes on memory: 30 0A 66 | | DW | D efine W ord (16 bits) | DW #C000, 64, %11110000 writes: 00 C0 40 00 00 FF (because little endian) |","title":"Assembly utility"},{"location":"4_assembly/z80/readme/#assembly-automatization-extras","text":"There are several things from assembly language that Dont exists in machine code : $ Dollar sign to compute current memery psition of the program Function labels","title":"Assembly automatization extras"},{"location":"5_hardware/hardware/","text":"Hardware Mother board 1*1030\u20ac = 1030\u20ac https://www.pccomponentes.com/asus-pro-ws-wrx80e-sage-se-wifi CPU 32 cores 1*3500\u20ac = 3500\u20ac 6 x GPU 3090 6*2200\u20ac = 13000\u20ac 256GB RAM (8 x 32GB) 8*225\u20ac = 1800\u20ac 16TB NVMe (8 x 2TB) 8*320\u20ac = 2650\u20ac 128TB HHD (8 x 8TB) 8*320\u20ac = 2650\u20ac ======================================= 25000\u20ac Componente Precio Inic. Mej 1 Mej 2 Mej 3 Mej 4 Mej 5 Mej 6 Mother board (ASUS PRO WS WRX80E) 1030\u20ac x1 CPU (AMD thradripper 5975WX) 3500\u20ac x1 GPU (Nvidia RTX 3090) 2200\u20ac x1 x1 x1 x1 x1 x1 x1 256GB RAM (8 x 32GB) 1800\u20ac Almacenamineto SSD M2 Almacenamineto SSD SATA Almacenamineto HDD Fuente Total 8530\u20ac Motherboard 128 PCIe 4.0 lines Opcion 1 7 GPUS 4 nvmes M.2 (con capacidad raid 0) Opcion 8 6 GPUS 8 nvmes M.2 (con capacidad raid 0) 8 ranuras de ram (con ECC) CPU: Threadripper Pro (gama 3000 o 5000) 8 sata ports https://www.youtube.com/watch?v=m5xd2ZizMOA MSI WS WRX80 CPU AMD | | | | PISTAS | | | | CORES | RAM MEMORY | PCIe4.0 | PRICE | SOCKET |-------------------------|-------|---------------------|---------|-------|------- | Ryzen 9 5900X | 12 | 128GB (2ch) | 20 | 500\u20ac | | Ryzen 9 5950X | 16 | 128GB (2ch) | 20 | 670\u20ac | | | | | | | | Threadripper 3960X | 24 | 512GB (4ch) 95 GB/s | 64 | 1700\u20ac | sTRX4 | Threadripper 3970X | 32 | 512GB (4ch) 95 GB/s | 64 | | sTRX4 | Threadripper 3990X | 64 | 512GB (4ch) 95 GB/s | 64 | | sTRX4 | | | | | | | Marzo 2021 | | | | | | Threadripper Pro 3945WX | 12 | 2TB (8ch) 205 GB/s | 128 | | WRX80 | Threadripper Pro 3955WX | 16 | 2TB (8ch) 205 GB/s | 128 | | | Threadripper Pro 3965WX | 24 | 2TB (8ch) 205 GB/s | 128 | | | Threadripper Pro 3975WX | 32 | 2TB (8ch) 205 GB/s | 128 | 3500\u20ac | ESTE ES EL DE ANDRES | Threadripper Pro 3995WX | 64 | 2TB (8ch) 205 GB/s | 128 | 6000..8000\u20ac | | | | | | | | Marzo 2022 | | | | | | Threadripper Pro 5945WX | 12 | 8 sWRX8 | Threadripper Pro 5955WX | 16 | 8 | Threadripper Pro 5965WX | 24 | 8 | Threadripper Pro 5975WX | 32 | 8 | Threadripper Pro 5995WX | 64 | 8 | | | Gama de servidores | | | EPYC 7001 | EPYC 7002 | EPYC 7003 https://gadgetversus.com/processor/amd-ryzen-threadripper-pro-3955wx-specs/ MAL: pero no lo recomineda pq tine contencion de memoria pq tiene 4 canales Andres recomienda la gama Threadripper antes que la Epyc pq caundo usas porcesoso de 1 solo hilo con 1 solo nueclo va mas r\u00e1pido. la serie pro de los thradriper (acaba en 5) tiene soporte para 8 canales en memoria PCIe PCIe Bits x1 x4 (Nvme) x8 x16 (GPU) 1.0 8b/10b 250 MB/s 1 GB/s 2 GB/s 4 GB/s 2.0 8b/10b 500 MB/s 2 GB/s 4 GB/s 8 GB/s 3.0 128b/130b 984.6 MB/s 3.938 GB/s 7.877 GB/s 15.754 GB/s 4.0 128b/130b 1.969 GB/s 7.877 GB/s 15.754 GB/s 31.508 GB/s GPU CUDA Tensor FP64 GPU Realese cores cores Memory Watts Price tFPLOS A2 Nov 2021 1280 24GB GDDR6 50 A10 Apr 2021 9216 24GB GDDR6 150 3090 (24GB) A6000 A16 Apr 2021 10240 4x16GB GDDR6 250 A30 Apr 2021 3584 24GB HBM2 165 5.000\u20ac (5,2) 10,3 A40 Oct 2020 10752 336 48GB GDDR6 300 5.000\u20ac A100 May 2020 6912 40GB HBM2 250 10.000\u20ac A100 May 2020 6912 40GB HBM2BULK250 10.000\u20ac A100 May 2020 6912 80GB HBM2 250 20.000\u20ac Discos duros lectura seq escritura seq HDD 80..150 MB/s 80..150 MB/s SSD SATA 500..550 MB/s 450..500 MB/s SSD M.2 NVMe PCIe 3.0 3000.3500 MB/s 3000.3500 MB/s SSD M.2 NVMe PCIe 4.0 5000.7000 MB/s 5000.7000 MB/s ojo! no todos los SSD M.2 del mercado son NVMe, tambi\u00e9n hay unidades M.2 SATA . Loss M.2 NVMe PCIe tienen un problema denominado Thermal Throttling: el rendimiento cae dr\u00e1sticamente cuando se da una temperatura muy elevada. Por lo tanto hay que refrigerarlos bien. | Que hace | Cuando usar --------|----------------------------------------------------------------------------------------------- RAID 0 | Todos los dicos actuan como 1 solo (se lee y escribe en paralelo en todos) | Cuando se busca velocidad RAID 1 | La inforacion se duplica | Cuando se busca fualt tolerance RAID 5 | caca RAID 6 | caca RAID 10 | Cuando se busca fualt tolerance con velocidad RAID 0: lass velocidades de lectura y escritura. Normalmente es la suma de las velocidades de las unidades menos un 10-15%. Maxiama prestaciones (velocidad de escritura y lectura): 1 SSD NVME M2 Varios SSD NVME M2 en RAID 0 Maxima seguridad a posibles fallos (fault tolerance) RAID 1 or RAID 5 (LVM) Logical Volume Management Hardware for servers disks -> RAID (mean time to failure (MTTF) of about 10 to 50 years) dual power supplies batteries and diesel generators for backup power hot-swappable CPUs When one component dies, the redundant component can take its place while the broken component is replaced. ECC RAM: Good for servers HDBaseT Protocolo para dejar el ordenador lejos (hasta 100 metros de distancia) y conetar todo (video, USB) por un cable Ethernet (categor\u00eda 5E para distancias cortas o categoria 6 o 7 para distancias largas).","title":"Hardware"},{"location":"5_hardware/hardware/#hardware","text":"Mother board 1*1030\u20ac = 1030\u20ac https://www.pccomponentes.com/asus-pro-ws-wrx80e-sage-se-wifi CPU 32 cores 1*3500\u20ac = 3500\u20ac 6 x GPU 3090 6*2200\u20ac = 13000\u20ac 256GB RAM (8 x 32GB) 8*225\u20ac = 1800\u20ac 16TB NVMe (8 x 2TB) 8*320\u20ac = 2650\u20ac 128TB HHD (8 x 8TB) 8*320\u20ac = 2650\u20ac ======================================= 25000\u20ac Componente Precio Inic. Mej 1 Mej 2 Mej 3 Mej 4 Mej 5 Mej 6 Mother board (ASUS PRO WS WRX80E) 1030\u20ac x1 CPU (AMD thradripper 5975WX) 3500\u20ac x1 GPU (Nvidia RTX 3090) 2200\u20ac x1 x1 x1 x1 x1 x1 x1 256GB RAM (8 x 32GB) 1800\u20ac Almacenamineto SSD M2 Almacenamineto SSD SATA Almacenamineto HDD Fuente Total 8530\u20ac","title":"Hardware"},{"location":"5_hardware/hardware/#motherboard","text":"128 PCIe 4.0 lines Opcion 1 7 GPUS 4 nvmes M.2 (con capacidad raid 0) Opcion 8 6 GPUS 8 nvmes M.2 (con capacidad raid 0) 8 ranuras de ram (con ECC) CPU: Threadripper Pro (gama 3000 o 5000) 8 sata ports https://www.youtube.com/watch?v=m5xd2ZizMOA MSI WS WRX80","title":"Motherboard"},{"location":"5_hardware/hardware/#cpu-amd","text":"| | | | PISTAS | | | | CORES | RAM MEMORY | PCIe4.0 | PRICE | SOCKET |-------------------------|-------|---------------------|---------|-------|------- | Ryzen 9 5900X | 12 | 128GB (2ch) | 20 | 500\u20ac | | Ryzen 9 5950X | 16 | 128GB (2ch) | 20 | 670\u20ac | | | | | | | | Threadripper 3960X | 24 | 512GB (4ch) 95 GB/s | 64 | 1700\u20ac | sTRX4 | Threadripper 3970X | 32 | 512GB (4ch) 95 GB/s | 64 | | sTRX4 | Threadripper 3990X | 64 | 512GB (4ch) 95 GB/s | 64 | | sTRX4 | | | | | | | Marzo 2021 | | | | | | Threadripper Pro 3945WX | 12 | 2TB (8ch) 205 GB/s | 128 | | WRX80 | Threadripper Pro 3955WX | 16 | 2TB (8ch) 205 GB/s | 128 | | | Threadripper Pro 3965WX | 24 | 2TB (8ch) 205 GB/s | 128 | | | Threadripper Pro 3975WX | 32 | 2TB (8ch) 205 GB/s | 128 | 3500\u20ac | ESTE ES EL DE ANDRES | Threadripper Pro 3995WX | 64 | 2TB (8ch) 205 GB/s | 128 | 6000..8000\u20ac | | | | | | | | Marzo 2022 | | | | | | Threadripper Pro 5945WX | 12 | 8 sWRX8 | Threadripper Pro 5955WX | 16 | 8 | Threadripper Pro 5965WX | 24 | 8 | Threadripper Pro 5975WX | 32 | 8 | Threadripper Pro 5995WX | 64 | 8 | | | Gama de servidores | | | EPYC 7001 | EPYC 7002 | EPYC 7003 https://gadgetversus.com/processor/amd-ryzen-threadripper-pro-3955wx-specs/ MAL: pero no lo recomineda pq tine contencion de memoria pq tiene 4 canales Andres recomienda la gama Threadripper antes que la Epyc pq caundo usas porcesoso de 1 solo hilo con 1 solo nueclo va mas r\u00e1pido. la serie pro de los thradriper (acaba en 5) tiene soporte para 8 canales en memoria","title":"CPU AMD"},{"location":"5_hardware/hardware/#pcie","text":"PCIe Bits x1 x4 (Nvme) x8 x16 (GPU) 1.0 8b/10b 250 MB/s 1 GB/s 2 GB/s 4 GB/s 2.0 8b/10b 500 MB/s 2 GB/s 4 GB/s 8 GB/s 3.0 128b/130b 984.6 MB/s 3.938 GB/s 7.877 GB/s 15.754 GB/s 4.0 128b/130b 1.969 GB/s 7.877 GB/s 15.754 GB/s 31.508 GB/s","title":"PCIe"},{"location":"5_hardware/hardware/#gpu","text":"CUDA Tensor FP64","title":"GPU"},{"location":"5_hardware/hardware/#gpu-realese-cores-cores-memory-watts-price-tfplos","text":"A2 Nov 2021 1280 24GB GDDR6 50 A10 Apr 2021 9216 24GB GDDR6 150 3090 (24GB) A6000 A16 Apr 2021 10240 4x16GB GDDR6 250 A30 Apr 2021 3584 24GB HBM2 165 5.000\u20ac (5,2) 10,3 A40 Oct 2020 10752 336 48GB GDDR6 300 5.000\u20ac A100 May 2020 6912 40GB HBM2 250 10.000\u20ac A100 May 2020 6912 40GB HBM2BULK250 10.000\u20ac A100 May 2020 6912 80GB HBM2 250 20.000\u20ac","title":"GPU   Realese   cores   cores   Memory       Watts  Price  tFPLOS"},{"location":"5_hardware/hardware/#discos-duros","text":"lectura seq escritura seq HDD 80..150 MB/s 80..150 MB/s SSD SATA 500..550 MB/s 450..500 MB/s SSD M.2 NVMe PCIe 3.0 3000.3500 MB/s 3000.3500 MB/s SSD M.2 NVMe PCIe 4.0 5000.7000 MB/s 5000.7000 MB/s ojo! no todos los SSD M.2 del mercado son NVMe, tambi\u00e9n hay unidades M.2 SATA . Loss M.2 NVMe PCIe tienen un problema denominado Thermal Throttling: el rendimiento cae dr\u00e1sticamente cuando se da una temperatura muy elevada. Por lo tanto hay que refrigerarlos bien. | Que hace | Cuando usar --------|----------------------------------------------------------------------------------------------- RAID 0 | Todos los dicos actuan como 1 solo (se lee y escribe en paralelo en todos) | Cuando se busca velocidad RAID 1 | La inforacion se duplica | Cuando se busca fualt tolerance RAID 5 | caca RAID 6 | caca RAID 10 | Cuando se busca fualt tolerance con velocidad RAID 0: lass velocidades de lectura y escritura. Normalmente es la suma de las velocidades de las unidades menos un 10-15%. Maxiama prestaciones (velocidad de escritura y lectura): 1 SSD NVME M2 Varios SSD NVME M2 en RAID 0 Maxima seguridad a posibles fallos (fault tolerance) RAID 1 or RAID 5 (LVM) Logical Volume Management","title":"Discos duros"},{"location":"5_hardware/hardware/#hardware-for-servers","text":"disks -> RAID (mean time to failure (MTTF) of about 10 to 50 years) dual power supplies batteries and diesel generators for backup power hot-swappable CPUs When one component dies, the redundant component can take its place while the broken component is replaced. ECC RAM: Good for servers","title":"Hardware for servers"},{"location":"5_hardware/hardware/#hdbaset","text":"Protocolo para dejar el ordenador lejos (hasta 100 metros de distancia) y conetar todo (video, USB) por un cable Ethernet (categor\u00eda 5E para distancias cortas o categoria 6 o 7 para distancias largas).","title":"HDBaseT"},{"location":"5_hardware/networking/readme/","text":"Networks and Communication HTTP + Websocket (no tiene TCP, seguridad, ...) Segun pedro muy malo para IoT, solo existe pq hay desarrolladores web MQTT (tiene TCP) Segun pedro mucho mejor para IoT OSI layers Application layer: (OSI 5-7) HTTP HTTPS MQTT (Message Queue Telemetry Transport) CoAP email (pop3) Transport layer (OSI 4) TCP UDP Network layer (OSI 3) IP Link layer (OSI 2) and Physical layer (OSI 1) Wire Ethernet (IEEE 802.3) Token bus (IEEE 802.4) Token ring (IEEE 802.5) (topolog\u00eda en anillo) USB Wireless Wi-Fi (IEEE 802.11x) Bluetooth (IEEE 802.15.1) Bluetooth LE GSM/GPRS/HSPA/LTE LoRa SigFox ZigBee (IEEE 802.15.4) (Para hacer red malla) NFC (Near Field Communication) Radio Frequency (RF de 433MHz) (RFID) Infrared (IR) Radio spectrum Altos en MHz -> Mas datos pero a poca distancia y sin obtaculos Bajos en MHz -> Menos datos pero gran distancia y gran poder de penetrac\u00edon en paredes. Band name Frequency Wavelength Example Uses Extremely low frequency (ELF) 3\u201330 Hz 100.000\u201310.000 km submarines Super low frequency (SLF) 30\u2013300 Hz 10,000\u20131,000 km submarines Ultra low frequency (ULF) 300\u20133000 Hz 1,000\u2013100 km submarines, mines and caves Very low frequency (VLF) 3\u201330 kHz 100\u201310 km Navigation Low frequency (LF) 30\u2013300 kHz 10\u20131 km Navigation, AM longwave Medium frequency (MF) 300\u20133,000 kHz 1,000\u2013100 m AM (medium-wave) High frequency (HF) 3\u201330 MHz 100\u201310 m Very high frequency (VHF) 30\u2013300 MHz 10\u20131 m FM, television Ultra high frequency (UHF) 300\u20133,000 MHz 1\u20130.1 m Mobile phones, Wifi 2.4G, Bluetooth, ZigBee, GPS Super high frequency (SHF) 3\u201330 GHz 10\u20131 cm Wifi 5G Extremely high frequency (EHF) 30\u2013300 GHz 10\u20131 mm Tremendously high frequency (THF) 300\u20133,000 GHz 1\u20130.1 mm Frecuancy Bands in Spain at 2020 | Techonology | Band | Frecuancies (MHz) | Cost | |------------------|--------:|---------| | Radio Frequency | 315 | | Private | | Radio Frequency | EU433 | 433.05-434.79 | Free | | Televisi\u00f3n (TDT) | 694-790 | Private | | LORA | 800 | Free | | Movil 4Genration | 820 | Private | | SigFox (Europe) | 868 | Private | | ZigBee (Europe) | 868 | Private | | Movistar | 900 | Private | | Orange | 1100 | Private | | Wifi 2.4G | 2400 | Free | | Wifi 5G | 5000 | Free | Movil 1G: Para hablar solamente por voz. Movil 2G: Conexi\u00f3n de voz y datos por GPRS (SMS). Movil 3G: Esta tecnolog\u00eda ofrece voz y datos de alta velocidad. Videollamadas y transferecia de datos. Movil 4G: Ofrece datos de alta velocidad pero no voz. Ha sido desarrollada debido al auge de los smartphones. Movil 5G: Se prev\u00e9 que el 2020 empiece a instalarse, aunque se desconoce su fecha de finalizaci\u00f3n. https://xacom.com/frecuencias-operadoras-espana-2g-3g-4g-5g/ La televisi\u00f3n anal\u00f3gica ha utilizado para su emisi\u00f3n desde principios del segundo cuarto del pasado siglo XX, parte de la banda de frecuencias de VHF (47 a 230 MHz) y parte de la banda de UHF (470 a 862 MHz la banda ISM para usos industriales, cient\u00edficos y m\u00e9dicos; en concreto, 868 MHz en Europa, 915 en Estados Unidos y 2,4 GHz en todo el mundo. Redes de baja pontecia 64 bytes de mensaje. (No cabe un protocolo como TCP. Son redes para mandar datos peque\u00f1os Es una radio muy b\u00e1sica. (no tiene comfirmac\u00edon de vuelta de que al receptor le ha llegado el mensaje) Trabajan en 800MHz. (es como una wifi muy grande). Con una antena de 5.600\u20ac cubres 24km de radio. (largo alcance) Este espectro es libre (fuera del espectro movil y tv) (no hay que pagar al gobierno para usarlo) 1.5 woltios de pila tienes 4 a\u00f1os de uso ininterrumpido. Ejemplos LORA LoWPAN sigfow (para mandar alarmas de suguridad) Sin clasificar en el modelo OSI Modbus SOAP sockets web socket web services Ultrawidband (UWB) Serial port UART HDBaseT: protocolo para dejar el ordenador lejos (hasta 100 metros de distancia) y conetar todo (video, USB) por un cable Ethernet (categor\u00eda 5E para distancias cortas o categoria 6 o 7 para distancias largas). Links https://aprendiendoarduino.wordpress.com/category/conectividad-iot/ https://es.slideshare.net/AnshuPandey5/iot-communication-protocols-socket-programming-with-python-mqtt-http https://realpython.com/python-sockets/ https://aprendiendoarduino.wordpress.com/2018/11/19/mqtt/ CURSOS https://www.coursera.org/learn/computer-networking https://www.coursera.org/specializations/networking-google-cloud-platform https://www.coursera.org/learn/fundamentals-network-communications#syllabus https://www.udacity.com/course/computer-networking--ud436 https://www.coursera.org/learn/iot-wireless-cloud-computing?specialization=emerging-technologies https://www.udacity.com/course/high-performance-computing--ud281 https://www.youtube.com/watch?v=FGdiSJakIS4 https://www.coursera.org/learn/ar-technologies-video-streaming?specialization=emerging-technologies https://learn.saylor.org/course/index.php?categoryid=9","title":"Readme"},{"location":"5_hardware/networking/readme/#osi-layers","text":"Application layer: (OSI 5-7) HTTP HTTPS MQTT (Message Queue Telemetry Transport) CoAP email (pop3) Transport layer (OSI 4) TCP UDP Network layer (OSI 3) IP Link layer (OSI 2) and Physical layer (OSI 1) Wire Ethernet (IEEE 802.3) Token bus (IEEE 802.4) Token ring (IEEE 802.5) (topolog\u00eda en anillo) USB Wireless Wi-Fi (IEEE 802.11x) Bluetooth (IEEE 802.15.1) Bluetooth LE GSM/GPRS/HSPA/LTE LoRa SigFox ZigBee (IEEE 802.15.4) (Para hacer red malla) NFC (Near Field Communication) Radio Frequency (RF de 433MHz) (RFID) Infrared (IR)","title":"OSI layers"},{"location":"5_hardware/networking/readme/#radio-spectrum","text":"Altos en MHz -> Mas datos pero a poca distancia y sin obtaculos Bajos en MHz -> Menos datos pero gran distancia y gran poder de penetrac\u00edon en paredes. Band name Frequency Wavelength Example Uses Extremely low frequency (ELF) 3\u201330 Hz 100.000\u201310.000 km submarines Super low frequency (SLF) 30\u2013300 Hz 10,000\u20131,000 km submarines Ultra low frequency (ULF) 300\u20133000 Hz 1,000\u2013100 km submarines, mines and caves Very low frequency (VLF) 3\u201330 kHz 100\u201310 km Navigation Low frequency (LF) 30\u2013300 kHz 10\u20131 km Navigation, AM longwave Medium frequency (MF) 300\u20133,000 kHz 1,000\u2013100 m AM (medium-wave) High frequency (HF) 3\u201330 MHz 100\u201310 m Very high frequency (VHF) 30\u2013300 MHz 10\u20131 m FM, television Ultra high frequency (UHF) 300\u20133,000 MHz 1\u20130.1 m Mobile phones, Wifi 2.4G, Bluetooth, ZigBee, GPS Super high frequency (SHF) 3\u201330 GHz 10\u20131 cm Wifi 5G Extremely high frequency (EHF) 30\u2013300 GHz 10\u20131 mm Tremendously high frequency (THF) 300\u20133,000 GHz 1\u20130.1 mm","title":"Radio spectrum"},{"location":"5_hardware/networking/readme/#frecuancy-bands-in-spain-at-2020","text":"| Techonology | Band | Frecuancies (MHz) | Cost | |------------------|--------:|---------| | Radio Frequency | 315 | | Private | | Radio Frequency | EU433 | 433.05-434.79 | Free | | Televisi\u00f3n (TDT) | 694-790 | Private | | LORA | 800 | Free | | Movil 4Genration | 820 | Private | | SigFox (Europe) | 868 | Private | | ZigBee (Europe) | 868 | Private | | Movistar | 900 | Private | | Orange | 1100 | Private | | Wifi 2.4G | 2400 | Free | | Wifi 5G | 5000 | Free | Movil 1G: Para hablar solamente por voz. Movil 2G: Conexi\u00f3n de voz y datos por GPRS (SMS). Movil 3G: Esta tecnolog\u00eda ofrece voz y datos de alta velocidad. Videollamadas y transferecia de datos. Movil 4G: Ofrece datos de alta velocidad pero no voz. Ha sido desarrollada debido al auge de los smartphones. Movil 5G: Se prev\u00e9 que el 2020 empiece a instalarse, aunque se desconoce su fecha de finalizaci\u00f3n. https://xacom.com/frecuencias-operadoras-espana-2g-3g-4g-5g/ La televisi\u00f3n anal\u00f3gica ha utilizado para su emisi\u00f3n desde principios del segundo cuarto del pasado siglo XX, parte de la banda de frecuencias de VHF (47 a 230 MHz) y parte de la banda de UHF (470 a 862 MHz la banda ISM para usos industriales, cient\u00edficos y m\u00e9dicos; en concreto, 868 MHz en Europa, 915 en Estados Unidos y 2,4 GHz en todo el mundo.","title":"Frecuancy Bands in Spain at 2020"},{"location":"5_hardware/networking/readme/#redes-de-baja-pontecia","text":"64 bytes de mensaje. (No cabe un protocolo como TCP. Son redes para mandar datos peque\u00f1os Es una radio muy b\u00e1sica. (no tiene comfirmac\u00edon de vuelta de que al receptor le ha llegado el mensaje) Trabajan en 800MHz. (es como una wifi muy grande). Con una antena de 5.600\u20ac cubres 24km de radio. (largo alcance) Este espectro es libre (fuera del espectro movil y tv) (no hay que pagar al gobierno para usarlo) 1.5 woltios de pila tienes 4 a\u00f1os de uso ininterrumpido. Ejemplos LORA LoWPAN sigfow (para mandar alarmas de suguridad)","title":"Redes de baja pontecia"},{"location":"5_hardware/networking/readme/#sin-clasificar-en-el-modelo-osi","text":"Modbus SOAP sockets web socket web services Ultrawidband (UWB) Serial port UART HDBaseT: protocolo para dejar el ordenador lejos (hasta 100 metros de distancia) y conetar todo (video, USB) por un cable Ethernet (categor\u00eda 5E para distancias cortas o categoria 6 o 7 para distancias largas).","title":"Sin clasificar en el modelo OSI"},{"location":"5_hardware/networking/readme/#links","text":"https://aprendiendoarduino.wordpress.com/category/conectividad-iot/ https://es.slideshare.net/AnshuPandey5/iot-communication-protocols-socket-programming-with-python-mqtt-http https://realpython.com/python-sockets/ https://aprendiendoarduino.wordpress.com/2018/11/19/mqtt/ CURSOS https://www.coursera.org/learn/computer-networking https://www.coursera.org/specializations/networking-google-cloud-platform https://www.coursera.org/learn/fundamentals-network-communications#syllabus https://www.udacity.com/course/computer-networking--ud436 https://www.coursera.org/learn/iot-wireless-cloud-computing?specialization=emerging-technologies https://www.udacity.com/course/high-performance-computing--ud281 https://www.youtube.com/watch?v=FGdiSJakIS4 https://www.coursera.org/learn/ar-technologies-video-streaming?specialization=emerging-technologies https://learn.saylor.org/course/index.php?categoryid=9","title":"Links"},{"location":"others/algorithims/","text":"Shortest path dijkstra A* https://www.youtube.com/watch?v=A60q6dcoCjw SAT solvers Factorizaton algos Books The Art of Computer Programming","title":"Shortest path"},{"location":"others/algorithims/#shortest-path","text":"dijkstra A* https://www.youtube.com/watch?v=A60q6dcoCjw","title":"Shortest path"},{"location":"others/algorithims/#sat-solvers","text":"","title":"SAT solvers"},{"location":"others/algorithims/#factorizaton-algos","text":"","title":"Factorizaton algos"},{"location":"others/algorithims/#books","text":"The Art of Computer Programming","title":"Books"},{"location":"others/install_arch_linux/","text":"Install Manjaro Entra en la Bios (tecla ?) y detecta tu sistema | Bios (or Legacy) | UEFI | |-------------------------|----------------------------| | MRB (Master Boot Rcord) | GPT (GUID Partition Table) | | Antiguo | Nuevo | [ ] Enable UEFI [ ] Disable Secure Boot [ ] Disable Fast Boot Inserta USB de Manjaro con el PC apagado Elije partici\u00f3n de arraque al encender (tecla F12) Y elije arrancar desde USB en modo UEFI Selecciona el Driver : free : Si no tienes GPU nonfree : Si tienes GPU Nvidia (o AMD) Particiones Size Type File system Mount point Flags Partici\u00f3n de arranque 100 MB GPT fat32 /boot/efi boot, esp Partici\u00f3n SWAP (opcional) 16 GB GPT linuxswap swap Partici\u00f3n para Manjaro Resto GPT ext4 / root iso image to USB sudo fdisk -l buscar localizaci\u00f3n del USB (sdb, sdc, etc.). sudo dd bs=4M if=/path/to/downloaded/iso of=/dev/sdx status=progress oflag=sync Copiar (reemplazar sdx por la correcta ubicaci\u00f3n). # HARDWARE # Processor x86_64 # Min RAM: 512 MB RAM # Min Space: 800 MB # SOFTWARE # User: root # Shell: zsh # Editors: nano vi vim ################################################ ######## ON WORKING COMPUTER ######## ################################################ # 1. Download iso # 2. Identify USB pen lsblk fdisk -l # 3. Copy iso to pendrive dd if=Downloads/archlinux.iso of=/dev/sdb status=\"progress\" # very careful with correct \"of\" dd bs=4M if=/path/to/antergos-x86_64.iso of=/dev/sdX status=progress && sync ################################################ ######## PRE-INTALLATION ######## ################################################ ########################################## Keyboard and font ls /usr/share/kbd/keymaps/**/*.map.gz # OPTIONAL List available keyboards loadkeys es # Set spanish keyboard ls /usr/share/kbd/consolefonts/ # OPTIONAL See fonts setfont # OPTIONAL Set font ########################################## Verify Boot mode # TODO: UEFI vs BIOS # Mejor usar BIOS # UEFI activated if the directory exists. ls /sys/firmware/efi/efivars # If the directory does not exist, the system may be booted in BIOS ########################################## Connect to the Internet # dhcpcd is activated. Check connection with ping ping archlinux.org ########################################## Update the system clock # Ensure the system clock is accurate timedatectl set-ntp true ########################################## Partition # 1) Identify disks lsblk # Option 1 fdisk -l # Option 2 # 2) Particionate a disk (sda, sdb, ...) # 4 needed partitions: # sda 256G # \u251c\u2500sda1 /boot/efi 200..512 = 256M # \u251c\u2500sda2 [SWAP] 16..32 = 32G # \u251c\u2500sda3 / 25..32 = 32G # \u2514\u2500sda4 /home rest # # sda 256G # \u251c\u2500sda1 /boot 200..512 = 256M # \u251c\u2500sda2 [SWAP] 16..32 = 32G # \u251c\u2500sda3 / 25..32 = 32G # \u2514\u2500sda4 /home rest fdisk /dev/sda # Option 1 m # Help p # Print status d # Delete current partitons n # Create new partition: Boot (200MB) # type: default (primary) # number: default (1) # fisrt sector: default # last sector: +200M # Remove signature: Yes # repeat for rest w # Write changes parted /dev/sda # Option 2 mklabel gpt mkpart ESP fat32 1MiB 513MiB set 1 boot on mkpart primary linux-swap 513MiB 4.5GiB mkpart primary ext4 4.5GiB 100% # 3) Format partitions mkfs.ext4 /dev/sda1 # Boot mkswap /dev/sda2 # Swap swapon /dev/sda2 # Swap mkfs.ext4 /dev/sda3 # Root mkfs.ext4 /dev/sda4 # Home # 4) Mount mount /dev/sda3 /mnt # Mount root mkdir /mnt/boot # Mount boot mount /dev/sda1 /mnt/boot # Mount boot mkdir /mnt/home # Mount home mount /dev/sda4 /mnt/home # Mount home ################################################ ######## INTALLATION ######## ################################################ ########################################## Install base packages pacstrap /mnt base base-devel ########################################## Generate /est/fstab file genfstab -U /mnt >> /mnt/etc/fstab ########################################## Bootable # Enter the system # Command line from pendrive to my system arch-chroot /mnt ########################################## Time zone ln -sf /usr/share/zoneinfo/Europe/Madrid /etc/localtime hwclock --systohc ########################################## System language # Set the system language nano /etc/locale.gen # Uncomment en_US.UTF-8 UTF-8 locale-gen nano /etc/locale.conf # (new file) # LANG=es_ES.UTF-8 # LANG=en_US.UTF-8 ########################################## Keyboard nano /etc/vconsole.conf # KEYMAP=es ########################################## Hostname nano /etc/hostname # (new file) # pc nano /etc/hosts # (separate with tabs) # 127.0.0.1 localhost.localdomain localhost # ::1 localhost.localdomain localhost # 127.0.1.1 pc.localdomain pc ########################################## Network config pacman -S networkmanager # install systemctl enable NetworkManager # Start on boot ########################################## Root pass passwd ########################################## Boot loader pacman -S grub intel-ucode # OPTION A: Install grub (for BIOS) grub-install /dev/sda # OPTION B: Install grub (for UEFI) grub-install --target=x86_64-efi --efi-directory=boot --bootloader-id=GRUB grub-install --target=x86_64-efi --efi-directory=boot/efi --bootloader-id=GRUB # Config. (Microcode updates will be added automatically) grub-mkconfig -o /boot/grub/grub.cfg ########################################## Reboot exit umount -R /mnt reboot # login: root # enter password ################################################ ######## POST-INTALLATION ######## ################################################ Read https://wiki.archlinux.org/index.php/General_recommendations editar /etc/pacman.conf para activar el repositorio [community] ########################################## Add user #useradd -m -g wheel -s /bin/bash javi useradd --create-home --gid wheel --shell /bin/bash javi passwd javi ########################################## Trim support for SSD # https://wiki.archlinux.org/index.php/Solid_State_Drive#TRIM lsblk -D # Verify trim support # disc-gran/disc-max should not be empty if enabled # The util-linux package provides fstrim.service and fstrim.timer # Enabling the timer will activate the service weekly systemctl start fstrim.timer systemctl enable fstrim.timer ########################################## Install LTS Kernel # https://youtu.be/b-H3jURTgqk uname -r # Check your current kernel sudo pacman -S linux-lts # Install LTS kernel pacman -R linux # [OPTIONAL] Remove the standard kernel grub-mkconfig -o /boot/grub/grub.cfg # Reconfigure GRUB sudo pacman -S linux-lts-headers # Install LTS headers sudo reboot # Reboot uname -r # Check new current kernel # Note, for syslinux you'll need to edit the syslinux config file in /boot/syslinux/syslinux.cfg accordingly, # just point everything to the -lts kernel. ########################################## Install microcode (for Intel) sudo pacman -S intel-ucode # Install microcode grub-mkconfig -o /boot/grub/grub.cfg # Reconfigure GRUB ########################################## Disable GRUB delay # Add the following to /etc/default/grub: # achieve the fastest possible boot: GRUB_FORCE_HIDDEN_MENU=\"true\" # Then put file 31_hold_shift to /etc/grub.d/. # Download 31_hold_shift https://goo.gl/nac6Kp # Make it executable, and regenerate the grub configuration: sudo chmod a+x /etc/grub.d/31_hold_shift sudo grub-mkconfig -o /boot/grub/grub.cfg ########################################## Install key packages sudo pacman -S adobe-source-sans-pro-fonts aspell-en enchant gst-libav gst-plugins-good \\ hunspell-en icedtea-web jre8-openjdk languagetool libmythes mythes-en pkgstats \\ ttf-anonymous-pro ttf-bitstream-vera ttf-dejavu ttf-droid ttf-gentium ttf-liberation ttf-ubuntu-font-family ########################################## Firewall # iptables is already installed. I like ufw. pacman -S ufw # Install ufw ufw enable # Enable it only once, when package is installed ufw status verbose # Check its status systemctl start ufw # Start the firewall systemctl enable ufw # Enable the start-up with the system [option a] systemctl enable ufw.service # Enable the start-up with the system [option b] ########################################## Encrypt your home directory ########################################## Optimize pacman's database access speeds sudo pacman-optimize ########################################## Check for errors sudo systemctl --failed sudo journalctl -p 3 -xb ########################################## Backup the system sudo rsync -aAXvP --delete --exclude=/dev/* --exclude=/proc/* --exclude=/sys/* --exclude=/tmp/* --exclude=/run/* --exclude=/mnt/* --exclude=/media/* --exclude=/lost+found --exclude=/home/.ecryptfs / /mnt/backupDestination/ ################################################ ######## GRAPHICAL ENVIROMENT ######## ################################################ If you want to use the latest nvidia drivers in the official repository, you can choose libglvnd (and not nvidia-304xx-utils). ########################################## Xorg pacman -S xorg-server xorg-xinit pacman -S xterm # Necessary?? # It will read from ~/.xinitrc to know what to start nano ~/.xinitrc exec i3 # You can start X by running: xinit startx ENTER ENTER ########################################## Display manager (login screen) # Terminal login screen: # nano ~/.profile ~/.bash_profile if [[ \"$(tty)\" == '/dev/tty1' ]]; then exec startx fi # or use a Display manager (login screen) pacman -S lightdb lightdm-gtk-greeter systemctl enable lightdm.service ########################################## Colors # Colors in terminal for bash, pacman and nano # https://youtu.be/giAb4Ckh8BQ # Install i3 window manager pacman -S i3-gaps i3status rxvt-unicode dmenu # Other things needed for a wm nano ~/.xinitrc # exec i3 # Fonts pacman -S ttf-linux-libertine ttf-inconsolata # Or just pacman -S noto-fonts # Manually edit ~/.config/fontconfig/fonts.conf ################################################ ######## DEEP LEARNING SETUP ######## ################################################ # READ https://www.hackster.io/Ladvien/gpu-accelerated-deep-learning-environment-on-arch-linux-16631b dialog --backtitle \"Deep learning with Arch linux\"\\ --title \"Welcome!\"\\ --msgbox \"\\nThis is the configuration to make your perfect linux distro.\"\\ 8 40 dialog --backtitle \"CPU Selection\" \\ --radiolist \"Select CPU type:\" 10 40 4 \\ 1 386SX off \\ 2 386DX on \\ 3 486SX off \\ 4 486DX off ########################################## Nvidia drivers # Identify your card lspci | grep -i nvidia lspci | grep -e VGA -e 3D lspci -k | grep -A 2 -i \"VGA\" # Install drivers and driver's utils pacman -S nvidia # Nvidia drivers pacman -S nvidia-utils # Nvidia driver's utils reboot ######################################## GPU computation pacman -S cuda # Nvidia API for GPGPU pacman -S cudnn # Nvidia primitives for Neural Networks #Magma # Linear Algebra for OpenCL and CUDA and heteregenous many-core systems ######################################## Python It is always preferred to use pacman to install software. If you must use pip, use a virtual environment or with \"pip install --user\" to avoid conflicting with packages in /usr. pacman -S python # Install Python 3 pacman -S jupyter-notebook # Jupyter: Python notebooks pacman -S python-numpy # Numpy: Matrix manipulation pacman -S python-scipy # Scipy: Scientific library for Python. Sparse matrices support pacman -S python-pandas # Pandas: Deal with data pacman -S python-scikit-learn # Scikit-learn: Machine learning pacman -S python-matplotlib # Matplotlib: Visualization pacman -S python-seaborn # Seaborn: Visualization pacman -S python-nltk # NLTK: Natural language processing in Python pacman -S python-pip # The PyPA recommended tool for installing Python packages pacman -S gtkglext # opengl extensions for gtk2 (necesario para opencv) pacman -S opencv opencv-samples # Open Source Computer Vision Library pacman -S graphviz # Graph visualization software pacman -S hdf5 # General purpose library and file format for storing scientific data pip install --user bcolz pip install --user graphviz # Interface for python pip install --user sklearn-pandas pip install --user isoweek AUR: python-numba ######################################## Deep larining frameworks pacman -S python-pytorch-cuda # Pytorch pacman -S python-tensorflow-opt-cuda # Tensorflow pacman -S tensorflow-opt-cuda # Tensorflow pacman -S tensorboard # Tensorboard AUR: python-torchvision AUR: python-keras # Keras API for Tensorflow AUR: python-theano AUR: caffe AUR: mxnet # MXNet: Apache DL AUR: cntk # CNTK: Microsoft DL Nervana Neon, Chainer, DyNet, MinPy ######################################## Other packages # Monitoring htop - Monitor CPU, RAM, load, kill programs nvidia-smi - Monitor Nvidia GPU CSV manipulation xsv - The fastest, multi-processing CSV library. Written in Rust. Rapid Development, Research Jupyter - Code Python, R, Haskell, Julia with direct feedback in your browser jupyter_contrib_nbextensions - Extensions for jupyter (commenting code, ...)","title":"Install [Manjaro](https://manjaro.org/download)"},{"location":"others/install_arch_linux/#install-manjaro","text":"Entra en la Bios (tecla ?) y detecta tu sistema | Bios (or Legacy) | UEFI | |-------------------------|----------------------------| | MRB (Master Boot Rcord) | GPT (GUID Partition Table) | | Antiguo | Nuevo | [ ] Enable UEFI [ ] Disable Secure Boot [ ] Disable Fast Boot Inserta USB de Manjaro con el PC apagado Elije partici\u00f3n de arraque al encender (tecla F12) Y elije arrancar desde USB en modo UEFI Selecciona el Driver : free : Si no tienes GPU nonfree : Si tienes GPU Nvidia (o AMD) Particiones Size Type File system Mount point Flags Partici\u00f3n de arranque 100 MB GPT fat32 /boot/efi boot, esp Partici\u00f3n SWAP (opcional) 16 GB GPT linuxswap swap Partici\u00f3n para Manjaro Resto GPT ext4 / root","title":"Install Manjaro"},{"location":"others/install_arch_linux/#iso-image-to-usb","text":"sudo fdisk -l buscar localizaci\u00f3n del USB (sdb, sdc, etc.). sudo dd bs=4M if=/path/to/downloaded/iso of=/dev/sdx status=progress oflag=sync Copiar (reemplazar sdx por la correcta ubicaci\u00f3n). # HARDWARE # Processor x86_64 # Min RAM: 512 MB RAM # Min Space: 800 MB # SOFTWARE # User: root # Shell: zsh # Editors: nano vi vim ################################################ ######## ON WORKING COMPUTER ######## ################################################ # 1. Download iso # 2. Identify USB pen lsblk fdisk -l # 3. Copy iso to pendrive dd if=Downloads/archlinux.iso of=/dev/sdb status=\"progress\" # very careful with correct \"of\" dd bs=4M if=/path/to/antergos-x86_64.iso of=/dev/sdX status=progress && sync ################################################ ######## PRE-INTALLATION ######## ################################################ ########################################## Keyboard and font ls /usr/share/kbd/keymaps/**/*.map.gz # OPTIONAL List available keyboards loadkeys es # Set spanish keyboard ls /usr/share/kbd/consolefonts/ # OPTIONAL See fonts setfont # OPTIONAL Set font ########################################## Verify Boot mode # TODO: UEFI vs BIOS # Mejor usar BIOS # UEFI activated if the directory exists. ls /sys/firmware/efi/efivars # If the directory does not exist, the system may be booted in BIOS ########################################## Connect to the Internet # dhcpcd is activated. Check connection with ping ping archlinux.org ########################################## Update the system clock # Ensure the system clock is accurate timedatectl set-ntp true ########################################## Partition # 1) Identify disks lsblk # Option 1 fdisk -l # Option 2 # 2) Particionate a disk (sda, sdb, ...) # 4 needed partitions: # sda 256G # \u251c\u2500sda1 /boot/efi 200..512 = 256M # \u251c\u2500sda2 [SWAP] 16..32 = 32G # \u251c\u2500sda3 / 25..32 = 32G # \u2514\u2500sda4 /home rest # # sda 256G # \u251c\u2500sda1 /boot 200..512 = 256M # \u251c\u2500sda2 [SWAP] 16..32 = 32G # \u251c\u2500sda3 / 25..32 = 32G # \u2514\u2500sda4 /home rest fdisk /dev/sda # Option 1 m # Help p # Print status d # Delete current partitons n # Create new partition: Boot (200MB) # type: default (primary) # number: default (1) # fisrt sector: default # last sector: +200M # Remove signature: Yes # repeat for rest w # Write changes parted /dev/sda # Option 2 mklabel gpt mkpart ESP fat32 1MiB 513MiB set 1 boot on mkpart primary linux-swap 513MiB 4.5GiB mkpart primary ext4 4.5GiB 100% # 3) Format partitions mkfs.ext4 /dev/sda1 # Boot mkswap /dev/sda2 # Swap swapon /dev/sda2 # Swap mkfs.ext4 /dev/sda3 # Root mkfs.ext4 /dev/sda4 # Home # 4) Mount mount /dev/sda3 /mnt # Mount root mkdir /mnt/boot # Mount boot mount /dev/sda1 /mnt/boot # Mount boot mkdir /mnt/home # Mount home mount /dev/sda4 /mnt/home # Mount home ################################################ ######## INTALLATION ######## ################################################ ########################################## Install base packages pacstrap /mnt base base-devel ########################################## Generate /est/fstab file genfstab -U /mnt >> /mnt/etc/fstab ########################################## Bootable # Enter the system # Command line from pendrive to my system arch-chroot /mnt ########################################## Time zone ln -sf /usr/share/zoneinfo/Europe/Madrid /etc/localtime hwclock --systohc ########################################## System language # Set the system language nano /etc/locale.gen # Uncomment en_US.UTF-8 UTF-8 locale-gen nano /etc/locale.conf # (new file) # LANG=es_ES.UTF-8 # LANG=en_US.UTF-8 ########################################## Keyboard nano /etc/vconsole.conf # KEYMAP=es ########################################## Hostname nano /etc/hostname # (new file) # pc nano /etc/hosts # (separate with tabs) # 127.0.0.1 localhost.localdomain localhost # ::1 localhost.localdomain localhost # 127.0.1.1 pc.localdomain pc ########################################## Network config pacman -S networkmanager # install systemctl enable NetworkManager # Start on boot ########################################## Root pass passwd ########################################## Boot loader pacman -S grub intel-ucode # OPTION A: Install grub (for BIOS) grub-install /dev/sda # OPTION B: Install grub (for UEFI) grub-install --target=x86_64-efi --efi-directory=boot --bootloader-id=GRUB grub-install --target=x86_64-efi --efi-directory=boot/efi --bootloader-id=GRUB # Config. (Microcode updates will be added automatically) grub-mkconfig -o /boot/grub/grub.cfg ########################################## Reboot exit umount -R /mnt reboot # login: root # enter password ################################################ ######## POST-INTALLATION ######## ################################################ Read https://wiki.archlinux.org/index.php/General_recommendations editar /etc/pacman.conf para activar el repositorio [community] ########################################## Add user #useradd -m -g wheel -s /bin/bash javi useradd --create-home --gid wheel --shell /bin/bash javi passwd javi ########################################## Trim support for SSD # https://wiki.archlinux.org/index.php/Solid_State_Drive#TRIM lsblk -D # Verify trim support # disc-gran/disc-max should not be empty if enabled # The util-linux package provides fstrim.service and fstrim.timer # Enabling the timer will activate the service weekly systemctl start fstrim.timer systemctl enable fstrim.timer ########################################## Install LTS Kernel # https://youtu.be/b-H3jURTgqk uname -r # Check your current kernel sudo pacman -S linux-lts # Install LTS kernel pacman -R linux # [OPTIONAL] Remove the standard kernel grub-mkconfig -o /boot/grub/grub.cfg # Reconfigure GRUB sudo pacman -S linux-lts-headers # Install LTS headers sudo reboot # Reboot uname -r # Check new current kernel # Note, for syslinux you'll need to edit the syslinux config file in /boot/syslinux/syslinux.cfg accordingly, # just point everything to the -lts kernel. ########################################## Install microcode (for Intel) sudo pacman -S intel-ucode # Install microcode grub-mkconfig -o /boot/grub/grub.cfg # Reconfigure GRUB ########################################## Disable GRUB delay # Add the following to /etc/default/grub: # achieve the fastest possible boot: GRUB_FORCE_HIDDEN_MENU=\"true\" # Then put file 31_hold_shift to /etc/grub.d/. # Download 31_hold_shift https://goo.gl/nac6Kp # Make it executable, and regenerate the grub configuration: sudo chmod a+x /etc/grub.d/31_hold_shift sudo grub-mkconfig -o /boot/grub/grub.cfg ########################################## Install key packages sudo pacman -S adobe-source-sans-pro-fonts aspell-en enchant gst-libav gst-plugins-good \\ hunspell-en icedtea-web jre8-openjdk languagetool libmythes mythes-en pkgstats \\ ttf-anonymous-pro ttf-bitstream-vera ttf-dejavu ttf-droid ttf-gentium ttf-liberation ttf-ubuntu-font-family ########################################## Firewall # iptables is already installed. I like ufw. pacman -S ufw # Install ufw ufw enable # Enable it only once, when package is installed ufw status verbose # Check its status systemctl start ufw # Start the firewall systemctl enable ufw # Enable the start-up with the system [option a] systemctl enable ufw.service # Enable the start-up with the system [option b] ########################################## Encrypt your home directory ########################################## Optimize pacman's database access speeds sudo pacman-optimize ########################################## Check for errors sudo systemctl --failed sudo journalctl -p 3 -xb ########################################## Backup the system sudo rsync -aAXvP --delete --exclude=/dev/* --exclude=/proc/* --exclude=/sys/* --exclude=/tmp/* --exclude=/run/* --exclude=/mnt/* --exclude=/media/* --exclude=/lost+found --exclude=/home/.ecryptfs / /mnt/backupDestination/ ################################################ ######## GRAPHICAL ENVIROMENT ######## ################################################ If you want to use the latest nvidia drivers in the official repository, you can choose libglvnd (and not nvidia-304xx-utils). ########################################## Xorg pacman -S xorg-server xorg-xinit pacman -S xterm # Necessary?? # It will read from ~/.xinitrc to know what to start nano ~/.xinitrc exec i3 # You can start X by running: xinit startx ENTER ENTER ########################################## Display manager (login screen) # Terminal login screen: # nano ~/.profile ~/.bash_profile if [[ \"$(tty)\" == '/dev/tty1' ]]; then exec startx fi # or use a Display manager (login screen) pacman -S lightdb lightdm-gtk-greeter systemctl enable lightdm.service ########################################## Colors # Colors in terminal for bash, pacman and nano # https://youtu.be/giAb4Ckh8BQ # Install i3 window manager pacman -S i3-gaps i3status rxvt-unicode dmenu # Other things needed for a wm nano ~/.xinitrc # exec i3 # Fonts pacman -S ttf-linux-libertine ttf-inconsolata # Or just pacman -S noto-fonts # Manually edit ~/.config/fontconfig/fonts.conf ################################################ ######## DEEP LEARNING SETUP ######## ################################################ # READ https://www.hackster.io/Ladvien/gpu-accelerated-deep-learning-environment-on-arch-linux-16631b dialog --backtitle \"Deep learning with Arch linux\"\\ --title \"Welcome!\"\\ --msgbox \"\\nThis is the configuration to make your perfect linux distro.\"\\ 8 40 dialog --backtitle \"CPU Selection\" \\ --radiolist \"Select CPU type:\" 10 40 4 \\ 1 386SX off \\ 2 386DX on \\ 3 486SX off \\ 4 486DX off ########################################## Nvidia drivers # Identify your card lspci | grep -i nvidia lspci | grep -e VGA -e 3D lspci -k | grep -A 2 -i \"VGA\" # Install drivers and driver's utils pacman -S nvidia # Nvidia drivers pacman -S nvidia-utils # Nvidia driver's utils reboot ######################################## GPU computation pacman -S cuda # Nvidia API for GPGPU pacman -S cudnn # Nvidia primitives for Neural Networks #Magma # Linear Algebra for OpenCL and CUDA and heteregenous many-core systems ######################################## Python It is always preferred to use pacman to install software. If you must use pip, use a virtual environment or with \"pip install --user\" to avoid conflicting with packages in /usr. pacman -S python # Install Python 3 pacman -S jupyter-notebook # Jupyter: Python notebooks pacman -S python-numpy # Numpy: Matrix manipulation pacman -S python-scipy # Scipy: Scientific library for Python. Sparse matrices support pacman -S python-pandas # Pandas: Deal with data pacman -S python-scikit-learn # Scikit-learn: Machine learning pacman -S python-matplotlib # Matplotlib: Visualization pacman -S python-seaborn # Seaborn: Visualization pacman -S python-nltk # NLTK: Natural language processing in Python pacman -S python-pip # The PyPA recommended tool for installing Python packages pacman -S gtkglext # opengl extensions for gtk2 (necesario para opencv) pacman -S opencv opencv-samples # Open Source Computer Vision Library pacman -S graphviz # Graph visualization software pacman -S hdf5 # General purpose library and file format for storing scientific data pip install --user bcolz pip install --user graphviz # Interface for python pip install --user sklearn-pandas pip install --user isoweek AUR: python-numba ######################################## Deep larining frameworks pacman -S python-pytorch-cuda # Pytorch pacman -S python-tensorflow-opt-cuda # Tensorflow pacman -S tensorflow-opt-cuda # Tensorflow pacman -S tensorboard # Tensorboard AUR: python-torchvision AUR: python-keras # Keras API for Tensorflow AUR: python-theano AUR: caffe AUR: mxnet # MXNet: Apache DL AUR: cntk # CNTK: Microsoft DL Nervana Neon, Chainer, DyNet, MinPy ######################################## Other packages # Monitoring htop - Monitor CPU, RAM, load, kill programs nvidia-smi - Monitor Nvidia GPU CSV manipulation xsv - The fastest, multi-processing CSV library. Written in Rust. Rapid Development, Research Jupyter - Code Python, R, Haskell, Julia with direct feedback in your browser jupyter_contrib_nbextensions - Extensions for jupyter (commenting code, ...)","title":"iso image to USB"},{"location":"others/linux_insides/","text":"Linux insides Kernel Xanmod File system BTRFS Recomendado por andres torrubia... ...No por prestaciones, lo ha elegido por funcionalidad Copias autoam\u00e1ticas (equvalente a la Time Machine de apple) Con snapper que es un sofware que va por encima, tienes facilmente recuperable como estaba tu ordenador hace 1 hora, hace 1 dia, ... te salva la vida cuando borras datos por accidente sucesor natural del sistema de archivos EXT4 menos velocidad de lectura y escritura que EXT4 ZFS Recomendado por profe ASORC carrera informatica Sistema por defecto de freeBSD Puedes meter y quitar Discos ampliando o reduciendo el espacio (y el logical volume y ZFS se adapta) ASi que va bien para tener hot-swapable disks Es sin\u00f3nimo de escalabilidad Desventaja: consumo alto de memoria RAM EXT4 Mas comun en linux. Tambien es rapido (mas que btrfs) XFS Tambien es rapido copy-on-write (COW) mechanism: when you modify a file, the file system won\u2019t overwrite the existing data on the drive. Instead, the newer data is written elsewhere. Once the write operation is over, the file system simply points to the newer data blocks. - Ventaja: asegurar la integridad de los archivos en caso de corte el\u00e9ctrico. - Desventaja: una alta fragmentaci\u00f3n, journaling (mejora la integridad del sistema de archivos), por lo que no deber\u00edas tener p\u00e9rdida de datos en caso de corte de alimentaci\u00f3n Asegurar integridad How to Scalable for en caso de corte corr RAID? hot-swap disks EXT4 journaling need to format no BTRFS copy-on-write ZFS copy-on-write pool of vdevs vdevs == Virtual DEVice. A pool is made up of vdevs. A vdev is made up of physical devices. Let's say you have 12 physical disks. You might have a pool consisting of 6 mirrors. Each two disk mirror is a vdev. So your pool has 6 vdevs. Optimizacion trick 1: Desactivar el atributo atime El atributo atime (access time) es recopilado y actualizado cada vez que el usuario lee o modifica un determinado archivo. En total, se recogen 3 atributos: Access: la \u00faltima vez que el archivo fue le\u00eddo Modify: la \u00faltima vez que el archivo fue modificado (su contenido) Change: la \u00faltima vez que los meta-datos del archivo fueron modificados (permisos, nombre, propietario, etc) Mediante noatime desactivamos esta funcionalidad y ganamos algo de velocidad al leer y escribira archivos. https://markmcb.com/2020/01/07/five-years-of-btrfs/ https://carfax.org.uk/btrfs-usage/ https://www.linuxjournal.com/content/hot-swappable-filesystems-smooth-btrfs https://www.salvagedata.com/btrfs-zfs-xfs-ext4-how-are-they-different Notes on exFAT and Reliability I/O schedulers https://wiki.archlinux.org/title/improving_performance https://wiki.ubuntu.com/Kernel/Reference/IOSchedulers https://community.clearlinux.org/t/arch-linux-outperforms-clear-linux/5462 https://clearlinux.org/","title":"Linux insides"},{"location":"others/linux_insides/#linux-insides","text":"","title":"Linux insides"},{"location":"others/linux_insides/#kernel","text":"Xanmod","title":"Kernel"},{"location":"others/linux_insides/#file-system","text":"","title":"File system"},{"location":"others/linux_insides/#btrfs","text":"Recomendado por andres torrubia... ...No por prestaciones, lo ha elegido por funcionalidad Copias autoam\u00e1ticas (equvalente a la Time Machine de apple) Con snapper que es un sofware que va por encima, tienes facilmente recuperable como estaba tu ordenador hace 1 hora, hace 1 dia, ... te salva la vida cuando borras datos por accidente sucesor natural del sistema de archivos EXT4 menos velocidad de lectura y escritura que EXT4","title":"BTRFS"},{"location":"others/linux_insides/#zfs","text":"Recomendado por profe ASORC carrera informatica Sistema por defecto de freeBSD Puedes meter y quitar Discos ampliando o reduciendo el espacio (y el logical volume y ZFS se adapta) ASi que va bien para tener hot-swapable disks Es sin\u00f3nimo de escalabilidad Desventaja: consumo alto de memoria RAM","title":"ZFS"},{"location":"others/linux_insides/#ext4","text":"Mas comun en linux. Tambien es rapido (mas que btrfs)","title":"EXT4"},{"location":"others/linux_insides/#xfs","text":"Tambien es rapido copy-on-write (COW) mechanism: when you modify a file, the file system won\u2019t overwrite the existing data on the drive. Instead, the newer data is written elsewhere. Once the write operation is over, the file system simply points to the newer data blocks. - Ventaja: asegurar la integridad de los archivos en caso de corte el\u00e9ctrico. - Desventaja: una alta fragmentaci\u00f3n, journaling (mejora la integridad del sistema de archivos), por lo que no deber\u00edas tener p\u00e9rdida de datos en caso de corte de alimentaci\u00f3n Asegurar integridad How to Scalable for en caso de corte corr RAID? hot-swap disks EXT4 journaling need to format no BTRFS copy-on-write ZFS copy-on-write pool of vdevs vdevs == Virtual DEVice. A pool is made up of vdevs. A vdev is made up of physical devices. Let's say you have 12 physical disks. You might have a pool consisting of 6 mirrors. Each two disk mirror is a vdev. So your pool has 6 vdevs.","title":"XFS"},{"location":"others/linux_insides/#optimizacion-trick-1-desactivar-el-atributo-atime","text":"El atributo atime (access time) es recopilado y actualizado cada vez que el usuario lee o modifica un determinado archivo. En total, se recogen 3 atributos: Access: la \u00faltima vez que el archivo fue le\u00eddo Modify: la \u00faltima vez que el archivo fue modificado (su contenido) Change: la \u00faltima vez que los meta-datos del archivo fueron modificados (permisos, nombre, propietario, etc) Mediante noatime desactivamos esta funcionalidad y ganamos algo de velocidad al leer y escribira archivos. https://markmcb.com/2020/01/07/five-years-of-btrfs/ https://carfax.org.uk/btrfs-usage/ https://www.linuxjournal.com/content/hot-swappable-filesystems-smooth-btrfs https://www.salvagedata.com/btrfs-zfs-xfs-ext4-how-are-they-different Notes on exFAT and Reliability","title":"Optimizacion trick 1: Desactivar el atributo atime"},{"location":"others/linux_insides/#io-schedulers","text":"https://wiki.archlinux.org/title/improving_performance https://wiki.ubuntu.com/Kernel/Reference/IOSchedulers https://community.clearlinux.org/t/arch-linux-outperforms-clear-linux/5462 https://clearlinux.org/","title":"I/O schedulers"},{"location":"others/maintenance/","text":"System maintenance Check for errors sudo systemctl --failed # Check if any systemd services have entered in a failed state. sudo journalctl -p 3 -xb # Look for errors in the log files located at /var/log Backup ... Upgrading the system Check news pacman -Syu # Update packages and system If the system has packages from the AUR, carefully upgrade all of them. Clean the filesystem Disk usage display Find largest files and directories. sudo pacman -S ncdu # Intall ncdu Filelight is a GUI program Baobab is other GUI program (gnome) Disk cleaning programs Find and remove: duplicates empty files empty directories broken symlinks. sudo pacman -S rmlint # Intall rmlint BleachBit is a GUI program Package cache Remove unwanted .pkg files from /var/cache/pacman/pkg/ to free up disk space. ls /var/cache/pacman/pkg/ | less # Ver paquetes (diponibles?) du -sh /var/cache/pacman/pkg/ # Ver tama\u00f1o carpeta sudo pacman -Sc # Remove old and unused pkgs sudo pacman -Scc # Remove files from cache paccache # ??? Unused packges (orphans) sudo pacman -Qtdq # List orphans sudo pacman -Rns $(pacman -Qtdq) # Remove orphans and their configuration files Clean cache in your /home. du -sh ~/.cache/ # Ver tama\u00f1o carpeta rm -rf ~/.cache/* # Remove Old config files ~/.config/ : where apps stores their configuration ~/.cache/ : cache of some programs may grow in size ~/.local/share/ : old files may be lying there Broken symlinks find -xtype l -print # List all the broken symlinks","title":"[System maintenance](https://wiki.archlinux.org/index.php/System_maintenance)"},{"location":"others/maintenance/#system-maintenance","text":"","title":"System maintenance"},{"location":"others/maintenance/#check-for-errors","text":"sudo systemctl --failed # Check if any systemd services have entered in a failed state. sudo journalctl -p 3 -xb # Look for errors in the log files located at /var/log","title":"Check for errors"},{"location":"others/maintenance/#backup","text":"...","title":"Backup"},{"location":"others/maintenance/#upgrading-the-system","text":"Check news pacman -Syu # Update packages and system If the system has packages from the AUR, carefully upgrade all of them.","title":"Upgrading the system"},{"location":"others/maintenance/#clean-the-filesystem","text":"","title":"Clean the filesystem"},{"location":"others/maintenance/#disk-usage-display","text":"Find largest files and directories. sudo pacman -S ncdu # Intall ncdu Filelight is a GUI program Baobab is other GUI program (gnome)","title":"Disk usage display"},{"location":"others/maintenance/#disk-cleaning-programs","text":"Find and remove: duplicates empty files empty directories broken symlinks. sudo pacman -S rmlint # Intall rmlint BleachBit is a GUI program","title":"Disk cleaning programs"},{"location":"others/maintenance/#package-cache","text":"Remove unwanted .pkg files from /var/cache/pacman/pkg/ to free up disk space. ls /var/cache/pacman/pkg/ | less # Ver paquetes (diponibles?) du -sh /var/cache/pacman/pkg/ # Ver tama\u00f1o carpeta sudo pacman -Sc # Remove old and unused pkgs sudo pacman -Scc # Remove files from cache paccache # ???","title":"Package cache"},{"location":"others/maintenance/#unused-packges-orphans","text":"sudo pacman -Qtdq # List orphans sudo pacman -Rns $(pacman -Qtdq) # Remove orphans and their configuration files","title":"Unused packges (orphans)"},{"location":"others/maintenance/#clean-cache-in-your-home","text":"du -sh ~/.cache/ # Ver tama\u00f1o carpeta rm -rf ~/.cache/* # Remove","title":"Clean cache in your /home."},{"location":"others/maintenance/#old-config-files","text":"~/.config/ : where apps stores their configuration ~/.cache/ : cache of some programs may grow in size ~/.local/share/ : old files may be lying there","title":"Old config files"},{"location":"others/maintenance/#broken-symlinks","text":"find -xtype l -print # List all the broken symlinks","title":"Broken symlinks"},{"location":"others/public_ip/","text":"Public IP How to get a reachable IP on the internet. Problem 1: Static IP THere are not enough IPv4 adresses for everyone in the world so your ISP (Internet Service Provider) probably has given you a dynamic IP adress instead of an static IP adress . Solution: OPTION 1) You can ask for you ISP to give a static IP adress . OPTION 2) You can use noip which track your current ip Wen you sign up, you pick a free domain name and automaticlly detect your external IP In order to detect changes of your IOP, you need to install the noip software on the server. Problem 2: you router need to allow oustside traffic to get in to your network. Open up port 80 on the router (this is port forawrding) https://www.youtube.com/watch?v=ZlYyiuBc8Mc Ojo que el ISP tiene un servidor ACS que controla todos sus routers VPN","title":"Public IP"},{"location":"others/public_ip/#public-ip","text":"How to get a reachable IP on the internet.","title":"Public IP"},{"location":"others/public_ip/#problem-1-static-ip","text":"THere are not enough IPv4 adresses for everyone in the world so your ISP (Internet Service Provider) probably has given you a dynamic IP adress instead of an static IP adress . Solution: OPTION 1) You can ask for you ISP to give a static IP adress . OPTION 2) You can use noip which track your current ip Wen you sign up, you pick a free domain name and automaticlly detect your external IP In order to detect changes of your IOP, you need to install the noip software on the server.","title":"Problem 1: Static IP"},{"location":"others/public_ip/#problem-2-you-router-need-to-allow-oustside-traffic-to-get-in-to-your-network","text":"Open up port 80 on the router (this is port forawrding) https://www.youtube.com/watch?v=ZlYyiuBc8Mc Ojo que el ISP tiene un servidor ACS que controla todos sus routers","title":"Problem 2: you router need to allow oustside traffic to get in to your network."},{"location":"others/public_ip/#vpn","text":"","title":"VPN"},{"location":"others/remote_administration/","text":"Remote administration in-band management (OS level) (the usual network channel) SSH, sftp, scp (port 22) Telnet (port 23) Remote desktop VNC (port 5900) RDP (port 3389) FreeNX TeamViewer IPSec Out-of-band management (BIOS level) (dedicated Ethernet port) Advantages Reboot, Shutdown, Powering on Accesing the bios configuration broadcasting of video and receiving of input from remote keyboard and mouse (KVM over IP) (HDBaseT) Hardware sensor monitoring (fan speed, temeratures, voltages, chassis intrusion, etc.) Hardware inventory Hardware failure detection Reinstall the operating system Configure harware RAID Technologies IPMI: standard (a bit old) Redfish: standard (new, using HTTPS & JSON) DRAC: proprietary from Dell ILO: proprietary from HP ILOM: proprietary from Sun/Oracle IMM: proprietary from IBM Security Bear in mind that many of these built-in systems have been found to suffer from traditional security holes, such as buffer overruns. It is not wise to assume that setting a password on the OOB interface and using SSL is sufficient protection for such access to your servers. Assume that access to the OOB interface is equivalent to physical access to the machine, and establish additional security measures accordingly. For example, put OOB interfaces on a dedicated protected network. Allow access to this network only via a web proxy with certificate-based authentication, and appropriate authorization. Redfish curl https://<OOB>/redfish/v1/Systems/System.Embedded.1 --user root:password | jq .Status # { # \"Health\": \"Ok\", # \"HealthRollUp\": \"Ok\", # } curl https://<OOB>/redfish/v1/Systems/System.Embedded.1/Thermal --user root:password curl https://<OOB>/redfish/v1/Systems/System.Embedded.1/Thermal --user root:password https://www.youtube.com/watch?v=9tAXBvuyXJU Wake on LAN On the server ip link to find informatio about available network cards find the name og the ethernet enterface (eg. enp0s31f6 ) find the mac address (eg. e0:............) sudo ethtool enp0s31f6 | grep Wake-on Check that is on On the client Find the server mac address: arp -a Wake the server wakeonlan *mac address* shutdown shutdown now Reboot reboot now","title":"Remote administration"},{"location":"others/remote_administration/#remote-administration","text":"","title":"Remote administration"},{"location":"others/remote_administration/#in-band-management-os-level-the-usual-network-channel","text":"SSH, sftp, scp (port 22) Telnet (port 23) Remote desktop VNC (port 5900) RDP (port 3389) FreeNX TeamViewer IPSec","title":"in-band management (OS level) (the usual network channel)"},{"location":"others/remote_administration/#out-of-band-management-bios-level-dedicated-ethernet-port","text":"","title":"Out-of-band management (BIOS level) (dedicated Ethernet port)"},{"location":"others/remote_administration/#advantages","text":"Reboot, Shutdown, Powering on Accesing the bios configuration broadcasting of video and receiving of input from remote keyboard and mouse (KVM over IP) (HDBaseT) Hardware sensor monitoring (fan speed, temeratures, voltages, chassis intrusion, etc.) Hardware inventory Hardware failure detection Reinstall the operating system Configure harware RAID","title":"Advantages"},{"location":"others/remote_administration/#technologies","text":"IPMI: standard (a bit old) Redfish: standard (new, using HTTPS & JSON) DRAC: proprietary from Dell ILO: proprietary from HP ILOM: proprietary from Sun/Oracle IMM: proprietary from IBM","title":"Technologies"},{"location":"others/remote_administration/#security","text":"Bear in mind that many of these built-in systems have been found to suffer from traditional security holes, such as buffer overruns. It is not wise to assume that setting a password on the OOB interface and using SSL is sufficient protection for such access to your servers. Assume that access to the OOB interface is equivalent to physical access to the machine, and establish additional security measures accordingly. For example, put OOB interfaces on a dedicated protected network. Allow access to this network only via a web proxy with certificate-based authentication, and appropriate authorization.","title":"Security"},{"location":"others/remote_administration/#redfish","text":"curl https://<OOB>/redfish/v1/Systems/System.Embedded.1 --user root:password | jq .Status # { # \"Health\": \"Ok\", # \"HealthRollUp\": \"Ok\", # } curl https://<OOB>/redfish/v1/Systems/System.Embedded.1/Thermal --user root:password curl https://<OOB>/redfish/v1/Systems/System.Embedded.1/Thermal --user root:password https://www.youtube.com/watch?v=9tAXBvuyXJU","title":"Redfish"},{"location":"others/remote_administration/#wake-on-lan","text":"On the server ip link to find informatio about available network cards find the name og the ethernet enterface (eg. enp0s31f6 ) find the mac address (eg. e0:............) sudo ethtool enp0s31f6 | grep Wake-on Check that is on On the client Find the server mac address: arp -a Wake the server wakeonlan *mac address*","title":"Wake on LAN"},{"location":"others/remote_administration/#shutdown","text":"shutdown now","title":"shutdown"},{"location":"others/remote_administration/#reboot","text":"reboot now","title":"Reboot"},{"location":"others/server_db/","text":"MySQL PostgreSQL Oracle Express (data through http)","title":"Server db"},{"location":"others/server_dhcp/","text":"DHCP Server Provides IP dynamic adresses to clients in a network. (assignment by MAC)","title":"DHCP Server"},{"location":"others/server_dhcp/#dhcp-server","text":"Provides IP dynamic adresses to clients in a network. (assignment by MAC)","title":"DHCP Server"},{"location":"others/server_files/","text":"FTP (Serv-U, vsftp, proftpd) NFS SAMBA / SMB (LDAP) iSCSI FreeNAS OwnCloud With FTP and SMB (or NFS) you access files, while iSCSI is a block device protocol.","title":"Server files"},{"location":"others/server_mail/","text":"Dovecot Postfix + MySQL + amavis + spamassassin sendmail + clamav + MailScanner + spamasasin Merak WebMail","title":"Server mail"},{"location":"others/server_messaging/","text":"\u2022 Mensajer\u00eda instant\u00e1nea XMPP Jabber","title":"Server messaging"},{"location":"others/server_printer/","text":"Print server CUPS","title":"Print server"},{"location":"others/server_printer/#print-server","text":"CUPS","title":"Print server"},{"location":"others/server_users/","text":"File servers generally offer some form of system security to limit access to files to specific users or groups. In large organizations, this is a task usually delegated to directory services, such as openLDAP, Novell's eDirectory or Microsoft's Active Directory. Directory Server (user permission to directories) OpenLDAP Microsoft's Active Directory Fedora Directory Server User Management Local NIS LDAP Servidor de terminales de usuario LTSP PXE DRBL Servidor de trabajo en grupo Zimbra OpenXchange Opengroupware Microsoft Exchange Proxy Cache (Squid): Restricci\u00f3n de contenidos, p\u00e1ginas, usuarios, autenticaci\u00f3n LDAP.","title":"Server users"},{"location":"others/desktop/i3blocks/","text":"i3 Poner en .config/i3/config en bar status_command i3blocks status_command i3blocks -c /home/javi/.i3/.i3blocks height 18 Editar configuraci\u00f3n: subl /etc/i3blocks.conf Scrips en /usr/lib/i3blocks Config ######################################################## VARIABLES # Mod key # set $mod Mod1 (alt) set $mod Mod4 # Apps set $browser firefox set $music spotify set $term urxvt ######################################################## i3-gaps # Gaps set $inner 32 set $outer 16 gaps inner $inner gaps outer $outer bindsym $mod+plus gaps inner current minus 8 bindsym $mod+minus gaps inner current plus 8 # Hide window top bar for_window [class=\"^.*\"] border pixel 3 #hide_edge_borders both ######################################################## FONT # Font for window titles. # Will also be used by the bar unless a different font is used in the bar {} block below. #font pango:monospace 8 font pango:monaco 8 # This font is widely installed, provides lots of unicode glyphs, right-to-left # text rendering and scalability on retina/hidpi displays (thanks to pango). #font pango:DejaVu Sans Mono 8 # Before i3 v4.8, we used to recommend this one as the default: # font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1 # The font above is very space-efficient, that is, it looks good, sharp and # clear in small sizes. However, its unicode glyph coverage is limited, the old # X core fonts rendering does not support right-to-left and this being a bitmap # font, it doesn\u2019t scale on retina/hidpi displays. ######################################################## FLOATING # Use Mouse+$mod to drag floating windows to their wanted position floating_modifier $mod ######################################################## SHORTCUTS # start a terminal bindsym $mod+Return exec i3-sensible-terminal # kill focused window bindsym $mod+q kill bindsym $mod+Shift+q kill # Menu # start dmenu (a program launcher) #bindsym $mod+d exec dmenu_run #bindsym $mod+m exec dmenu_run bindsym $mod+space exec rofi -show run # There also is the (new) i3-dmenu-desktop which only displays applications # shipping a .desktop file. It is a wrapper around dmenu, so you need that # installed. # bindsym $mod+d exec --no-startup-id i3-dmenu-desktop bindsym $mod+Tab workspace back_and_forth ######################################################## MOVEMENT # FOCUS #bindsym $mod+j focus left #bindsym $mod+k focus down #bindsym $mod+l focus up #bindsym $mod+ntilde focus right bindsym $mod+Left focus left bindsym $mod+Down focus down bindsym $mod+Up focus up bindsym $mod+Right focus right # MOVE FOCUSED #bindsym $mod+Shift+j move left #bindsym $mod+Shift+k move down #bindsym $mod+Shift+l move up #bindsym $mod+Shift+ntilde move right bindsym $mod+Shift+Left move left bindsym $mod+Shift+Down move down bindsym $mod+Shift+Up move up bindsym $mod+Shift+Right move right # HORIZONTAL SPLIT bindsym $mod+h split h # VERTICAL SPLIT bindsym $mod+v split v # FULLSCREEN bindsym $mod+f fullscreen toggle # change container layout (stacked, tabbed, toggle split) bindsym $mod+s layout stacking bindsym $mod+w layout tabbed bindsym $mod+e layout toggle split # toggle tiling / floating bindsym $mod+Shift+space floating toggle # change focus between tiling / floating windows # bindsym $mod+space focus mode_toggle # focus the parent container bindsym $mod+a focus parent # focus the child container #bindsym $mod+d focus child ################################################################ WORKSPACES # Workspaces set $ws1 \"1: Terminals\" set $ws2 \"2: Internet\" set $ws3 \"3\" set $ws4 \"4\" set $ws5 \"5\" set $ws6 \"6\" set $ws7 \"7\" set $ws8 \"8\" set $ws9 \"9\" set $ws10 \"10: Music\" # switch to workspace bindsym $mod+1 workspace $ws1 bindsym $mod+2 workspace $ws2 bindsym $mod+3 workspace $ws3 bindsym $mod+4 workspace $ws4 bindsym $mod+5 workspace $ws5 bindsym $mod+6 workspace $ws6 bindsym $mod+7 workspace $ws7 bindsym $mod+8 workspace $ws8 bindsym $mod+9 workspace $ws9 bindsym $mod+0 workspace $ws10 # move focused container to workspace bindsym $mod+Shift+1 move container to workspace $ws1 bindsym $mod+Shift+2 move container to workspace $ws2 bindsym $mod+Shift+3 move container to workspace $ws3 bindsym $mod+Shift+4 move container to workspace $ws4 bindsym $mod+Shift+5 move container to workspace $ws5 bindsym $mod+Shift+6 move container to workspace $ws6 bindsym $mod+Shift+7 move container to workspace $ws7 bindsym $mod+Shift+8 move container to workspace $ws8 bindsym $mod+Shift+9 move container to workspace $ws9 bindsym $mod+Shift+0 move container to workspace $ws10 ################################################################ COLORS # class border backgr. text indicator child_border client.focused #4c7899 #285577 #ffffff #2e9ef4 #285577 client.focused_inactive #333333 #5f676a #ffffff #484e50 #5f676a client.unfocused #333333 #222222 #888888 #292d2e #222222 client.urgent #2f343a #900000 #ffffff #900000 #900000 client.placeholder #000000 #0c0c0c #ffffff #000000 #0c0c0c client.background #ffffff # reload the configuration file bindsym $mod+Shift+c reload # restart i3 inplace (preserves your layout/session, can be used to upgrade i3) bindsym $mod+Shift+r restart # exit i3 (logs you out of your X session) bindsym $mod+Shift+e exec \"i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'\" # resize window (you can also use the mouse for that) mode \"resize\" { # These bindings trigger as soon as you enter the resize mode # Pressing left will shrink the window\u2019s width. # Pressing right will grow the window\u2019s width. # Pressing up will shrink the window\u2019s height. # Pressing down will grow the window\u2019s height. bindsym j resize shrink width 10 px or 10 ppt bindsym k resize grow height 10 px or 10 ppt bindsym l resize shrink height 10 px or 10 ppt bindsym ntilde resize grow width 10 px or 10 ppt # same bindings, but for the arrow keys bindsym Left resize shrink width 10 px or 10 ppt bindsym Down resize grow height 10 px or 10 ppt bindsym Up resize shrink height 10 px or 10 ppt bindsym Right resize grow width 10 px or 10 ppt # back to normal: Enter or Escape bindsym Return mode \"default\" bindsym Escape mode \"default\" } bindsym $mod+r mode \"resize\" ################################################################ i3bar bar { # STATUS # DEFUALT: i3status #status_command i3status status_command i3blocks # Show on top position top mode dock modifier None } ################################################################ CUSTOM # lock bindsym $mod+l exec i3lock ################################################################ INIT APPS assign [class=\"Navigator\"] $ws2 exec firefox # only on restart and login # exec firefox # # every time that i3 is loaded # exec_always # background exec_always --no-startup-id feh --bg-scale /home/javi/Im\u00e1genes/fondos/space1.jpg ################################################################ MULTIMEDIA KEYS # Pulse Audio controls bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5% #increase sound volume bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -5% #decrease sound volume bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle # mute sound # Sreen brightness controls # bindsym XF86MonBrightnessUp exec xbacklight -inc 20 # increase screen brightness # bindsym XF86MonBrightnessDown exec xbacklight -dec 20 # decrease screen brightness # Touchpad controls # bindsym XF86TouchpadToggle exec /some/path/toggletouchpad.sh # toggle touchpad # Media player controls bindsym XF86AudioPlay exec playerctl play bindsym XF86AudioPause exec playerctl pause bindsym XF86AudioNext exec playerctl next bindsym XF86AudioPrev exec playerctl previous","title":"i3"},{"location":"others/desktop/i3blocks/#i3","text":"Poner en .config/i3/config en bar status_command i3blocks status_command i3blocks -c /home/javi/.i3/.i3blocks height 18 Editar configuraci\u00f3n: subl /etc/i3blocks.conf Scrips en /usr/lib/i3blocks","title":"i3"},{"location":"others/desktop/i3blocks/#config","text":"######################################################## VARIABLES # Mod key # set $mod Mod1 (alt) set $mod Mod4 # Apps set $browser firefox set $music spotify set $term urxvt ######################################################## i3-gaps # Gaps set $inner 32 set $outer 16 gaps inner $inner gaps outer $outer bindsym $mod+plus gaps inner current minus 8 bindsym $mod+minus gaps inner current plus 8 # Hide window top bar for_window [class=\"^.*\"] border pixel 3 #hide_edge_borders both ######################################################## FONT # Font for window titles. # Will also be used by the bar unless a different font is used in the bar {} block below. #font pango:monospace 8 font pango:monaco 8 # This font is widely installed, provides lots of unicode glyphs, right-to-left # text rendering and scalability on retina/hidpi displays (thanks to pango). #font pango:DejaVu Sans Mono 8 # Before i3 v4.8, we used to recommend this one as the default: # font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1 # The font above is very space-efficient, that is, it looks good, sharp and # clear in small sizes. However, its unicode glyph coverage is limited, the old # X core fonts rendering does not support right-to-left and this being a bitmap # font, it doesn\u2019t scale on retina/hidpi displays. ######################################################## FLOATING # Use Mouse+$mod to drag floating windows to their wanted position floating_modifier $mod ######################################################## SHORTCUTS # start a terminal bindsym $mod+Return exec i3-sensible-terminal # kill focused window bindsym $mod+q kill bindsym $mod+Shift+q kill # Menu # start dmenu (a program launcher) #bindsym $mod+d exec dmenu_run #bindsym $mod+m exec dmenu_run bindsym $mod+space exec rofi -show run # There also is the (new) i3-dmenu-desktop which only displays applications # shipping a .desktop file. It is a wrapper around dmenu, so you need that # installed. # bindsym $mod+d exec --no-startup-id i3-dmenu-desktop bindsym $mod+Tab workspace back_and_forth ######################################################## MOVEMENT # FOCUS #bindsym $mod+j focus left #bindsym $mod+k focus down #bindsym $mod+l focus up #bindsym $mod+ntilde focus right bindsym $mod+Left focus left bindsym $mod+Down focus down bindsym $mod+Up focus up bindsym $mod+Right focus right # MOVE FOCUSED #bindsym $mod+Shift+j move left #bindsym $mod+Shift+k move down #bindsym $mod+Shift+l move up #bindsym $mod+Shift+ntilde move right bindsym $mod+Shift+Left move left bindsym $mod+Shift+Down move down bindsym $mod+Shift+Up move up bindsym $mod+Shift+Right move right # HORIZONTAL SPLIT bindsym $mod+h split h # VERTICAL SPLIT bindsym $mod+v split v # FULLSCREEN bindsym $mod+f fullscreen toggle # change container layout (stacked, tabbed, toggle split) bindsym $mod+s layout stacking bindsym $mod+w layout tabbed bindsym $mod+e layout toggle split # toggle tiling / floating bindsym $mod+Shift+space floating toggle # change focus between tiling / floating windows # bindsym $mod+space focus mode_toggle # focus the parent container bindsym $mod+a focus parent # focus the child container #bindsym $mod+d focus child ################################################################ WORKSPACES # Workspaces set $ws1 \"1: Terminals\" set $ws2 \"2: Internet\" set $ws3 \"3\" set $ws4 \"4\" set $ws5 \"5\" set $ws6 \"6\" set $ws7 \"7\" set $ws8 \"8\" set $ws9 \"9\" set $ws10 \"10: Music\" # switch to workspace bindsym $mod+1 workspace $ws1 bindsym $mod+2 workspace $ws2 bindsym $mod+3 workspace $ws3 bindsym $mod+4 workspace $ws4 bindsym $mod+5 workspace $ws5 bindsym $mod+6 workspace $ws6 bindsym $mod+7 workspace $ws7 bindsym $mod+8 workspace $ws8 bindsym $mod+9 workspace $ws9 bindsym $mod+0 workspace $ws10 # move focused container to workspace bindsym $mod+Shift+1 move container to workspace $ws1 bindsym $mod+Shift+2 move container to workspace $ws2 bindsym $mod+Shift+3 move container to workspace $ws3 bindsym $mod+Shift+4 move container to workspace $ws4 bindsym $mod+Shift+5 move container to workspace $ws5 bindsym $mod+Shift+6 move container to workspace $ws6 bindsym $mod+Shift+7 move container to workspace $ws7 bindsym $mod+Shift+8 move container to workspace $ws8 bindsym $mod+Shift+9 move container to workspace $ws9 bindsym $mod+Shift+0 move container to workspace $ws10 ################################################################ COLORS # class border backgr. text indicator child_border client.focused #4c7899 #285577 #ffffff #2e9ef4 #285577 client.focused_inactive #333333 #5f676a #ffffff #484e50 #5f676a client.unfocused #333333 #222222 #888888 #292d2e #222222 client.urgent #2f343a #900000 #ffffff #900000 #900000 client.placeholder #000000 #0c0c0c #ffffff #000000 #0c0c0c client.background #ffffff # reload the configuration file bindsym $mod+Shift+c reload # restart i3 inplace (preserves your layout/session, can be used to upgrade i3) bindsym $mod+Shift+r restart # exit i3 (logs you out of your X session) bindsym $mod+Shift+e exec \"i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'\" # resize window (you can also use the mouse for that) mode \"resize\" { # These bindings trigger as soon as you enter the resize mode # Pressing left will shrink the window\u2019s width. # Pressing right will grow the window\u2019s width. # Pressing up will shrink the window\u2019s height. # Pressing down will grow the window\u2019s height. bindsym j resize shrink width 10 px or 10 ppt bindsym k resize grow height 10 px or 10 ppt bindsym l resize shrink height 10 px or 10 ppt bindsym ntilde resize grow width 10 px or 10 ppt # same bindings, but for the arrow keys bindsym Left resize shrink width 10 px or 10 ppt bindsym Down resize grow height 10 px or 10 ppt bindsym Up resize shrink height 10 px or 10 ppt bindsym Right resize grow width 10 px or 10 ppt # back to normal: Enter or Escape bindsym Return mode \"default\" bindsym Escape mode \"default\" } bindsym $mod+r mode \"resize\" ################################################################ i3bar bar { # STATUS # DEFUALT: i3status #status_command i3status status_command i3blocks # Show on top position top mode dock modifier None } ################################################################ CUSTOM # lock bindsym $mod+l exec i3lock ################################################################ INIT APPS assign [class=\"Navigator\"] $ws2 exec firefox # only on restart and login # exec firefox # # every time that i3 is loaded # exec_always # background exec_always --no-startup-id feh --bg-scale /home/javi/Im\u00e1genes/fondos/space1.jpg ################################################################ MULTIMEDIA KEYS # Pulse Audio controls bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5% #increase sound volume bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -5% #decrease sound volume bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle # mute sound # Sreen brightness controls # bindsym XF86MonBrightnessUp exec xbacklight -inc 20 # increase screen brightness # bindsym XF86MonBrightnessDown exec xbacklight -dec 20 # decrease screen brightness # Touchpad controls # bindsym XF86TouchpadToggle exec /some/path/toggletouchpad.sh # toggle touchpad # Media player controls bindsym XF86AudioPlay exec playerctl play bindsym XF86AudioPause exec playerctl pause bindsym XF86AudioNext exec playerctl next bindsym XF86AudioPrev exec playerctl previous","title":"Config"},{"location":"others/programming/ruby/","text":"Ruby Ruby gems are installed inside .local/share/gem/ruby/3.0.0/gems/ https://stackoverflow.com/questions/69724440/jekyll-crash-on-generation-segmentation-fault Install Jekyll (a Ruby gem) 1) On the home directory: sudo pacman -S ruby ruby-rdoc gcc make # Install the bundler gem install bundle 2) On the project directory (the one containing the Gemfile file) # install gems of the Gemfile (jekyll, ...) bundle install # Lauch page locally bundle exec jekyll serve --livereload bundle exec jekyll serve --livereload --watch --baseurl \"\" --trace`","title":"[Ruby](https://wiki.archlinux.org/title/ruby)"},{"location":"others/programming/ruby/#ruby","text":"Ruby gems are installed inside .local/share/gem/ruby/3.0.0/gems/ https://stackoverflow.com/questions/69724440/jekyll-crash-on-generation-segmentation-fault","title":"Ruby"},{"location":"others/programming/ruby/#install-jekyll-a-ruby-gem","text":"1) On the home directory: sudo pacman -S ruby ruby-rdoc gcc make # Install the bundler gem install bundle 2) On the project directory (the one containing the Gemfile file) # install gems of the Gemfile (jekyll, ...) bundle install # Lauch page locally bundle exec jekyll serve --livereload bundle exec jekyll serve --livereload --watch --baseurl \"\" --trace`","title":"Install Jekyll (a Ruby gem)"}]}